# üîß –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø EDGE FUNCTIONS - UNITY-v2

## üêõ –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π BASE_URL –¥–ª—è i18n API

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**:
- –ö–æ–¥ –≤—ã–∑—ã–≤–∞–µ—Ç: `/api/i18n/languages` –∏ `/api/i18n/translations/:lang`
- Edge Function endpoints –Ω–∞—Ö–æ–¥—è—Ç—Å—è –ø–æ: `/make-server-9729c493/i18n/languages` –∏ `/make-server-9729c493/i18n/translations/:lang`
- –†–µ–∑—É–ª—å—Ç–∞—Ç: **404 –æ—à–∏–±–∫–∏**

**–§–∞–π–ª—ã —Å –ø—Ä–æ–±–ª–µ–º–æ–π**:
1. `src/utils/i18n/api.ts` - BASE_URL = '/api/i18n'
2. `src/shared/lib/i18n/api.ts` - BASE_URL = '/api/i18n'
3. `src/shared/lib/api/i18n/api.ts` - BASE_URL = '/api/i18n'

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ i18n API –∫–ª–∞—Å—Å—ã

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**:
- 3 –∫–æ–ø–∏–∏ I18nAPI –∫–ª–∞—Å—Å–∞ –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö
- –í—Å–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π BASE_URL
- –°–ª–æ–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å

**–§–∞–π–ª—ã —Å –¥—É–±–ª—è–º–∏**:
1. `src/utils/i18n/api.ts`
2. `src/shared/lib/i18n/api.ts`
3. `src/shared/lib/api/i18n/api.ts`

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û–±–Ω–æ–≤–∏—Ç—å BASE_URL (–ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ)

–û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Ç—Ä–∏ —Ñ–∞–π–ª–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º BASE_URL:

```typescript
// –ë–´–õ–û
private static readonly BASE_URL = '/api/i18n';

// –°–¢–ê–õ–û
private static readonly BASE_URL = 'https://{projectId}.supabase.co/functions/v1/make-server-9729c493/i18n';
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**:
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- –°–ª–æ–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ö–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≤ –æ–¥–∏–Ω —Ñ–∞–π–ª (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ `src/shared/lib/i18n/api.ts`
2. –£–¥–∞–ª–∏—Ç—å `src/utils/i18n/api.ts` –∏ `src/shared/lib/api/i18n/api.ts`
3. –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö
4. –û–±–Ω–æ–≤–∏—Ç—å BASE_URL

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã
- –õ–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å
- –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**:
- –¢—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –®–∞–≥ 1: –û–±–Ω–æ–≤–∏—Ç—å BASE_URL –≤ Edge Function

–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ Edge Function endpoints –¥–æ—Å—Ç—É–ø–Ω—ã:
- ‚úÖ `/make-server-9729c493/i18n/languages` - GET
- ‚úÖ `/make-server-9729c493/i18n/translations/:lang` - GET
- ‚úÖ `/make-server-9729c493/i18n/keys` - GET

### –®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç—å BASE_URL –≤ i18n API –∫–ª–∞—Å—Å–∞—Ö

```typescript
// src/shared/lib/i18n/api.ts
private static readonly BASE_URL = `https://${projectId}.supabase.co/functions/v1/make-server-9729c493/i18n`;
```

### –®–∞–≥ 3: –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- –£–¥–∞–ª–∏—Ç—å `src/utils/i18n/api.ts`
- –£–¥–∞–ª–∏—Ç—å `src/shared/lib/api/i18n/api.ts`

### –®–∞–≥ 4: –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã

–ù–∞–π—Ç–∏ –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∏–∑ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ –æ–±–Ω–æ–≤–∏—Ç—å –Ω–∞:
```typescript
import { I18nAPI } from '@/shared/lib/i18n/api';
```

### –®–∞–≥ 5: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

- –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —è–∑—ã–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–µ—Ä–µ–≤–æ–¥—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```
‚ùå Error fetching supported languages: 401
‚ùå Error fetching translations for en: 401
‚ùå Failed to load translations for en after 3 attempts
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```
‚úÖ Fetching supported languages...
‚úÖ Loading translations for en (fallback: ru)
‚úÖ Translations loaded for ru, used fallback: false
```

---

## üöÄ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

```bash
# 1. –û–±–Ω–æ–≤–∏—Ç—å BASE_URL –≤ src/shared/lib/i18n/api.ts
# 2. –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
rm src/utils/i18n/api.ts
rm src/shared/lib/api/i18n/api.ts

# 3. –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã
grep -r "from.*utils/i18n/api" src/ --include="*.tsx" --include="*.ts"
grep -r "from.*shared/lib/api/i18n/api" src/ --include="*.tsx" --include="*.ts"

# 4. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
npm run build

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä
npm run dev

# 6. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å
open http://localhost:3000/
```

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç

- [ ] –û–±–Ω–æ–≤–∏—Ç—å BASE_URL –≤ `src/shared/lib/i18n/api.ts`
- [ ] –£–¥–∞–ª–∏—Ç—å `src/utils/i18n/api.ts`
- [ ] –£–¥–∞–ª–∏—Ç—å `src/shared/lib/api/i18n/api.ts`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö
- [ ] –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —è–∑—ã–∫–æ–≤
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –ø–µ—Ä–µ–≤–æ–¥–æ–≤
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2025-10-16
**–í–µ—Ä—Å–∏—è**: 1.0
**–°—Ç–∞—Ç—É—Å**: üî¥ –¢–†–ï–ë–£–ï–¢ –í–ù–ò–ú–ê–ù–ò–Ø

