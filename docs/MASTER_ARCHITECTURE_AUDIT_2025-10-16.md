# üèóÔ∏è MASTER ARCHITECTURE AUDIT - 2025-10-16

## üéØ –¶–ï–õ–¨ –ê–£–î–ò–¢–ê

–ü—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞ UNITY-v2, –≤—ã—è–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –∏ —Å–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–ª–∞–Ω –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

---

## ‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

### 1. **–ú–û–ù–û–õ–ò–¢–ù–ê–Ø EDGE FUNCTION** üö®

**–§–∞–π–ª**: `supabase/functions/make-server-9729c493/index.ts`
- **–†–∞–∑–º–µ—Ä**: 69,937 bytes (2,291 —Å—Ç—Ä–æ–∫)
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ù–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**:
  - –°–ª–æ–∂–Ω–æ—Å—Ç—å –¥–µ–ø–ª–æ—è (–Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ Supabase MCP)
  - –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏
  - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
  - –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

**–°–æ–¥–µ—Ä–∂–∏—Ç**:
- ‚úÖ OpenAI usage logging
- ‚úÖ Voice transcription (Whisper API)
- ‚úÖ Media upload
- ‚úÖ AI analysis
- ‚úÖ Profile management
- ‚úÖ Entries management
- ‚úÖ Motivation cards
- ‚úÖ Admin API
- ‚úÖ Admin settings
- ‚úÖ Supported languages
- ‚úÖ Translations API
- ‚úÖ Public i18n endpoints
- ‚úÖ Admin i18n endpoints

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω–æ –Ω–∞**:
1. `ai-analysis` - AI –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞
2. `transcription` - Whisper API
3. `media` - –ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞
4. `profiles` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è–º–∏ (–£–ñ–ï –°–û–ó–î–ê–ù ‚úÖ)
5. `entries` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—è–º–∏ (–£–ñ–ï –°–û–ó–î–ê–ù ‚úÖ)
6. `motivations` - –ú–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏
7. `admin-api` - –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å (–£–ñ–ï –°–û–ó–î–ê–ù ‚úÖ)
8. `translations-api` - –ü–µ—Ä–µ–≤–æ–¥—ã (–£–ñ–ï –°–û–ó–î–ê–ù ‚úÖ)
9. `stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–£–ñ–ï –°–û–ó–î–ê–ù ‚úÖ)

---

### 2. **–î–£–ë–õ–ò–†–û–í–ê–ù–ò–ï EDGE FUNCTIONS** üîÑ

**–ü—Ä–æ–±–ª–µ–º–∞**: –°—É—â–µ—Å—Ç–≤—É—é—Ç –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã, –Ω–æ –º–æ–Ω–æ–ª–∏—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤—Å–µ –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è!

**–†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–µ Edge Functions**:
1. ‚úÖ `make-server-9729c493` (v38) - –ú–û–ù–û–õ–ò–¢ (2,291 —Å—Ç—Ä–æ–∫)
2. ‚úÖ `translations-api` (v6) - –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å
3. ‚úÖ `admin-api` (v3) - –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å
4. ‚úÖ `telegram-auth` (v22) - –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å
5. ‚úÖ `stats` (v1, slug: quick-endpoint) - –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å
6. ‚úÖ `profiles` (v1) - –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å
7. ‚úÖ `entries` (v1) - –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å

**–ü—Ä–æ–±–ª–µ–º–∞**: –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `API_BASE_URL` –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ `make-server-9729c493`!

**–§–∞–π–ª**: `src/utils/api.ts`
```typescript
const API_BASE_URL = 'https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493';
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**:
- –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã `profiles` –∏ `entries` –ù–ï –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç —á–µ—Ä–µ–∑ –º–æ–Ω–æ–ª–∏—Ç
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏

---

### 3. **OPENAI API KEY –õ–û–ì–ò–ö–ê** üîë

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
```
–°—É–ø–µ—Ä-–∞–¥–º–∏–Ω ‚Üí –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–ª—é—á –≤ admin_settings
                                    ‚Üì
                            –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–æ—Ç –∫–ª—é—á
                                    ‚Üì
                            –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ openai_usage (–ø–æ user_id)
                                    ‚Üì
                            –ê–¥–º–∏–Ω –≤–∏–¥–∏—Ç –∑–∞—Ç—Ä–∞—Ç—ã –ø–æ –∫–∞–∂–¥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
```

**–ü—Ä–æ–±–ª–µ–º–∞**: Edge Function –ù–ï —á–∏—Ç–∞–µ—Ç –∫–ª—é—á –∏–∑ `admin_settings`!

**–¢–µ–∫—É—â–∏–π –∫–æ–¥** (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û):
```typescript
const openaiApiKey = c.req.header('X-OpenAI-Key') || Deno.env.get('OPENAI_API_KEY');
```

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥** (–ò–°–ü–†–ê–í–õ–ï–ù–û):
```typescript
let openaiApiKey = c.req.header('X-OpenAI-Key');

if (!openaiApiKey) {
  const { data: setting } = await supabase
    .from('admin_settings')
    .select('value')
    .eq('key', 'openai_api_key')
    .single();
  
  if (setting?.value) {
    openaiApiKey = setting.value;
  } else {
    openaiApiKey = Deno.env.get('OPENAI_API_KEY');
  }
}
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ, –ù–û –ù–ï –ó–ê–î–ï–ü–õ–û–ï–ù–û!

---

### 4. **–ë–ê–ó–ê –î–ê–ù–ù–´–•** üìä

**–¢–∞–±–ª–∏—Ü—ã** (13 total):
1. ‚úÖ `profiles` - –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (5 –∑–∞–ø–∏—Å–µ–π)
2. ‚úÖ `entries` - –ó–∞–ø–∏—Å–∏ –¥–Ω–µ–≤–Ω–∏–∫–∞ (7 –∑–∞–ø–∏—Å–µ–π)
3. ‚úÖ `admin_settings` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–¥–º–∏–Ω–∞ (3 –∑–∞–ø–∏—Å–∏, –≤–∫–ª—é—á–∞—è OpenAI –∫–ª—é—á)
4. ‚úÖ `openai_usage` - –õ–æ–≥–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è OpenAI (1 –∑–∞–ø–∏—Å—å)
5. ‚úÖ `openai_usage_stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (0 –∑–∞–ø–∏—Å–µ–π)
6. ‚úÖ `translations` - –ü–µ—Ä–µ–≤–æ–¥—ã (791 –∑–∞–ø–∏—Å—å)
7. ‚úÖ `translation_keys` - –ö–ª—é—á–∏ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (9 –∑–∞–ø–∏—Å–µ–π)
8. ‚úÖ `languages` - –Ø–∑—ã–∫–∏ (8 –∑–∞–ø–∏—Å–µ–π)
9. ‚úÖ `supported_languages` - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏ (7 –∑–∞–ø–∏—Å–µ–π)
10. ‚úÖ `entry_summaries` - –†–µ–∑—é–º–µ –∑–∞–ø–∏—Å–µ–π (0 –∑–∞–ø–∏—Å–µ–π) ‚ö†Ô∏è –ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
11. ‚úÖ `books_archive` - –ê—Ä—Ö–∏–≤ –∫–Ω–∏–≥ (0 –∑–∞–ø–∏—Å–µ–π) ‚ö†Ô∏è –ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
12. ‚úÖ `story_snapshots` - –°–Ω–∏–º–∫–∏ –∏—Å—Ç–æ—Ä–∏–π (0 –∑–∞–ø–∏—Å–µ–π) ‚ö†Ô∏è –ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
13. ‚úÖ `kv_store_9729c493` - KV —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (43 –∑–∞–ø–∏—Å–∏)

**–ü—Ä–æ–±–ª–µ–º—ã**:
- ‚ùå `entry_summaries` –Ω–µ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–ø–∏—Å–∏
- ‚ùå `books_archive` –∏ `story_snapshots` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è (PDF –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞)
- ‚ö†Ô∏è –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —è–∑—ã–∫–æ–≤: `languages` –∏ `supported_languages`

---

## üìã –ü–û–õ–ù–´–ô –°–¶–ï–ù–ê–†–ò–ô –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø

### 1. **Onboarding Flow** ‚úÖ

```
WelcomeScreen (–≤—ã–±–æ—Ä —è–∑—ã–∫–∞)
    ‚Üì
OnboardingScreen2 (–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏)
    ‚Üì
OnboardingScreen3 (–Ω–∞–∑–≤–∞–Ω–∏–µ –¥–Ω–µ–≤–Ω–∏–∫–∞ + —ç–º–æ–¥–∑–∏)
    ‚Üì
OnboardingScreen4 (–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è + –ø–µ—Ä–≤–∞—è –∑–∞–ø–∏—Å—å)
    ‚Üì
AuthScreen (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)
    ‚Üì signUpWithEmail()
    ‚Üì
Edge Function: /make-server-9729c493/profiles/create
    ‚Üì –°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –≤ profiles table
    ‚Üì
Edge Function: /make-server-9729c493/analyze (AI –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–≤–æ–π –∑–∞–ø–∏—Å–∏)
    ‚Üì –ß–∏—Ç–∞–µ—Ç OpenAI –∫–ª—é—á –∏–∑ admin_settings ‚úÖ
    ‚Üì –í—ã–∑—ã–≤–∞–µ—Ç OpenAI GPT-4 API
    ‚Üì –õ–æ–≥–∏—Ä—É–µ—Ç –≤ openai_usage
    ‚Üì
Edge Function: /make-server-9729c493/entries (—Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏)
    ‚Üì –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ entries table —Å AI-–∞–Ω–∞–ª–∏–∑–æ–º
    ‚Üì
AchievementHomeScreen (–≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω)
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç, –ù–û –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–Ω–æ–ª–∏—Ç

---

### 2. **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏** ‚úÖ

```
ChatInputSection
    ‚Üì analyzeTextWithAI()
    ‚Üì
Edge Function: /make-server-9729c493/analyze
    ‚Üì AI –∞–Ω–∞–ª–∏–∑
    ‚Üì
createEntry()
    ‚Üì
Edge Function: /make-server-9729c493/entries
    ‚Üì –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
    ‚Üì
getMotivationCards()
    ‚Üì –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ –∏–∑ AI-–∞–Ω–∞–ª–∏–∑–∞
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç, –ù–û –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–Ω–æ–ª–∏—Ç

---

### 3. **PDF –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–Ω–∏–≥–∏** ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

```
ReportsScreen
    ‚Üì generateBookDraft()
    ‚Üì
Edge Function: /books/generate-draft (–ù–ï –°–£–©–ï–°–¢–í–£–ï–¢)
    ‚Üì –ö–æ–º–ø–∏–ª—è—Ü–∏—è –∑–∞–ø–∏—Å–µ–π
    ‚Üì AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏
    ‚Üì –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ books_archive
    ‚Üì
BookDraftEditor
    ‚Üì –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    ‚Üì
renderBookPDF()
    ‚Üì
Edge Function: /books/{draftId}/render-pdf (–ù–ï –°–£–©–ï–°–¢–í–£–ï–¢)
    ‚Üì HTML ‚Üí CSS ‚Üí PDF
    ‚Üì –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Storage
```

**–°—Ç–∞—Ç—É—Å**: ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

---

## üéØ –ü–†–ê–í–ò–õ–¨–ù–´–ô –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### **–ü–†–ò–û–†–ò–¢–ï–¢ 1: –†–ê–ó–î–ï–õ–ò–¢–¨ –ú–û–ù–û–õ–ò–¢** üö®

**–¶–µ–ª—å**: –†–∞–∑–¥–µ–ª–∏—Ç—å `make-server-9729c493` –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã

**–®–∞–≥–∏**:
1. –°–æ–∑–¥–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `ai-analysis` (AI –∞–Ω–∞–ª–∏–∑ + Whisper)
2. –°–æ–∑–¥–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `motivations` (–º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏)
3. –°–æ–∑–¥–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `media` (–∑–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞)
4. –û–±–Ω–æ–≤–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤
5. –£–¥–∞–ª–∏—Ç—å –º–æ–Ω–æ–ª–∏—Ç–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é

**–°—Ä–æ–∫**: 3 –¥–Ω—è

---

### **–ü–†–ò–û–†–ò–¢–ï–¢ 2: –ò–°–ü–†–ê–í–ò–¢–¨ OPENAI KEY** üîë

**–¶–µ–ª—å**: –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é –ª–æ–≥–∏–∫—É —á—Ç–µ–Ω–∏—è –∫–ª—é—á–∞ –∏–∑ –ë–î

**–®–∞–≥–∏**:
1. –°–æ–∑–¥–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `ai-analysis` —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–æ–π
2. –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å —á–µ—Ä–µ–∑ Supabase MCP
3. –û–±–Ω–æ–≤–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ endpoint
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å Chrome MCP

**–°—Ä–æ–∫**: 1 –¥–µ–Ω—å

---

### **–ü–†–ò–û–†–ò–¢–ï–¢ 3: –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï** üß™

**–¶–µ–ª—å**: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π —Å Chrome MCP

**–®–∞–≥–∏**:
1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å onboarding flow
2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ —Å AI
3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ openai_usage
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞—Ç—Ä–∞—Ç—ã –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

**–°—Ä–æ–∫**: 1 –¥–µ–Ω—å

---

### **–ü–†–ò–û–†–ò–¢–ï–¢ 4: PDF –ì–ï–ù–ï–†–ê–¶–ò–Ø** üìö

**–¶–µ–ª—å**: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é PDF –∫–Ω–∏–≥

**–®–∞–≥–∏**:
1. –°–æ–∑–¥–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å `books`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `/books/generate-draft`
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `/books/{draftId}/render-pdf`
4. –°–æ–∑–¥–∞—Ç—å UI –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–Ω–æ–≤–∏–∫–∞
5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π flow

**–°—Ä–æ–∫**: 5 –¥–Ω–µ–π

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
- ‚úÖ Edge Functions: 7 (1 –º–æ–Ω–æ–ª–∏—Ç + 6 –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤)
- ‚ùå –ú–æ–Ω–æ–ª–∏—Ç: 2,291 —Å—Ç—Ä–æ–∫ (–ù–£–ñ–ù–û –†–ê–ó–î–ï–õ–ò–¢–¨)
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: 13 —Ç–∞–±–ª–∏—Ü
- ‚ö†Ô∏è –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã: 3 (entry_summaries, books_archive, story_snapshots)
- ‚úÖ OpenAI –∫–ª—é—á: –°–æ—Ö—Ä–∞–Ω–µ–Ω –≤ admin_settings
- ‚ùå OpenAI –∫–ª—é—á: –ù–ï —á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –ë–î (–ù–£–ñ–ù–û –ò–°–ü–†–ê–í–ò–¢–¨)

### –¶–µ–ª–µ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
- ‚úÖ Edge Functions: 12 –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ (–∫–∞–∂–¥—ã–π < 500 —Å—Ç—Ä–æ–∫)
- ‚úÖ –ú–æ–Ω–æ–ª–∏—Ç: –£–î–ê–õ–ï–ù
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
- ‚úÖ OpenAI –∫–ª—é—á: –ß–∏—Ç–∞–µ—Ç—Å—è –∏–∑ admin_settings
- ‚úÖ PDF –≥–µ–Ω–µ—Ä–∞—Ü–∏—è: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞

---

**–°–õ–ï–î–£–Æ–©–ò–ô –®–ê–ì**: –°–æ–∑–¥–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –∑–∞–¥–∞—á —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏

