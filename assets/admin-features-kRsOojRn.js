import{r as t,j as e,m as U,A as le,S as M,E as ce,a as oe,t as x,R as G,b as xe,c as he,M as ue,C as pe,B as ge,D as ne,U as J,d as H,L as je,e as ie,f as be,g as K,h as Z,X as fe,i as Ne,k as Q,l as ve,n as ye,o as ee}from"./vendor-libs-kWwOq1hT.js";import{C as I,a as T,b as P,c as V,d as A,I as X,B as D,T as de,e as te,f as W,g as E,h as re,i as O,j as R,D as we,k as ke,l as Se,m as Y,S as B,n as Ce,o as _e,p as Ie,q as $}from"./shared-components-uDOFDz2u.js";import{c as Ae}from"./vendor-supabase-D8QWEstQ.js";const De="https://ecuwuzqlwdkkdncampnc.supabase.co",Te="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVjdXd1enFsd2Rra2RuY2FtcG5jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwNTg2OTQsImV4cCI6MjA3NTYzNDY5NH0.OnBM1BIQMVgJur2nM4gZGDW-PWWwSR92DpJHhPpqB88",L=Ae(De,Te,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:window.localStorage,storageKey:"supabase.auth.token"}});function q(){return L}const Pe="ecuwuzqlwdkkdncampnc";function Re({onComplete:s,onBack:j}){const[i,v]=t.useState(""),[r,f]=t.useState(""),[g,b]=t.useState(!1),[p,y]=t.useState(!1),c=async d=>{if(d.preventDefault(),!i||!r){x.error("Заполните все поля");return}if(i!=="diary@leadshunter.biz"){x.error("У вас нет прав доступа к панели администратора");return}y(!0);try{const a=q(),{data:m,error:h}=await a.auth.signInWithPassword({email:i,password:r});if(h){x.error("Неверный email или пароль");return}if(!m.session){x.error("Не удалось войти в систему");return}let o;try{const n=await fetch(`https://${Pe}.supabase.co/functions/v1/profiles/${m.user.id}`,{headers:{Authorization:`Bearer ${m.session.access_token}`,"Content-Type":"application/json"}});if(n.ok){const l=await n.json();l.success&&(o=l)}}catch{}o||(o={success:!0,profile:{name:"Admin",role:"super_admin",diaryName:"Admin Diary",diaryEmoji:"🏆",language:"ru",notificationSettings:{selectedTime:"none",morningTime:"08:00",eveningTime:"21:00",permissionGranted:!1},createdAt:new Date().toISOString()}});const u={id:m.user.id,email:m.user.email,name:o.profile.name,role:o.profile.role||"super_admin",diaryData:{name:o.profile.diaryName,emoji:o.profile.diaryEmoji},language:o.profile.language,notificationSettings:o.profile.notificationSettings,createdAt:o.profile.createdAt,profile:{...o.profile,role:o.profile.role||"super_admin"}};x.success("Вход выполнен успешно"),s(u)}catch{x.error("Ошибка входа. Попробуйте снова.")}finally{y(!1)}};return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs(U.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},className:"w-full max-w-md",children:[e.jsxs(I,{className:"shadow-lg",children:[e.jsxs(T,{className:"space-y-4 text-center pb-6",children:[e.jsx("button",{onClick:j,className:"absolute top-6 left-6 w-10 h-10 rounded-full bg-muted hover:bg-accent/10 flex items-center justify-center transition-colors",children:e.jsx(le,{className:"w-5 h-5 text-foreground"})}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-accent flex items-center justify-center",children:e.jsx(M,{className:"w-8 h-8 text-white"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-foreground",children:"Панель администратора"}),e.jsx(V,{children:"Вход только для супер-администратора"})]})]}),e.jsx(A,{children:e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"admin-email",className:"text-foreground",children:"Email"}),e.jsx(X,{id:"admin-email",type:"email",placeholder:"diary@leadshunter.biz",value:i,onChange:d=>v(d.target.value),disabled:p,className:"h-12",autoComplete:"email",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"admin-password",className:"text-foreground",children:"Пароль"}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{id:"admin-password",type:g?"text":"password",placeholder:"Введите пароль",value:r,onChange:d=>f(d.target.value),disabled:p,className:"h-12 pr-12",autoComplete:"current-password",required:!0}),e.jsx("button",{type:"button",onClick:()=>b(!g),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",tabIndex:-1,children:g?e.jsx(ce,{className:"w-5 h-5"}):e.jsx(oe,{className:"w-5 h-5"})})]})]}),e.jsx(D,{type:"submit",className:"w-full h-12 bg-accent hover:bg-accent/90 text-white mt-6",disabled:p,children:p?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Вход..."]}):"Войти"}),e.jsx("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(M,{className:"w-5 h-5 text-accent shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("p",{className:"mb-1",children:"Защищенный доступ"}),e.jsxs("p",{children:["Только для пользователя с email"," ",e.jsx("span",{className:"text-foreground font-semibold",children:"diary@leadshunter.biz"})]})]})]})})]})})]}),e.jsx("div",{className:"mt-6 text-center text-muted-foreground",children:e.jsxs("p",{children:["Нет доступа?"," ",e.jsx("button",{onClick:j,className:"text-accent hover:underline font-semibold",children:"Вернуться на главную"})]})})]})})}const sa=Object.freeze(Object.defineProperty({__proto__:null,AdminLoginScreen:Re},Symbol.toStringTag,{value:"Module"}));function me(){const[s,j]=t.useState([]),[i,v]=t.useState(""),[r,f]=t.useState("all"),[g,b]=t.useState(!1),[p,y]=t.useState(1),[c,d]=t.useState(1);t.useEffect(()=>{a()},[p]);const a=async()=>{try{b(!0);const u=q(),{data:{session:n}}=await u.auth.getSession();if(!n?.access_token)throw new Error("No session");const l=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/admin-api/admin/users",{headers:{Authorization:`Bearer ${n.access_token}`,"Content-Type":"application/json"}});if(!l.ok)throw new Error("Failed to load users");const N=await l.json(),k=N.users.map(w=>({id:w.id,name:w.name,email:w.email,status:w.isPremium?"premium":"active",registeredAt:w.createdAt,lastActive:w.lastActivity,entriesCount:w.entriesCount,streak:0}));j(k),d(Math.ceil(N.total/50))}catch{x.error("Ошибка загрузки пользователей"),j([])}finally{b(!1)}},m=async(u,n)=>{try{const l=n!=="premium";x.success(`Подписка ${l?"активирована":"деактивирована"}`),a()}catch{x.error("Ошибка обновления подписки")}},h=s.filter(u=>{const n=u.name.toLowerCase().includes(i.toLowerCase())||u.email.toLowerCase().includes(i.toLowerCase()),l=r==="all"||u.status===r;return n&&l}),o=u=>{switch(u){case"premium":return e.jsx(R,{className:"bg-accent/10 text-accent border-accent",children:"Premium"});case"active":return e.jsx(R,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/20",children:"Активный"});case"blocked":return e.jsx(R,{variant:"destructive",children:"Заблокирован"});default:return e.jsx(R,{variant:"outline",children:"Неактивный"})}};return e.jsx("div",{className:"space-y-6",children:e.jsxs(I,{children:[e.jsx(T,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(P,{children:"Управление пользователями"}),e.jsx(V,{children:"Просмотр и управление аккаунтами пользователей"})]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:a,disabled:g,className:"gap-2",children:[e.jsx(G,{className:`w-4 h-4 ${g?"animate-spin":""}`}),"Обновить"]})]})}),e.jsxs(A,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(X,{placeholder:"Поиск по имени или email...",value:i,onChange:u=>v(u.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{variant:r==="all"?"default":"outline",onClick:()=>f("all"),className:"!text-[13px]",children:"Все"}),e.jsx(D,{variant:r==="active"?"default":"outline",onClick:()=>f("active"),className:"!text-[13px]",children:"Активные"}),e.jsx(D,{variant:r==="premium"?"default":"outline",onClick:()=>f("premium"),className:"!text-[13px]",children:"Premium"})]})]}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(de,{children:[e.jsx(te,{children:e.jsxs(W,{children:[e.jsx(E,{children:"Пользователь"}),e.jsx(E,{children:"Статус"}),e.jsx(E,{children:"Зарегистрирован"}),e.jsx(E,{children:"Записей"}),e.jsx(E,{children:"Streak"}),e.jsx(E,{className:"text-right",children:"Действия"})]})}),e.jsx(re,{children:h.map(u=>e.jsxs(W,{children:[e.jsx(O,{children:e.jsxs("div",{children:[e.jsx("div",{className:"!text-[14px] !font-semibold text-foreground",children:u.name}),e.jsx("div",{className:"!text-[12px] !font-normal text-muted-foreground",children:u.email})]})}),e.jsx(O,{children:o(u.status)}),e.jsx(O,{className:"!text-[13px]",children:u.registeredAt?new Date(u.registeredAt).toLocaleDateString("ru-RU"):"-"}),e.jsx(O,{className:"!text-[13px]",children:u.entriesCount}),e.jsx(O,{children:e.jsxs(R,{variant:"outline",className:"bg-accent/10 text-accent",children:["🔥 ",u.streak]})}),e.jsx(O,{className:"text-right",children:e.jsxs(we,{children:[e.jsx(ke,{asChild:!0,children:e.jsx(D,{variant:"ghost",size:"sm",children:e.jsx(he,{className:"w-4 h-4"})})}),e.jsxs(Se,{align:"end",children:[e.jsxs(Y,{children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Отправить email"]}),e.jsxs(Y,{onClick:()=>m(u.id,u.status),children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),u.status==="premium"?"Отменить Premium":"Выдать Premium"]}),e.jsxs(Y,{className:"text-destructive",children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Заблокировать"]})]})]})})]},u.id))})]})}),g&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(G,{className:"w-8 h-8 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"Загрузка..."})]}),!g&&h.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Пользователи не найдены"})}),!g&&c>1&&e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("p",{className:"text-muted-foreground",children:["Страница ",p," из ",c]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{variant:"outline",size:"sm",onClick:()=>y(u=>Math.max(1,u-1)),disabled:p===1,children:"Назад"}),e.jsx(D,{variant:"outline",size:"sm",onClick:()=>y(u=>Math.min(c,u+1)),disabled:p===c,children:"Вперёд"})]})]})]})]})})}const Ee=()=>{const[s,j]=t.useState({totalRequests:0,totalTokens:0,totalCost:0,avgCostPerRequest:0}),[i,v]=t.useState(!0),[r,f]=t.useState("30d");t.useEffect(()=>{g()},[r]);const g=async()=>{v(!0);try{const p=new Date,y=new Date;switch(r){case"7d":y.setDate(p.getDate()-7);break;case"30d":y.setDate(p.getDate()-30);break;case"90d":y.setDate(p.getDate()-90);break}const{data:c,error:d}=await L.from("openai_usage").select("total_tokens, estimated_cost").gte("created_at",y.toISOString()).lte("created_at",p.toISOString());if(d)return;if(c){const a=c.length,m=c.reduce((o,u)=>o+u.total_tokens,0),h=c.reduce((o,u)=>o+parseFloat(u.estimated_cost),0);j({totalRequests:a,totalTokens:m,totalCost:h,avgCostPerRequest:a>0?h/a:0})}}catch{}finally{v(!1)}},b=p=>new Intl.NumberFormat("ru-RU").format(p);return e.jsxs("div",{className:"admin-space-y-6",children:[e.jsxs("div",{className:"admin-flex admin-justify-between admin-items-center",children:[e.jsx("h3",{className:"admin-text-lg admin-font-semibold admin-text-gray-900",children:"📊 Статистика использования"}),e.jsx("div",{className:"admin-flex admin-gap-2",children:["7d","30d","90d"].map(p=>e.jsx("button",{onClick:()=>f(p),className:`admin-px-4 admin-py-2 admin-rounded-lg admin-text-sm admin-font-medium admin-transition-colors ${r===p?"admin-bg-admin-primary admin-text-white":"admin-bg-gray-100 admin-text-gray-700 hover:admin-bg-gray-200"}`,children:p==="7d"?"7 дней":p==="30d"?"30 дней":"90 дней"},p))})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 lg:admin-grid-cols-4 admin-gap-6",children:[e.jsxs("div",{className:"admin-card admin-p-6 admin-bg-gradient-to-br admin-from-blue-50 admin-to-blue-100 admin-border admin-border-blue-200",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-mb-4",children:[e.jsx("div",{className:"admin-text-3xl",children:"📊"}),i&&e.jsx("div",{className:"admin-spinner admin-w-5 admin-h-5"})]}),e.jsx("div",{className:"admin-text-sm admin-text-blue-600 admin-font-medium admin-mb-1",children:"Всего запросов"}),e.jsx("div",{className:"admin-text-3xl admin-font-bold admin-text-blue-900",children:i?"...":b(s.totalRequests)}),e.jsxs("div",{className:"admin-text-xs admin-text-blue-600 admin-mt-2",children:["За последние ",r==="7d"?"7":r==="30d"?"30":"90"," дней"]})]}),e.jsxs("div",{className:"admin-card admin-p-6 admin-bg-gradient-to-br admin-from-green-50 admin-to-green-100 admin-border admin-border-green-200",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-mb-4",children:[e.jsx("div",{className:"admin-text-3xl",children:"🔢"}),i&&e.jsx("div",{className:"admin-spinner admin-w-5 admin-h-5"})]}),e.jsx("div",{className:"admin-text-sm admin-text-green-600 admin-font-medium admin-mb-1",children:"Всего токенов"}),e.jsx("div",{className:"admin-text-3xl admin-font-bold admin-text-green-900",children:i?"...":b(s.totalTokens)}),e.jsx("div",{className:"admin-text-xs admin-text-green-600 admin-mt-2",children:"Использовано токенов"})]}),e.jsxs("div",{className:"admin-card admin-p-6 admin-bg-gradient-to-br admin-from-purple-50 admin-to-purple-100 admin-border admin-border-purple-200",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-mb-4",children:[e.jsx("div",{className:"admin-text-3xl",children:"💰"}),i&&e.jsx("div",{className:"admin-spinner admin-w-5 admin-h-5"})]}),e.jsx("div",{className:"admin-text-sm admin-text-purple-600 admin-font-medium admin-mb-1",children:"Общая стоимость"}),e.jsx("div",{className:"admin-text-3xl admin-font-bold admin-text-purple-900",children:i?"...":`$${s.totalCost.toFixed(2)}`}),e.jsx("div",{className:"admin-text-xs admin-text-purple-600 admin-mt-2",children:"Расходы на API"})]}),e.jsxs("div",{className:"admin-card admin-p-6 admin-bg-gradient-to-br admin-from-orange-50 admin-to-orange-100 admin-border admin-border-orange-200",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-mb-4",children:[e.jsx("div",{className:"admin-text-3xl",children:"📈"}),i&&e.jsx("div",{className:"admin-spinner admin-w-5 admin-h-5"})]}),e.jsx("div",{className:"admin-text-sm admin-text-orange-600 admin-font-medium admin-mb-1",children:"Средняя стоимость"}),e.jsx("div",{className:"admin-text-3xl admin-font-bold admin-text-orange-900",children:i?"...":`$${s.avgCostPerRequest.toFixed(4)}`}),e.jsx("div",{className:"admin-text-xs admin-text-orange-600 admin-mt-2",children:"На один запрос"})]})]}),e.jsx("div",{className:"admin-flex admin-justify-end",children:e.jsxs("button",{onClick:g,disabled:i,className:"admin-btn admin-btn-outline admin-btn-sm admin-flex admin-items-center admin-gap-2",children:[e.jsx("span",{children:"🔄"}),i?"Обновление...":"Обновить данные"]})})]})},z={ai_card:"#3b82f6",translation:"#10b981",transcription:"#f59e0b",pdf_export:"#8b5cf6",other:"#6b7280"},ae={ai_card:"🤖 AI Анализ",translation:"🌍 Переводы",transcription:"🎤 Транскрипция",pdf_export:"📄 PDF Экспорт",other:"📦 Другое"},Oe=()=>{const[s,j]=t.useState([]),[i,v]=t.useState(!0),[r,f]=t.useState("30d"),[g,b]=t.useState("requests");t.useEffect(()=>{p()},[r]);const p=async()=>{v(!0);try{const a=new Date,m=new Date;switch(r){case"7d":m.setDate(a.getDate()-7);break;case"30d":m.setDate(a.getDate()-30);break;case"90d":m.setDate(a.getDate()-90);break}const{data:h,error:o}=await L.from("openai_usage").select("operation_type, total_tokens, estimated_cost").gte("created_at",m.toISOString()).lte("created_at",a.toISOString());if(o)return;if(h){const u=h.reduce((n,l)=>{const N=l.operation_type;return n[N]||(n[N]={operation_type:N,total_requests:0,total_tokens:0,total_cost:0}),n[N].total_requests+=1,n[N].total_tokens+=l.total_tokens,n[N].total_cost+=parseFloat(l.estimated_cost),n},{});j(Object.values(u))}}catch{}finally{v(!1)}},y=()=>s.map(a=>({name:ae[a.operation_type]||a.operation_type,value:g==="requests"?a.total_requests:g==="tokens"?a.total_tokens:a.total_cost,color:z[a.operation_type]||z.other})),c=a=>g==="cost"?`$${a.toFixed(2)}`:new Intl.NumberFormat("ru-RU").format(Math.round(a)),d=()=>s.reduce((a,m)=>a+(g==="requests"?m.total_requests:g==="tokens"?m.total_tokens:m.total_cost),0);return e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsxs("div",{className:"admin-flex admin-justify-between admin-items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"admin-card-title",children:"📊 Разбивка использования"}),e.jsx("p",{className:"admin-card-description",children:"По типам операций"})]}),e.jsxs("div",{className:"admin-flex admin-gap-2",children:[e.jsxs("select",{value:g,onChange:a=>b(a.target.value),className:"admin-input admin-py-2 admin-px-3 admin-text-sm",children:[e.jsx("option",{value:"requests",children:"Запросы"}),e.jsx("option",{value:"tokens",children:"Токены"}),e.jsx("option",{value:"cost",children:"Стоимость"})]}),e.jsxs("select",{value:r,onChange:a=>f(a.target.value),className:"admin-input admin-py-2 admin-px-3 admin-text-sm",children:[e.jsx("option",{value:"7d",children:"7 дней"}),e.jsx("option",{value:"30d",children:"30 дней"}),e.jsx("option",{value:"90d",children:"90 дней"})]})]})]})}),e.jsx("div",{className:"admin-card-content",children:i?e.jsx("div",{className:"admin-flex admin-justify-center admin-items-center admin-h-64",children:e.jsx("div",{className:"admin-spinner admin-w-8 admin-h-8"})}):s.length===0?e.jsxs("div",{className:"admin-text-center admin-py-12 admin-text-gray-500",children:[e.jsx("div",{className:"admin-text-4xl admin-mb-4",children:"📊"}),e.jsx("p",{children:"Нет данных за выбранный период"})]}):e.jsxs("div",{className:"admin-grid admin-grid-cols-1 lg:admin-grid-cols-2 admin-gap-8",children:[e.jsx("div",{children:e.jsx(B,{data:y(),dataKey:"value",xAxisKey:"name",title:`Распределение по типам операций (${g==="requests"?"запросы":g==="tokens"?"токены":"стоимость"})`,type:"pie"})}),e.jsxs("div",{className:"admin-space-y-4",children:[e.jsxs("div",{className:"admin-text-center admin-mb-6",children:[e.jsxs("div",{className:"admin-text-sm admin-text-gray-600 admin-mb-1",children:["Всего ",g==="requests"?"запросов":g==="tokens"?"токенов":"стоимость"]}),e.jsx("div",{className:"admin-text-3xl admin-font-bold admin-text-gray-900",children:c(d())})]}),e.jsx("div",{className:"admin-space-y-3",children:s.map(a=>{const m=(g==="requests"?a.total_requests:g==="tokens"?a.total_tokens:a.total_cost)/d()*100;return e.jsxs("div",{className:"admin-border admin-border-gray-200 admin-rounded-lg admin-p-4",children:[e.jsxs("div",{className:"admin-flex admin-justify-between admin-items-center admin-mb-2",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-w-3 admin-h-3 admin-rounded-full",style:{backgroundColor:z[a.operation_type]||z.other}}),e.jsx("span",{className:"admin-font-medium admin-text-gray-900",children:ae[a.operation_type]||a.operation_type})]}),e.jsxs("span",{className:"admin-text-sm admin-text-gray-600",children:[m.toFixed(1),"%"]})]}),e.jsx("div",{className:"admin-w-full admin-bg-gray-200 admin-rounded-full admin-h-2 admin-mb-2",children:e.jsx("div",{className:"admin-h-2 admin-rounded-full admin-transition-all",style:{width:`${m}%`,backgroundColor:z[a.operation_type]||z.other}})}),e.jsxs("div",{className:"admin-grid admin-grid-cols-3 admin-gap-2 admin-text-xs admin-text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"admin-font-medium",children:a.total_requests})," запросов"]}),e.jsxs("div",{children:[e.jsx("span",{className:"admin-font-medium",children:a.total_tokens.toLocaleString()})," токенов"]}),e.jsx("div",{children:e.jsxs("span",{className:"admin-font-medium",children:["$",a.total_cost.toFixed(2)]})})]})]},a.operation_type)})})]})]})})]})},Fe=()=>{const[s,j]=t.useState([]),[i,v]=t.useState(!0),[r,f]=t.useState("30d"),[g,b]=t.useState("area"),[p,y]=t.useState("requests");t.useEffect(()=>{c()},[r]);const c=async()=>{v(!0);try{const h=new Date,o=new Date;switch(r){case"7d":o.setDate(h.getDate()-7);break;case"30d":o.setDate(h.getDate()-30);break;case"90d":o.setDate(h.getDate()-90);break}const{data:u,error:n}=await L.from("openai_usage").select("created_at, total_tokens, estimated_cost").gte("created_at",o.toISOString()).lte("created_at",h.toISOString()).order("created_at",{ascending:!0});if(n)return;if(u){const l=u.reduce((w,_)=>{const S=new Date(_.created_at).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"});return w[S]||(w[S]={date:S,requests:0,tokens:0,cost:0}),w[S].requests+=1,w[S].tokens+=_.total_tokens,w[S].cost+=parseFloat(_.estimated_cost),w},{}),N=[],k=new Date(o);for(;k<=h;){const w=k.toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"});N.push(l[w]||{date:w,requests:0,tokens:0,cost:0}),k.setDate(k.getDate()+1)}j(N)}}catch{}finally{v(!1)}},d=()=>{switch(p){case"requests":return"Запросы";case"tokens":return"Токены";case"cost":return"Стоимость ($)"}},m=(()=>{if(s.length<2)return{value:0,direction:"neutral"};const h=s.slice(-7),o=s.slice(-14,-7),u=h.reduce((N,k)=>N+(p==="requests"?k.requests:p==="tokens"?k.tokens:k.cost),0)/h.length,n=o.reduce((N,k)=>N+(p==="requests"?k.requests:p==="tokens"?k.tokens:k.cost),0)/(o.length||1),l=(u-n)/(n||1)*100;return{value:Math.abs(l),direction:l>0?"up":l<0?"down":"neutral"}})();return e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsxs("div",{className:"admin-flex admin-justify-between admin-items-center admin-flex-wrap admin-gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"admin-card-title",children:"📈 Тренды использования"}),e.jsx("p",{className:"admin-card-description",children:"Динамика за период"})]}),e.jsxs("div",{className:"admin-flex admin-gap-2 admin-flex-wrap",children:[s.length>0&&e.jsxs("div",{className:`admin-px-3 admin-py-1 admin-rounded-full admin-text-xs admin-font-medium ${m.direction==="up"?"admin-bg-green-100 admin-text-green-700":m.direction==="down"?"admin-bg-red-100 admin-text-red-700":"admin-bg-gray-100 admin-text-gray-700"}`,children:[m.direction==="up"?"📈":m.direction==="down"?"📉":"➡️"," ",m.value.toFixed(1),"% за неделю"]}),e.jsxs("div",{className:"admin-flex admin-gap-1 admin-bg-gray-100 admin-rounded-lg admin-p-1",children:[e.jsx("button",{onClick:()=>b("line"),className:`admin-px-3 admin-py-1 admin-rounded admin-text-xs admin-font-medium admin-transition-colors ${g==="line"?"admin-bg-white admin-text-gray-900 admin-shadow-sm":"admin-text-gray-600 hover:admin-text-gray-900"}`,children:"Линия"}),e.jsx("button",{onClick:()=>b("area"),className:`admin-px-3 admin-py-1 admin-rounded admin-text-xs admin-font-medium admin-transition-colors ${g==="area"?"admin-bg-white admin-text-gray-900 admin-shadow-sm":"admin-text-gray-600 hover:admin-text-gray-900"}`,children:"Область"})]}),e.jsxs("select",{value:p,onChange:h=>y(h.target.value),className:"admin-input admin-py-1 admin-px-3 admin-text-xs",children:[e.jsx("option",{value:"requests",children:"Запросы"}),e.jsx("option",{value:"tokens",children:"Токены"}),e.jsx("option",{value:"cost",children:"Стоимость"})]}),e.jsxs("select",{value:r,onChange:h=>f(h.target.value),className:"admin-input admin-py-1 admin-px-3 admin-text-xs",children:[e.jsx("option",{value:"7d",children:"7 дней"}),e.jsx("option",{value:"30d",children:"30 дней"}),e.jsx("option",{value:"90d",children:"90 дней"})]})]})]})}),e.jsx("div",{className:"admin-card-content",children:i?e.jsx("div",{className:"admin-flex admin-justify-center admin-items-center admin-h-80",children:e.jsx("div",{className:"admin-spinner admin-w-8 admin-h-8"})}):e.jsx(B,{data:s,dataKey:p,xAxisKey:"date",title:`${d()} за ${r==="7d"?"7 дней":r==="30d"?"30 дней":"90 дней"}`,type:g})})]})},Ue=()=>{const[s,j]=t.useState([]),[i,v]=t.useState(!0),[r,f]=t.useState("30d"),[g,b]=t.useState("cost"),[p,y]=t.useState("desc"),[c,d]=t.useState("");t.useEffect(()=>{a()},[r]);const a=async()=>{v(!0);try{let l=L.from("openai_usage").select(`
          user_id,
          total_tokens,
          estimated_cost,
          created_at
        `);if(r!=="all"){const w=new Date,_=new Date;switch(r){case"7d":_.setDate(w.getDate()-7);break;case"30d":_.setDate(w.getDate()-30);break;case"90d":_.setDate(w.getDate()-90);break}l=l.gte("created_at",_.toISOString()).lte("created_at",w.toISOString())}const{data:N,error:k}=await l;if(k)return;if(N){const w=N.reduce((S,C)=>{const F=C.user_id;return F&&(S[F]||(S[F]={user_id:F,user_email:"",user_name:"",total_requests:0,total_tokens:0,total_cost:0,last_activity:C.created_at}),S[F].total_requests+=1,S[F].total_tokens+=C.total_tokens,S[F].total_cost+=parseFloat(C.estimated_cost),new Date(C.created_at)>new Date(S[F].last_activity)&&(S[F].last_activity=C.created_at)),S},{}),_=Object.keys(w);if(_.length>0){const{data:S}=await L.from("profiles").select("id, email, name").in("id",_);S&&S.forEach(C=>{w[C.id]&&(w[C.id].user_email=C.email||"Неизвестно",w[C.id].user_name=C.name||"Пользователь")})}j(Object.values(w))}}catch{}finally{v(!1)}},m=l=>{g===l?y(p==="asc"?"desc":"asc"):(b(l),y("desc"))},h=()=>{let l=[...s];return c&&(l=l.filter(N=>N.user_email.toLowerCase().includes(c.toLowerCase())||N.user_name.toLowerCase().includes(c.toLowerCase()))),l.sort((N,k)=>{let w=0,_=0;switch(g){case"requests":w=N.total_requests,_=k.total_requests;break;case"tokens":w=N.total_tokens,_=k.total_tokens;break;case"cost":w=N.total_cost,_=k.total_cost;break}return p==="asc"?w-_:_-w}),l},o=()=>{const l=h(),N=["Email","Имя","Запросы","Токены","Стоимость ($)","Последняя активность"],k=l.map(C=>[C.user_email,C.user_name,C.total_requests,C.total_tokens,C.total_cost.toFixed(4),new Date(C.last_activity).toLocaleString("ru-RU")]),w=[N.join(","),...k.map(C=>C.join(","))].join(`
`),_=new Blob([w],{type:"text/csv;charset=utf-8;"}),S=document.createElement("a");S.href=URL.createObjectURL(_),S.download=`user-usage-${new Date().toISOString().split("T")[0]}.csv`,S.click()},u=h(),n=u.reduce((l,N)=>l+N.total_cost,0);return e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsxs("div",{className:"admin-flex admin-justify-between admin-items-center admin-flex-wrap admin-gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"admin-card-title",children:"👥 Использование по пользователям"}),e.jsx("p",{className:"admin-card-description",children:"Детальная статистика по каждому пользователю"})]}),e.jsxs("div",{className:"admin-flex admin-gap-2 admin-flex-wrap",children:[e.jsx("input",{type:"text",placeholder:"Поиск пользователя...",value:c,onChange:l=>d(l.target.value),className:"admin-input admin-py-2 admin-px-3 admin-text-sm admin-w-48"}),e.jsxs("select",{value:r,onChange:l=>f(l.target.value),className:"admin-input admin-py-2 admin-px-3 admin-text-sm",children:[e.jsx("option",{value:"7d",children:"7 дней"}),e.jsx("option",{value:"30d",children:"30 дней"}),e.jsx("option",{value:"90d",children:"90 дней"}),e.jsx("option",{value:"all",children:"Все время"})]}),e.jsxs("button",{onClick:o,disabled:u.length===0,className:"admin-btn admin-btn-outline admin-btn-sm admin-flex admin-items-center admin-gap-2",children:[e.jsx("span",{children:"📊"}),"Экспорт CSV"]}),e.jsxs("button",{onClick:a,disabled:i,className:"admin-btn admin-btn-primary admin-btn-sm admin-flex admin-items-center admin-gap-2",children:[e.jsx("span",{children:"🔄"}),i?"Загрузка...":"Обновить"]})]})]})}),e.jsxs("div",{className:"admin-card-content",children:[e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-4 admin-gap-4 admin-mb-6",children:[e.jsxs("div",{className:"admin-bg-blue-50 admin-border admin-border-blue-200 admin-rounded-lg admin-p-4",children:[e.jsx("div",{className:"admin-text-sm admin-text-blue-600 admin-mb-1",children:"Всего пользователей"}),e.jsx("div",{className:"admin-text-2xl admin-font-bold admin-text-blue-900",children:u.length})]}),e.jsxs("div",{className:"admin-bg-green-50 admin-border admin-border-green-200 admin-rounded-lg admin-p-4",children:[e.jsx("div",{className:"admin-text-sm admin-text-green-600 admin-mb-1",children:"Всего запросов"}),e.jsx("div",{className:"admin-text-2xl admin-font-bold admin-text-green-900",children:u.reduce((l,N)=>l+N.total_requests,0).toLocaleString()})]}),e.jsxs("div",{className:"admin-bg-purple-50 admin-border admin-border-purple-200 admin-rounded-lg admin-p-4",children:[e.jsx("div",{className:"admin-text-sm admin-text-purple-600 admin-mb-1",children:"Всего токенов"}),e.jsx("div",{className:"admin-text-2xl admin-font-bold admin-text-purple-900",children:u.reduce((l,N)=>l+N.total_tokens,0).toLocaleString()})]}),e.jsxs("div",{className:"admin-bg-orange-50 admin-border admin-border-orange-200 admin-rounded-lg admin-p-4",children:[e.jsx("div",{className:"admin-text-sm admin-text-orange-600 admin-mb-1",children:"Общая стоимость"}),e.jsxs("div",{className:"admin-text-2xl admin-font-bold admin-text-orange-900",children:["$",n.toFixed(2)]})]})]}),i?e.jsx("div",{className:"admin-flex admin-justify-center admin-items-center admin-h-64",children:e.jsx("div",{className:"admin-spinner admin-w-8 admin-h-8"})}):u.length===0?e.jsxs("div",{className:"admin-text-center admin-py-12 admin-text-gray-500",children:[e.jsx("div",{className:"admin-text-4xl admin-mb-4",children:"👥"}),e.jsx("p",{children:"Нет данных за выбранный период"})]}):e.jsx("div",{className:"admin-overflow-x-auto",children:e.jsxs("table",{className:"admin-w-full admin-text-sm",children:[e.jsx("thead",{className:"admin-bg-gray-50 admin-border-b admin-border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"admin-px-4 admin-py-3 admin-text-left admin-font-semibold admin-text-gray-700",children:"Пользователь"}),e.jsxs("th",{className:"admin-px-4 admin-py-3 admin-text-right admin-font-semibold admin-text-gray-700 admin-cursor-pointer hover:admin-bg-gray-100",onClick:()=>m("requests"),children:["Запросы ",g==="requests"&&(p==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"admin-px-4 admin-py-3 admin-text-right admin-font-semibold admin-text-gray-700 admin-cursor-pointer hover:admin-bg-gray-100",onClick:()=>m("tokens"),children:["Токены ",g==="tokens"&&(p==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"admin-px-4 admin-py-3 admin-text-right admin-font-semibold admin-text-gray-700 admin-cursor-pointer hover:admin-bg-gray-100",onClick:()=>m("cost"),children:["Стоимость ",g==="cost"&&(p==="asc"?"↑":"↓")]}),e.jsx("th",{className:"admin-px-4 admin-py-3 admin-text-right admin-font-semibold admin-text-gray-700",children:"Последняя активность"})]})}),e.jsx("tbody",{className:"admin-divide-y admin-divide-gray-200",children:u.map(l=>e.jsxs("tr",{className:"hover:admin-bg-gray-50 admin-transition-colors",children:[e.jsx("td",{className:"admin-px-4 admin-py-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900",children:l.user_name}),e.jsx("div",{className:"admin-text-xs admin-text-gray-500",children:l.user_email})]})}),e.jsx("td",{className:"admin-px-4 admin-py-3 admin-text-right admin-font-medium admin-text-gray-900",children:l.total_requests.toLocaleString()}),e.jsx("td",{className:"admin-px-4 admin-py-3 admin-text-right admin-font-medium admin-text-gray-900",children:l.total_tokens.toLocaleString()}),e.jsxs("td",{className:"admin-px-4 admin-py-3 admin-text-right admin-font-medium admin-text-gray-900",children:["$",l.total_cost.toFixed(4)]}),e.jsx("td",{className:"admin-px-4 admin-py-3 admin-text-right admin-text-xs admin-text-gray-600",children:new Date(l.last_activity).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]},l.user_id))})]})})]})]})},$e=()=>{const[s,j]=t.useState(""),[i,v]=t.useState(!1),[r,f]=t.useState(!1),[g,b]=t.useState(!0),[p,y]=t.useState(!1),[c,d]=t.useState({requests:1247,tokens:45678,cost:12.34});t.useEffect(()=>{(async()=>{try{const o=q(),{data:{session:u}}=await o.auth.getSession();if(!u?.access_token)return;const n=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/admin-api/admin/settings/openai_api_key",{headers:{Authorization:`Bearer ${u.access_token}`,"Content-Type":"application/json"}});if(n.ok){const l=await n.json();l.setting?.value&&(j(l.setting.value),f(!0))}}catch{}})()},[]);const a=async()=>{if(!s){x.error("Введите API ключ");return}y(!0);try{const h=q(),{data:{session:o}}=await h.auth.getSession();if(!o?.access_token){x.error("Ошибка авторизации");return}const u=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/admin-api/admin/settings",{method:"POST",headers:{Authorization:`Bearer ${o.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({key:"openai_api_key",value:s})});if(u.ok)f(!0),x.success("API ключ успешно сохранен! 🔑");else{const n=await u.json().catch(()=>({}));x.error(n.error||"Ошибка сохранения API ключа")}}catch{x.error("Ошибка соединения с сервером")}finally{y(!1)}},m=async()=>{if(!s){x.error("Введите API ключ для проверки");return}v(!0);try{s.startsWith("sk-")&&s.length>20?(f(!0),x.success("API ключ выглядит корректно! ✅")):(f(!1),x.error('API ключ имеет неверный формат. Должен начинаться с "sk-" и содержать более 20 символов'))}catch{f(!1),x.error("Ошибка при проверке API ключа")}finally{v(!1)}};return e.jsxs("div",{className:"admin-space-y-10",children:[e.jsxs("header",{className:"admin-flex admin-items-center admin-gap-4 admin-pb-4 admin-border-b admin-border-gray-200",children:[e.jsx("div",{className:"admin-p-3 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-2xl","aria-hidden":"true",children:"🔑"}),e.jsxs("div",{children:[e.jsx("h2",{className:"admin-text-2xl admin-font-semibold admin-text-gray-900",children:"Настройки OpenAI API"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600 admin-mt-1",children:"Управление API ключом и мониторинг использования"})]}),e.jsxs("div",{className:"admin-ml-auto admin-flex admin-gap-2",children:[e.jsx("div",{className:`admin-px-3 admin-py-1 admin-rounded-full admin-text-xs admin-font-medium ${r?"admin-bg-admin-success-lighter admin-text-admin-success":"admin-bg-admin-error-lighter admin-text-admin-error"}`,children:r?"✅ Активен":"❌ Неактивен"}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-primary-lighter admin-text-admin-primary admin-rounded-full admin-text-xs admin-font-medium",children:"🔒 Безопасный"})]})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 lg:admin-grid-cols-3 admin-gap-8",children:[e.jsx("div",{className:"lg:admin-col-span-2",children:e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"🔧 Конфигурация API"}),e.jsx("p",{className:"admin-card-description",children:"Настройка и управление OpenAI API ключом"})]}),e.jsxs("div",{className:"admin-card-content admin-space-y-8",children:[e.jsxs("div",{className:"admin-space-y-4",children:[e.jsx("label",{htmlFor:"api-key",className:"admin-font-medium admin-text-gray-900",children:"API Ключ"}),e.jsxs("div",{className:"admin-flex admin-gap-3",children:[e.jsx("input",{id:"api-key",type:"password",placeholder:"sk-...",value:s,onChange:h=>j(h.target.value),className:"admin-input admin-flex-1","aria-describedby":"api-key-help"}),e.jsx("button",{onClick:m,disabled:!s||i,className:"admin-btn admin-btn-primary",title:"Протестировать формат API ключа","aria-label":"Проверить API ключ",children:i?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Тестирую..."]}):"🧪 Тест"})]}),e.jsx("p",{id:"api-key-help",className:"admin-text-xs admin-text-gray-500",children:'Введите ваш OpenAI API ключ. Должен начинаться с "sk-" и содержать более 20 символов.'})]}),e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-4 admin-p-4 admin-bg-admin-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:[e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"auto-refresh",type:"checkbox",checked:g,onChange:h=>b(h.target.checked),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"auto-refresh",className:"admin-font-medium admin-text-gray-900 admin-cursor-pointer",children:"Автообновление статистики"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Автоматически обновлять данные использования"})]})]}),e.jsx("div",{className:"admin-flex admin-gap-4 admin-mt-8",children:e.jsx("button",{onClick:a,disabled:!s||!r||p,className:"admin-btn admin-btn-success admin-font-medium",children:p?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Сохраняю..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"💾"}),"Сохранить конфигурацию"]})})})]})]})}),e.jsx("div",{className:"admin-space-y-6",children:e.jsx("div",{className:"admin-card",children:e.jsxs("div",{className:"admin-card-content admin-p-6",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-mb-4",children:[e.jsx("span",{className:"admin-font-medium admin-text-gray-900",children:"Статус API"}),e.jsx("div",{className:`admin-w-3 admin-h-3 admin-rounded-full ${r?"admin-bg-admin-success":"admin-bg-admin-error"}`,"aria-hidden":"true"})]}),e.jsxs("div",{className:"admin-text-center",children:[e.jsx("div",{className:`admin-text-lg admin-font-semibold admin-mb-2 ${r?"admin-text-admin-success":"admin-text-admin-error"}`,children:r?"✅ Ключ валиден":"❌ Ключ невалиден"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:r?"API готов к использованию":"Требуется валидный API ключ"})]})]})})})]}),e.jsx(Ee,{}),e.jsx(Oe,{}),e.jsx(Fe,{}),e.jsx(Ue,{})]})},se=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4"],ze=()=>{const[s,j]=t.useState([{code:"ru",name:"Русский",native_name:"Русский",flag:"🇷🇺",is_active:!0},{code:"en",name:"Английский",native_name:"English",flag:"🇺🇸",is_active:!0},{code:"es",name:"Испанский",native_name:"Español",flag:"🇪🇸",is_active:!0},{code:"de",name:"Немецкий",native_name:"Deutsch",flag:"🇩🇪",is_active:!1},{code:"fr",name:"Французский",native_name:"Français",flag:"🇫🇷",is_active:!1},{code:"zh",name:"Китайский",native_name:"中文",flag:"🇨🇳",is_active:!1},{code:"ja",name:"Японский",native_name:"日本語",flag:"🇯🇵",is_active:!1},{code:"ka",name:"Грузинский",native_name:"ქართული",flag:"🇬🇪",is_active:!0}]),[i,v]=t.useState([]),[r,f]=t.useState(null),[g,b]=t.useState(""),[p,y]=t.useState("ru"),[c,d]=t.useState(!1);t.useEffect(()=>{a()},[]);const a=async()=>{d(!0);try{const n=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!n){x.error("Ошибка авторизации");return}const l=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/translations",{headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});if(l.ok){const N=await l.json();v(N.translations||[]),x.success("Переводы успешно загружены! 📚")}else{const N=await l.json().catch(()=>({}));x.error(N.error||"Ошибка загрузки переводов")}}catch{x.error("Ошибка соединения с сервером")}finally{d(!1)}},m=n=>{f(n),b(n.value)},h=async()=>{if(r){if(!g.trim()){x.error("Введите текст перевода");return}try{const n=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!n){x.error("Ошибка авторизации");return}const l=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/translations",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({key:r.key,language:r.language,value:g})});if(l.ok)v(N=>N.map(k=>k.key===r.key&&k.language===r.language?{...k,value:g}:k)),f(null),b(""),x.success("Перевод успешно сохранен! 🌍");else{const N=await l.json().catch(()=>({}));x.error(N.error||"Ошибка сохранения перевода")}}catch{x.error("Ошибка соединения с сервером")}}},o=n=>{const N=i.filter(k=>k.language===n).length;return Math.round(N/50*100)},u=()=>s.map((n,l)=>({name:n.name,value:o(n.code),color:se[l%se.length]}));return e.jsxs("div",{className:"admin-space-y-10",children:[e.jsxs("header",{className:"admin-flex admin-items-center admin-gap-4 admin-pb-4 admin-border-b admin-border-gray-200",children:[e.jsx("div",{className:"admin-p-3 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-2xl","aria-hidden":"true",children:"🌍"}),e.jsxs("div",{children:[e.jsx("h2",{className:"admin-text-2xl admin-font-semibold admin-text-gray-900",children:"Управление языками"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600 admin-mt-1",children:"Управление переводами и локализацией приложения"})]}),e.jsxs("div",{className:"admin-ml-auto admin-flex admin-gap-2",children:[e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-success-lighter admin-text-admin-success admin-rounded-full admin-text-xs admin-font-medium",children:"🌐 Мультиязычность"}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-primary-lighter admin-text-admin-primary admin-rounded-full admin-text-xs admin-font-medium",children:"📊 Аналитика"})]})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 lg:admin-grid-cols-3 admin-gap-8",children:[e.jsx("div",{className:"lg:admin-col-span-2 admin-space-y-8",children:e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"🌍 Активные языки"}),e.jsx("p",{className:"admin-card-description",children:"Управление поддерживаемыми языками приложения"})]}),e.jsx("div",{className:"admin-card-content",children:e.jsx("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 admin-gap-8",children:s.map(n=>e.jsx("div",{className:"admin-card admin-border admin-border-gray-200 admin-shadow-sm hover:admin-shadow-md admin-transition-shadow",children:e.jsxs("div",{className:"admin-p-8",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-mb-4",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-4",children:[e.jsx("div",{className:"admin-text-4xl","aria-hidden":"true",children:n.flag}),e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-semibold admin-text-gray-900 admin-text-lg",children:n.name}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:n.native_name})]})]}),e.jsxs("div",{className:"admin-flex admin-flex-col admin-items-end admin-gap-2",children:[e.jsx("div",{className:`admin-w-3 admin-h-3 admin-rounded-full ${n.is_active?"admin-bg-admin-success":"admin-bg-admin-gray-400"}`,"aria-hidden":"true"}),e.jsx("div",{className:`admin-px-2 admin-py-1 admin-rounded admin-text-xs admin-font-medium ${n.is_active?"admin-bg-admin-success-lighter admin-text-admin-success":"admin-bg-admin-gray-100 admin-text-admin-gray-600"}`,children:n.is_active?"Активен":"Неактивен"})]})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsxs("div",{className:"admin-flex admin-justify-between admin-text-sm",children:[e.jsx("span",{className:"admin-text-gray-600",children:"Прогресс переводов"}),e.jsxs("span",{className:"admin-font-medium admin-text-gray-900",children:[o(n.code),"%"]})]}),e.jsx("div",{className:"admin-w-full admin-bg-gray-200 admin-rounded-full admin-h-2",children:e.jsx("div",{className:"admin-bg-admin-primary admin-h-2 admin-rounded-full admin-transition-all",style:{width:`${o(n.code)}%`},"aria-label":`Прогресс переводов: ${o(n.code)}%`})}),e.jsxs("div",{className:"admin-flex admin-gap-2",children:[e.jsx("button",{onClick:()=>y(n.code),className:"admin-btn admin-btn-outline admin-btn-sm",children:"Редактировать"}),e.jsx("button",{className:"admin-btn admin-btn-primary admin-btn-sm",title:"Автоперевод","aria-label":`Запустить автоперевод для языка ${n.name}`,children:"Автоперевод"})]})]})]})},n.code))})})]})}),e.jsxs("div",{className:"admin-space-y-6",children:[e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📊 Прогресс переводов"})}),e.jsx("div",{className:"admin-card-content",children:e.jsx(B,{data:u(),dataKey:"value",xAxisKey:"name",title:"Прогресс переводов по языкам",type:"pie"})})]}),e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📈 Статистика"})}),e.jsx("div",{className:"admin-card-content admin-space-y-4",children:e.jsxs("div",{className:"admin-grid admin-grid-cols-2 admin-gap-4",children:[e.jsxs("div",{className:"admin-p-4 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-primary-light",children:[e.jsx("div",{className:"admin-text-3xl admin-font-semibold admin-text-admin-primary admin-mb-1",children:s.length}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"Всего языков"})]}),e.jsxs("div",{className:"admin-p-4 admin-bg-admin-success-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-success-light",children:[e.jsx("div",{className:"admin-text-3xl admin-font-semibold admin-text-admin-success admin-mb-1",children:s.filter(n=>n.is_active).length}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"Активных"})]}),e.jsxs("div",{className:"admin-p-4 admin-bg-admin-warning-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-warning-light",children:[e.jsx("div",{className:"admin-text-3xl admin-font-semibold admin-text-admin-warning admin-mb-1",children:i.length}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"Переводов"})]}),e.jsxs("div",{className:"admin-p-4 admin-bg-admin-secondary-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-secondary-light",children:[e.jsx("div",{className:"admin-text-3xl admin-font-semibold admin-text-admin-secondary admin-mb-1",children:Math.round(i.length/s.length)}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"На язык"})]})]})})]})]})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📝 Редактирование переводов"}),e.jsxs("p",{className:"admin-card-description",children:["Редактирование текстов для языка: ",s.find(n=>n.code===p)?.name]})]}),e.jsx("div",{className:"admin-card-content",children:e.jsx("div",{className:"admin-space-y-4 admin-max-h-96 admin-overflow-y-auto",children:i.filter(n=>n.language===p).slice(0,15).map((n,l)=>e.jsxs("div",{className:"admin-p-4 admin-bg-gray-50 admin-rounded-lg admin-border admin-border-gray-200 hover:admin-bg-gray-100 admin-transition-colors",children:[e.jsxs("div",{className:"admin-flex admin-items-start admin-justify-between admin-mb-3",children:[e.jsxs("div",{className:"admin-flex-1",children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-text-sm admin-mb-1",children:n.key}),e.jsx("div",{className:"admin-text-gray-600 admin-text-xs",children:"Ключ перевода"})]}),e.jsx("div",{className:"admin-px-2 admin-py-1 admin-bg-admin-primary-lighter admin-text-admin-primary admin-rounded admin-text-xs admin-font-medium",children:n.language.toUpperCase()})]}),r?.key===n.key&&r?.language===n.language?e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("input",{type:"text",value:g,onChange:N=>b(N.target.value),className:"admin-input"}),e.jsxs("div",{className:"admin-flex admin-gap-2",children:[e.jsx("button",{onClick:h,className:"admin-btn admin-btn-success admin-btn-sm",children:"💾 Сохранить"}),e.jsx("button",{onClick:()=>{f(null),b("")},className:"admin-btn admin-btn-outline admin-btn-sm",children:"❌ Отмена"})]})]}):e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between",children:[e.jsx("span",{className:"admin-text-gray-900 admin-flex-1 admin-mr-4",children:n.value}),e.jsx("button",{onClick:()=>m(n),className:"admin-btn admin-btn-outline admin-btn-sm",title:"Редактировать перевод","aria-label":`Редактировать перевод для ключа ${n.key}`,children:"✏️ Редактировать"})]})]},l))})})]}),e.jsxs("div",{className:"admin-flex admin-justify-center admin-gap-4",children:[e.jsxs("button",{onClick:()=>{x.info("Функция автоперевода в разработке 🤖")},className:"admin-btn admin-btn-success admin-font-medium",children:[e.jsx("span",{className:"mr-2",children:"🤖"}),"Автоперевод AI"]}),e.jsxs("button",{onClick:()=>{x.info("Функция экспорта отчетов в разработке 📊")},className:"admin-btn admin-btn-primary admin-font-medium",children:[e.jsx("span",{className:"mr-2",children:"📊"}),"Экспорт отчетов"]}),e.jsx("button",{onClick:a,disabled:c,className:"admin-btn admin-btn-outline admin-font-medium",children:c?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Загружаю..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"🔄"}),"Обновить переводы"]})})]})]})},Be=[{month:"Jan",installs:120,uninstalls:15},{month:"Feb",installs:150,uninstalls:12},{month:"Mar",installs:200,uninstalls:18},{month:"Apr",installs:180,uninstalls:20},{month:"May",installs:250,uninstalls:22},{month:"Jun",installs:300,uninstalls:25}],Le=[{name:"Desktop",value:45,color:"#3b82f6"},{name:"Mobile",value:35,color:"#10b981"},{name:"Tablet",value:20,color:"#f59e0b"}],qe=()=>{const[s,j]=t.useState({appName:"Дневник Достижений",shortName:"Дневник",description:"Персональный дневник для отслеживания достижений",themeColor:"#3b82f6",backgroundColor:"#ffffff"}),[i,v]=t.useState({enableNotifications:!0,enableOfflineMode:!0,enableInstallPrompt:!0}),[r,f]=t.useState({totalInstalls:1234,retentionRate:89,averageRating:4.8,activeUsers:567}),[g,b]=t.useState(!1),p=async()=>{b(!0);try{const d=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!d){x.error("Ошибка авторизации");return}const a=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/settings",{method:"POST",headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"},body:JSON.stringify({key:"pwa_manifest",value:JSON.stringify(s)})}),m=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/settings",{method:"POST",headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"},body:JSON.stringify({key:"pwa_settings",value:JSON.stringify(i)})});a.ok&&m.ok?x.success("Настройки PWA успешно сохранены! 📱"):x.error("Ошибка сохранения настроек PWA")}catch{x.error("Ошибка соединения с сервером")}finally{b(!1)}},y=async()=>{try{x.info("Публикация обновления PWA в разработке... 🚀")}catch{x.error("Ошибка публикации обновления")}},c=async()=>{try{x.info("Анализ метрик PWA в разработке... 📊")}catch{x.error("Ошибка анализа метрик")}};return e.jsxs("div",{className:"admin-space-y-8",children:[e.jsxs("header",{className:"admin-flex admin-items-center admin-gap-4 admin-pb-4 admin-border-b admin-border-gray-200",children:[e.jsx("div",{className:"admin-p-3 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-2xl","aria-hidden":"true",children:"📱"}),e.jsxs("div",{children:[e.jsx("h2",{className:"admin-text-2xl admin-font-semibold admin-text-gray-900",children:"Настройки PWA"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600 admin-mt-1",children:"Настройки Progressive Web App для лучшего пользовательского опыта"})]}),e.jsxs("div",{className:"admin-ml-auto admin-flex admin-gap-2",children:[e.jsxs("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-success-lighter admin-text-admin-success admin-rounded-full admin-text-xs admin-font-medium admin-flex admin-items-center admin-gap-1",children:[e.jsx("div",{className:"admin-w-2 admin-h-2 admin-bg-admin-success admin-rounded-full","aria-hidden":"true"}),"Активен"]}),e.jsxs("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-primary-lighter admin-text-admin-primary admin-rounded-full admin-text-xs admin-font-medium",children:["📱 ",r.totalInstalls.toLocaleString()," установок"]})]})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 lg:admin-grid-cols-3 admin-gap-8",children:[e.jsxs("div",{className:"lg:admin-col-span-2 admin-space-y-6",children:[e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📋 Манифест PWA"}),e.jsx("p",{className:"admin-card-description",children:"Настройка веб-манифеста приложения"})]}),e.jsxs("div",{className:"admin-card-content admin-space-y-6",children:[e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 admin-gap-6",children:[e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"app-name",className:"admin-font-medium admin-text-gray-900",children:"Название приложения"}),e.jsx("input",{id:"app-name",type:"text",value:s.appName,onChange:d=>j(a=>({...a,appName:d.target.value})),className:"admin-input"})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"short-name",className:"admin-font-medium admin-text-gray-900",children:"Короткое название"}),e.jsx("input",{id:"short-name",type:"text",value:s.shortName,onChange:d=>j(a=>({...a,shortName:d.target.value})),className:"admin-input"})]})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"description",className:"admin-font-medium admin-text-gray-900",children:"Описание"}),e.jsx("input",{id:"description",type:"text",value:s.description,onChange:d=>j(a=>({...a,description:d.target.value})),className:"admin-input"})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 admin-gap-6",children:[e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"theme-color",className:"admin-font-medium admin-text-gray-900",children:"Цвет темы"}),e.jsxs("div",{className:"admin-flex admin-gap-3 admin-items-center",children:[e.jsx("input",{id:"theme-color",type:"text",value:s.themeColor,onChange:d=>j(a=>({...a,themeColor:d.target.value})),className:"admin-input admin-flex-1"}),e.jsx("div",{className:"admin-w-12 admin-h-12 admin-rounded-lg admin-border-2 admin-border-gray-300 admin-shadow-sm",style:{backgroundColor:s.themeColor},"aria-hidden":"true"})]})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"bg-color",className:"admin-font-medium admin-text-gray-900",children:"Цвет фона"}),e.jsxs("div",{className:"admin-flex admin-gap-3 admin-items-center",children:[e.jsx("input",{id:"bg-color",type:"text",value:s.backgroundColor,onChange:d=>j(a=>({...a,backgroundColor:d.target.value})),className:"admin-input admin-flex-1"}),e.jsx("div",{className:"admin-w-12 admin-h-12 admin-rounded-lg admin-border-2 admin-border-gray-300 admin-shadow-sm",style:{backgroundColor:s.backgroundColor},"aria-hidden":"true"})]})]})]})]})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"⚙️ Функции PWA"}),e.jsx("p",{className:"admin-card-description",children:"Включение и отключение возможностей приложения"})]}),e.jsx("div",{className:"admin-card-content admin-space-y-6",children:e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 admin-gap-6",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"🔔 Push-уведомления"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Разрешить отправку уведомлений"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"enable-notifications",type:"checkbox",checked:i.enableNotifications,onChange:d=>v(a=>({...a,enableNotifications:d.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]}),e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"📱 Офлайн режим"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Работа без интернета"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"enable-offline",type:"checkbox",checked:i.enableOfflineMode,onChange:d=>v(a=>({...a,enableOfflineMode:d.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]}),e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-admin-warning-lighter admin-rounded-lg admin-border admin-border-admin-warning-light md:admin-col-span-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"💡 Подсказка установки"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Предложить установить приложение"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"enable-install-prompt",type:"checkbox",checked:i.enableInstallPrompt,onChange:d=>v(a=>({...a,enableInstallPrompt:d.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]})]})})]})]}),e.jsxs("div",{className:"admin-space-y-6",children:[e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📈 Установки PWA"})}),e.jsx("div",{className:"admin-card-content",children:e.jsx(B,{data:Be,dataKey:"installs",xAxisKey:"month",title:"Установки PWA по месяцам",type:"line"})})]}),e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📱 По платформам"})}),e.jsx("div",{className:"admin-card-content",children:e.jsx(B,{data:Le,dataKey:"value",xAxisKey:"name",title:"Распределение по платформам",type:"pie"})})]}),e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📊 Метрики"})}),e.jsx("div",{className:"admin-card-content admin-space-y-4",children:e.jsxs("div",{className:"admin-grid admin-grid-cols-1 admin-gap-4",children:[e.jsxs("div",{className:"admin-p-4 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-primary-light",children:[e.jsx("div",{className:"admin-text-2xl admin-font-semibold admin-text-admin-primary admin-mb-1",children:r.totalInstalls.toLocaleString()}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"Всего установок"})]}),e.jsxs("div",{className:"admin-p-4 admin-bg-admin-success-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-success-light",children:[e.jsxs("div",{className:"admin-text-2xl admin-font-semibold admin-text-admin-success admin-mb-1",children:[r.retentionRate,"%"]}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"Retention rate"})]}),e.jsxs("div",{className:"admin-p-4 admin-bg-admin-warning-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-warning-light",children:[e.jsxs("div",{className:"admin-text-2xl admin-font-semibold admin-text-admin-warning admin-mb-1",children:["⭐ ",r.averageRating]}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"Средняя оценка"})]})]})})]})]})]}),e.jsxs("div",{className:"admin-flex admin-justify-center admin-gap-4",children:[e.jsx("button",{onClick:p,disabled:g,className:"admin-btn admin-btn-success admin-font-medium",children:g?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Сохраняю..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"💾"}),"Сохранить настройки"]})}),e.jsxs("button",{onClick:y,className:"admin-btn admin-btn-warning admin-font-medium",children:[e.jsx("span",{className:"mr-2",children:"🚀"}),"Опубликовать обновление"]}),e.jsxs("button",{onClick:c,className:"admin-btn admin-btn-primary admin-font-medium",children:[e.jsx("span",{className:"mr-2",children:"📊"}),"Анализ метрик"]})]})]})},Me=[{metric:"Отправлено",value:12345,color:"#3b82f6"},{metric:"Доставлено",value:89,color:"#10b981",percentage:!0},{metric:"Открыто",value:23,color:"#8b5cf6",percentage:!0},{metric:"CTR",value:5.2,color:"#f59e0b",percentage:!0}],Je=()=>{const[s,j]=t.useState({title:"🎉 Новое достижение!",body:"Поздравляем! Вы достигли новой цели в вашем дневнике достижений.",icon:"",badge:""}),[i,v]=t.useState({enablePush:!0,enableScheduled:!1,enableSegmentation:!0}),[r,f]=t.useState(4),[g,b]=t.useState(!1),[p,y]=t.useState(!1),c=async()=>{if(!s.title||!s.body){x.error("Заполните заголовок и текст уведомления");return}b(!0);try{const a=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!a){x.error("Ошибка авторизации");return}const m=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/send-notification",{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({title:s.title,body:s.body,icon:s.icon,badge:s.badge})});if(m.ok)x.success("Уведомление успешно отправлено! 🚀"),j({title:"🎉 Новое достижение!",body:"Поздравляем! Вы достигли новой цели в вашем дневнике достижений.",icon:"",badge:""});else{const h=await m.json().catch(()=>({}));x.error(h.error||"Ошибка при отправке уведомления")}}catch{x.error("Ошибка соединения с сервером")}finally{b(!1)}},d=async()=>{try{const a=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!a){x.error("Ошибка авторизации");return}const m=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/settings",{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({key:"push_notification_settings",value:JSON.stringify(i)})});if(m.ok)x.success("Настройки push-уведомлений сохранены! 🔔");else{const h=await m.json().catch(()=>({}));x.error(h.error||"Ошибка сохранения настроек")}}catch{x.error("Ошибка соединения с сервером")}};return e.jsxs("div",{className:"admin-space-y-8",children:[e.jsxs("header",{className:"admin-flex admin-items-center admin-gap-4 admin-pb-4 admin-border-b admin-border-gray-200",children:[e.jsx("div",{className:"admin-p-3 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-2xl","aria-hidden":"true",children:"🔔"}),e.jsxs("div",{children:[e.jsx("h2",{className:"admin-text-2xl admin-font-semibold admin-text-gray-900",children:"Push-уведомления"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600 admin-mt-1",children:"Создание и управление push уведомлениями для пользователей"})]}),e.jsxs("div",{className:"admin-ml-auto admin-flex admin-gap-2",children:[e.jsxs("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-success-lighter admin-text-admin-success admin-rounded-full admin-text-xs admin-font-medium admin-flex admin-items-center admin-gap-1",children:[e.jsx("div",{className:"admin-w-2 admin-h-2 admin-bg-admin-success admin-rounded-full","aria-hidden":"true"}),"Активен"]}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-primary-lighter admin-text-admin-primary admin-rounded-full admin-text-xs admin-font-medium",children:"📨 12,345 отправлено"})]})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 lg:admin-grid-cols-3 admin-gap-8",children:[e.jsx("div",{className:"lg:admin-col-span-2 admin-space-y-6",children:e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📝 Создание уведомления"}),e.jsx("p",{className:"admin-card-description",children:"Отправка push уведомлений пользователям"})]}),e.jsx("div",{className:"admin-card-content admin-space-y-6",children:e.jsxs("div",{className:"admin-space-y-4",children:[e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"notification-title",className:"admin-font-medium admin-text-gray-900",children:"Заголовок уведомления"}),e.jsx("input",{id:"notification-title",type:"text",value:s.title,onChange:a=>j(m=>({...m,title:a.target.value})),placeholder:"Введите заголовок уведомления",className:"admin-input"})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"notification-body",className:"admin-font-medium admin-text-gray-900",children:"Текст уведомления"}),e.jsx("textarea",{id:"notification-body",value:s.body,onChange:a=>j(m=>({...m,body:a.target.value})),placeholder:"Введите текст уведомления",rows:4,className:"admin-input admin-textarea"})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 admin-gap-6",children:[e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"notification-icon",className:"admin-font-medium admin-text-gray-900",children:"Иконка (URL)"}),e.jsx("input",{id:"notification-icon",type:"text",value:s.icon,onChange:a=>j(m=>({...m,icon:a.target.value})),placeholder:"https://example.com/icon.png",className:"admin-input"})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"notification-badge",className:"admin-font-medium admin-text-gray-900",children:"Бейдж (URL)"}),e.jsx("input",{id:"notification-badge",type:"text",value:s.badge,onChange:a=>j(m=>({...m,badge:a.target.value})),placeholder:"https://example.com/badge.png",className:"admin-input"})]})]}),e.jsx("div",{className:"admin-flex admin-justify-center admin-pt-4",children:e.jsx("button",{onClick:c,disabled:!s.title||!s.body||g,className:"admin-btn admin-btn-primary admin-font-medium admin-text-lg",children:g?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Отправляю уведомление..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"🚀"}),"Отправить уведомление"]})})})]})})]})}),e.jsxs("div",{className:"admin-space-y-6",children:[e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📊 Статистика"}),e.jsx("p",{className:"admin-card-description",children:"Эффективность уведомлений"})]}),e.jsxs("div",{className:"admin-card-content admin-space-y-4",children:[e.jsx("div",{className:"admin-grid admin-grid-cols-1 admin-gap-4",children:Me.map((a,m)=>e.jsxs("div",{className:"admin-p-4 admin-bg-gray-50 admin-rounded-lg admin-text-center admin-border admin-border-gray-200",children:[e.jsx("div",{className:`admin-text-2xl admin-font-semibold admin-mb-2 ${a.percentage?"admin-text-admin-success":"admin-text-admin-primary"}`,children:a.percentage?`${a.value}%`:a.value.toLocaleString()}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:a.metric})]},m))}),e.jsx("div",{className:"admin-p-4 admin-bg-admin-warning-lighter admin-rounded-lg admin-border admin-border-admin-warning-light",children:e.jsxs("div",{className:"admin-text-center admin-mb-4",children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-2",children:"Оценка качества уведомлений"}),e.jsx("div",{className:"admin-flex admin-justify-center admin-gap-1",children:[1,2,3,4,5].map(a=>e.jsx("button",{onClick:()=>f(a),className:`admin-text-3xl admin-transition-all admin-duration-200 admin-transform hover:admin-scale-110 ${a<=r?"admin-text-admin-warning":"admin-text-gray-400"}`,"aria-label":`Оценка ${a} из 5`,children:"★"},a))}),e.jsxs("div",{className:"admin-text-gray-700 admin-text-sm admin-mt-2",children:["Средняя оценка: ",e.jsxs("span",{className:"admin-font-semibold admin-text-admin-warning",children:[r,"/5"]})]})]})})]})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"⚙️ Настройки"}),e.jsx("p",{className:"admin-card-description",children:"Управление параметрами уведомлений"})]}),e.jsx("div",{className:"admin-card-content admin-space-y-6",children:e.jsxs("div",{className:"admin-space-y-4",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"🔔 Включить push уведомления"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Разрешить отправку уведомлений"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"enable-push",type:"checkbox",checked:i.enablePush,onChange:a=>v(m=>({...m,enablePush:a.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]}),e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"⏰ Отложенная отправка"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Планирование отправки"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"enable-scheduled",type:"checkbox",checked:i.enableScheduled,onChange:a=>v(m=>({...m,enableScheduled:a.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]}),e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"🎯 Сегментация аудитории"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Отправка разным группам"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"enable-segmentation",type:"checkbox",checked:i.enableSegmentation,onChange:a=>v(m=>({...m,enableSegmentation:a.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]})]})})]})]})]}),e.jsxs("div",{className:"admin-flex admin-justify-center admin-gap-4",children:[e.jsx("button",{onClick:d,disabled:p,className:"admin-btn admin-btn-success admin-font-medium",children:p?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Сохраняю..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"💾"}),"Сохранить настройки"]})}),e.jsxs("button",{onClick:()=>{x.info("Анализ кампаний в разработке 📊")},className:"admin-btn admin-btn-outline admin-font-medium",children:[e.jsx("span",{className:"mr-2",children:"📊"}),"Анализ кампаний"]}),e.jsxs("button",{onClick:()=>{x.info("A/B тестирование в разработке 🎯")},className:"admin-btn admin-btn-outline admin-font-medium",children:[e.jsx("span",{className:"mr-2",children:"🎯"}),"A/B тестирование"]})]})]})},We=()=>{const[s,j]=t.useState({appName:"Дневник Достижений",appDescription:"Персональный дневник для отслеживания достижений и целей",supportEmail:"support@diary.com",maxEntriesPerDay:10,enableAnalytics:!0,enableErrorReporting:!0,maintenanceMode:!1}),[i,v]=t.useState(!1),[r,f]=t.useState(!1),g=async()=>{v(!0);try{const c=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!c){x.error("Ошибка авторизации");return}const d=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/admin-api/admin/settings",{method:"POST",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify({key:"general_settings",value:JSON.stringify(s)})});if(d.ok)x.success("Настройки успешно сохранены! ✅");else{const a=await d.json().catch(()=>({}));x.error(a.error||"Ошибка сохранения настроек")}}catch{x.error("Ошибка соединения с сервером")}finally{v(!1)}},b=async()=>{f(!0);try{j({appName:"Дневник Достижений",appDescription:"Персональный дневник для отслеживания достижений и целей",supportEmail:"support@diary.com",maxEntriesPerDay:10,enableAnalytics:!0,enableErrorReporting:!0,maintenanceMode:!1}),x.success("Настройки сброшены к значениям по умолчанию! 🔄")}catch{x.error("Ошибка при сбросе настроек")}finally{f(!1)}},p=()=>{try{const c=JSON.stringify(s,null,2),d="data:application/json;charset=utf-8,"+encodeURIComponent(c),a="unity-general-settings.json",m=document.createElement("a");m.setAttribute("href",d),m.setAttribute("download",a),m.click(),x.success("Настройки экспортированы! 📤")}catch{x.error("Ошибка экспорта настроек")}},y=c=>{const d=c.target.files?.[0];if(!d)return;const a=new FileReader;a.onload=m=>{try{const h=m.target?.result,o=JSON.parse(h);j(o),x.success("Настройки импортированы! 📥")}catch{x.error("Ошибка импорта файла настроек")}},a.readAsText(d)};return e.jsxs("div",{className:"admin-space-y-8",children:[e.jsxs("header",{className:"admin-flex admin-items-center admin-gap-4 admin-pb-4 admin-border-b admin-border-gray-200",children:[e.jsx("div",{className:"admin-p-3 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-2xl","aria-hidden":"true",children:"⚙️"}),e.jsxs("div",{children:[e.jsx("h2",{className:"admin-text-2xl admin-font-semibold admin-text-gray-900",children:"Общие настройки"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600 admin-mt-1",children:"Основные параметры и конфигурация приложения"})]}),e.jsxs("div",{className:"admin-ml-auto admin-flex admin-gap-2",children:[e.jsxs("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-success-lighter admin-text-admin-success admin-rounded-full admin-text-xs admin-font-medium admin-flex admin-items-center admin-gap-1",children:[e.jsx("div",{className:"admin-w-2 admin-h-2 admin-bg-admin-success admin-rounded-full","aria-hidden":"true"}),"Активен"]}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-primary-lighter admin-text-admin-primary admin-rounded-full admin-text-xs admin-font-medium",children:"🔧 Готов к настройке"})]})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 lg:admin-grid-cols-3 admin-gap-8",children:[e.jsxs("div",{className:"lg:admin-col-span-2 admin-space-y-6",children:[e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📋 Основные параметры"}),e.jsx("p",{className:"admin-card-description",children:"Базовая конфигурация приложения"})]}),e.jsxs("div",{className:"admin-card-content admin-space-y-6",children:[e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 admin-gap-6",children:[e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"app-name",className:"admin-font-medium admin-text-gray-900",children:"Название приложения"}),e.jsx("input",{id:"app-name",type:"text",value:s.appName,onChange:c=>j(d=>({...d,appName:c.target.value})),className:"admin-input"})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"support-email",className:"admin-font-medium admin-text-gray-900",children:"Email поддержки"}),e.jsx("input",{id:"support-email",type:"email",value:s.supportEmail,onChange:c=>j(d=>({...d,supportEmail:c.target.value})),className:"admin-input"})]})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"app-description",className:"admin-font-medium admin-text-gray-900",children:"Описание приложения"}),e.jsx("textarea",{id:"app-description",value:s.appDescription,onChange:c=>j(d=>({...d,appDescription:c.target.value})),rows:3,className:"admin-input admin-textarea"})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"max-entries",className:"admin-font-medium admin-text-gray-900",children:"Максимум записей в день"}),e.jsx("input",{id:"max-entries",type:"number",value:s.maxEntriesPerDay,onChange:c=>j(d=>({...d,maxEntriesPerDay:parseInt(c.target.value)||0})),className:"admin-input"})]})]})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"🔧 Системные функции"}),e.jsx("p",{className:"admin-card-description",children:"Конфигурация дополнительных возможностей"})]}),e.jsx("div",{className:"admin-card-content admin-space-y-6",children:e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 admin-gap-6",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-admin-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"📊 Аналитика"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Сбор данных об использовании"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"enable-analytics",type:"checkbox",checked:s.enableAnalytics,onChange:c=>j(d=>({...d,enableAnalytics:c.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]}),e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-admin-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"🐛 Отчеты об ошибках"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Автоматическая отправка отчетов"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"enable-error-reporting",type:"checkbox",checked:s.enableErrorReporting,onChange:c=>j(d=>({...d,enableErrorReporting:c.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]}),e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-admin-warning-lighter admin-rounded-lg admin-border admin-border-admin-warning-light md:admin-col-span-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"🔧 Режим обслуживания"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Временно отключить приложение"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"maintenance-mode",type:"checkbox",checked:s.maintenanceMode,onChange:c=>j(d=>({...d,maintenanceMode:c.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]})]})})]})]}),e.jsx("div",{className:"admin-space-y-6",children:e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"💾 Управление данными"}),e.jsx("p",{className:"admin-card-description",children:"Экспорт и импорт настроек"})]}),e.jsxs("div",{className:"admin-card-content admin-space-y-6",children:[e.jsxs("div",{className:"admin-space-y-4",children:[e.jsx("button",{onClick:g,disabled:i,className:"admin-btn admin-btn-success admin-w-full admin-font-medium",children:i?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Сохраняю настройки..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"💾"}),"Сохранить настройки"]})}),e.jsx("button",{onClick:b,disabled:r,className:"admin-btn admin-btn-outline admin-w-full admin-font-medium",children:r?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Сбрасываю..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"🔄"}),"Сбросить настройки"]})})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 admin-gap-4",children:[e.jsxs("div",{className:"admin-p-4 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-primary-light",children:[e.jsx("div",{className:"admin-text-xl admin-font-semibold admin-text-admin-primary admin-mb-2",children:"📤 Экспорт"}),e.jsx("button",{onClick:p,className:"admin-btn admin-btn-outline admin-btn-sm",children:"Скачать JSON"})]}),e.jsxs("div",{className:"admin-p-4 admin-bg-admin-success-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-success-light",children:[e.jsx("div",{className:"admin-text-xl admin-font-semibold admin-text-admin-success admin-mb-2",children:"📥 Импорт"}),e.jsx("button",{onClick:()=>document.getElementById("import-settings-file")?.click(),className:"admin-btn admin-btn-outline admin-btn-sm",children:"Загрузить файл"}),e.jsx("input",{id:"import-settings-file",type:"file",accept:".json",className:"admin-hidden",onChange:y,"aria-label":"Импорт настроек из файла"})]})]})]})]})})]})]})},Ve=[{time:"00:00",cpu:45,memory:67,disk:23,network:12},{time:"04:00",cpu:52,memory:71,disk:25,network:15},{time:"08:00",cpu:78,memory:84,disk:28,network:45},{time:"12:00",cpu:65,memory:76,disk:26,network:32},{time:"16:00",cpu:58,memory:69,disk:24,network:28},{time:"20:00",cpu:49,memory:63,disk:22,network:18}],Ke=()=>{const[s,j]=t.useState({database:"online",api:"online",storage:"online",cache:"online"}),[i,v]=t.useState({cpu:45,memory:67,disk:23,network:12}),[r,f]=t.useState(null),[g,b]=t.useState(!1),p=async d=>{f(d);try{const a=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!a){x.error("Ошибка авторизации");return}const m=await fetch(`https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/restart/${d.toLowerCase()}`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(m.ok)x.success(`Сервис ${d} успешно перезапущен! 🔄`);else{const h=await m.json().catch(()=>({}));x.error(h.error||`Ошибка при перезапуске ${d}`)}}catch{x.error(`Ошибка соединения при перезапуске ${d}`)}finally{f(null)}},y=async()=>{b(!0);try{const d=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!d){x.error("Ошибка авторизации");return}const a=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/backup",{method:"POST",headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"}});if(a.ok){const m=await a.json();if(x.success("Резервная копия базы данных успешно создана! 💾"),m.backupUrl){const h=document.createElement("a");h.setAttribute("href",m.backupUrl),h.setAttribute("download",`unity-backup-${new Date().toISOString().split("T")[0]}.sql`),h.click()}}else{const m=await a.json().catch(()=>({}));x.error(m.error||"Ошибка при создании резервной копии")}}catch{x.error("Ошибка соединения при создании резервной копии")}finally{b(!1)}},c=()=>{x.info("Функция восстановления из резервной копии в разработке 📂")};return e.jsxs("div",{className:"admin-space-y-8",children:[e.jsxs("header",{className:"admin-flex admin-items-center admin-gap-4 admin-pb-4 admin-border-b admin-border-gray-200",children:[e.jsx("div",{className:"admin-p-3 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-2xl","aria-hidden":"true",children:"🖥️"}),e.jsxs("div",{children:[e.jsx("h2",{className:"admin-text-2xl admin-font-semibold admin-text-gray-900",children:"Системные настройки"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600 admin-mt-1",children:"Мониторинг и управление системными ресурсами в реальном времени"})]}),e.jsxs("div",{className:"admin-ml-auto admin-flex admin-gap-2",children:[e.jsxs("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-success-lighter admin-text-admin-success admin-rounded-full admin-text-xs admin-font-medium admin-flex admin-items-center admin-gap-1",children:[e.jsx("div",{className:"admin-w-2 admin-h-2 admin-bg-admin-success admin-rounded-full","aria-hidden":"true"}),"Все системы работают"]}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-primary-lighter admin-text-admin-primary admin-rounded-full admin-text-xs admin-font-medium",children:"📊 Мониторинг активен"})]})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 lg:admin-grid-cols-3 admin-gap-8",children:[e.jsx("div",{className:"lg:admin-col-span-2 admin-space-y-6",children:e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"🔍 Статус системы"}),e.jsx("p",{className:"admin-card-description",children:"Мониторинг состояния всех сервисов"})]}),e.jsx("div",{className:"admin-card-content",children:e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 admin-gap-6",children:[e.jsxs("div",{className:"admin-p-6 admin-bg-admin-success-lighter admin-rounded-lg admin-border admin-border-admin-success-light admin-relative admin-overflow-hidden",children:[e.jsx("div",{className:"admin-absolute admin-top-2 admin-right-2",children:e.jsx("div",{className:"admin-w-3 admin-h-3 admin-bg-admin-success admin-rounded-full","aria-hidden":"true"})}),e.jsxs("div",{className:"admin-text-center",children:[e.jsx("div",{className:"admin-text-3xl admin-font-semibold admin-text-admin-success admin-mb-2","aria-hidden":"true",children:"🗄️"}),e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"База данных"}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm admin-mb-3",children:"PostgreSQL"}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-success admin-text-white admin-rounded admin-text-xs admin-font-medium",children:"✅ Работает стабильно"})]})]}),e.jsxs("div",{className:"admin-p-6 admin-bg-admin-primary-lighter admin-rounded-lg admin-border admin-border-admin-primary-light admin-relative admin-overflow-hidden",children:[e.jsx("div",{className:"admin-absolute admin-top-2 admin-right-2",children:e.jsx("div",{className:"admin-w-3 admin-h-3 admin-bg-admin-primary admin-rounded-full","aria-hidden":"true"})}),e.jsxs("div",{className:"admin-text-center",children:[e.jsx("div",{className:"admin-text-3xl admin-font-semibold admin-text-admin-primary admin-mb-2","aria-hidden":"true",children:"🚀"}),e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"API сервер"}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm admin-mb-3",children:"Edge Functions"}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-primary admin-text-white admin-rounded admin-text-xs admin-font-medium",children:"✅ Высокая производительность"})]})]}),e.jsxs("div",{className:"admin-p-6 admin-bg-admin-secondary-lighter admin-rounded-lg admin-border admin-border-admin-secondary-light admin-relative admin-overflow-hidden",children:[e.jsx("div",{className:"admin-absolute admin-top-2 admin-right-2",children:e.jsx("div",{className:"admin-w-3 admin-h-3 admin-bg-admin-secondary admin-rounded-full","aria-hidden":"true"})}),e.jsxs("div",{className:"admin-text-center",children:[e.jsx("div",{className:"admin-text-3xl admin-font-semibold admin-text-admin-secondary admin-mb-2","aria-hidden":"true",children:"💾"}),e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"Хранилище"}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm admin-mb-3",children:"Supabase Storage"}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-secondary admin-text-white admin-rounded admin-text-xs admin-font-medium",children:"✅ Доступно и стабильно"})]})]}),e.jsxs("div",{className:"admin-p-6 admin-bg-admin-warning-lighter admin-rounded-lg admin-border admin-border-admin-warning-light admin-relative admin-overflow-hidden",children:[e.jsx("div",{className:"admin-absolute admin-top-2 admin-right-2",children:e.jsx("div",{className:"admin-w-3 admin-h-3 admin-bg-admin-warning admin-rounded-full","aria-hidden":"true"})}),e.jsxs("div",{className:"admin-text-center",children:[e.jsx("div",{className:"admin-text-3xl admin-font-semibold admin-text-admin-warning admin-mb-2","aria-hidden":"true",children:"⚡"}),e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"Кэш"}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm admin-mb-3",children:"Redis"}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-warning admin-text-white admin-rounded admin-text-xs admin-font-medium",children:"✅ Быстрый отклик"})]})]})]})})]})}),e.jsx("div",{className:"admin-space-y-6",children:e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📊 Ресурсы системы"}),e.jsx("p",{className:"admin-card-description",children:"Использование в реальном времени"})]}),e.jsx("div",{className:"admin-card-content admin-space-y-6",children:e.jsxs("div",{className:"admin-space-y-4",children:[e.jsxs("div",{className:"admin-space-y-2",children:[e.jsxs("div",{className:"admin-flex admin-justify-between",children:[e.jsx("span",{className:"admin-text-gray-700",children:"CPU"}),e.jsxs("span",{className:"admin-font-medium admin-text-gray-900",children:[i.cpu,"%"]})]}),e.jsx("div",{className:"admin-w-full admin-bg-gray-200 admin-rounded-full admin-h-2",children:e.jsx("div",{className:"admin-bg-admin-warning admin-h-2 admin-rounded-full admin-transition-all",style:{width:`${i.cpu}%`},"aria-label":`Использование CPU: ${i.cpu}%`})})]}),e.jsxs("div",{className:"admin-space-y-2",children:[e.jsxs("div",{className:"admin-flex admin-justify-between",children:[e.jsx("span",{className:"admin-text-gray-700",children:"Память"}),e.jsxs("span",{className:"admin-font-medium admin-text-gray-900",children:[i.memory,"%"]})]}),e.jsx("div",{className:"admin-w-full admin-bg-gray-200 admin-rounded-full admin-h-2",children:e.jsx("div",{className:"admin-bg-admin-error admin-h-2 admin-rounded-full admin-transition-all",style:{width:`${i.memory}%`},"aria-label":`Использование памяти: ${i.memory}%`})})]}),e.jsxs("div",{className:"admin-space-y-2",children:[e.jsxs("div",{className:"admin-flex admin-justify-between",children:[e.jsx("span",{className:"admin-text-gray-700",children:"Диск"}),e.jsxs("span",{className:"admin-font-medium admin-text-gray-900",children:[i.disk,"%"]})]}),e.jsx("div",{className:"admin-w-full admin-bg-gray-200 admin-rounded-full admin-h-2",children:e.jsx("div",{className:"admin-bg-admin-primary admin-h-2 admin-rounded-full admin-transition-all",style:{width:`${i.disk}%`},"aria-label":`Использование диска: ${i.disk}%`})})]}),e.jsxs("div",{className:"admin-space-y-2",children:[e.jsxs("div",{className:"admin-flex admin-justify-between",children:[e.jsx("span",{className:"admin-text-gray-700",children:"Сеть"}),e.jsxs("span",{className:"admin-font-medium admin-text-gray-900",children:[i.network,"%"]})]}),e.jsx("div",{className:"admin-w-full admin-bg-gray-200 admin-rounded-full admin-h-2",children:e.jsx("div",{className:"admin-bg-admin-success admin-h-2 admin-rounded-full admin-transition-all",style:{width:`${i.network}%`},"aria-label":`Использование сети: ${i.network}%`})})]})]})})]})})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📈 Мониторинг ресурсов (24ч)"}),e.jsx("p",{className:"admin-card-description",children:"Графики использования системных ресурсов"})]}),e.jsx("div",{className:"admin-card-content",children:e.jsx(B,{data:Ve,xAxisKey:"time",title:"Использование системных ресурсов",type:"line"})})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"🔧 Управление сервисами"}),e.jsx("p",{className:"admin-card-description",children:"Перезапуск и обслуживание системных компонентов"})]}),e.jsx("div",{className:"admin-card-content",children:e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 lg:admin-grid-cols-4 admin-gap-4",children:[e.jsx("button",{onClick:()=>p("API"),disabled:r==="API",className:"admin-btn admin-btn-primary admin-font-medium",children:r==="API"?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Перезапуск..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"🚀"}),"API сервер"]})}),e.jsx("button",{onClick:()=>p("Database"),disabled:r==="Database",className:"admin-btn admin-btn-success admin-font-medium",children:r==="Database"?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Перезапуск..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"🗄️"}),"База данных"]})}),e.jsx("button",{onClick:()=>p("Cache"),disabled:r==="Cache",className:"admin-btn admin-btn-warning admin-font-medium",children:r==="Cache"?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Очистка..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"⚡"}),"Очистить кэш"]})}),e.jsx("button",{onClick:()=>p("Storage"),disabled:r==="Storage",className:"admin-btn admin-btn-outline admin-font-medium",children:r==="Storage"?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Перезапуск..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"💾"}),"Хранилище"]})})]})})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"💾 Резервное копирование"}),e.jsx("p",{className:"admin-card-description",children:"Управление резервными копиями данных"})]}),e.jsx("div",{className:"admin-card-content",children:e.jsxs("div",{className:"admin-space-y-6",children:[e.jsxs("div",{className:"admin-flex admin-gap-4",children:[e.jsx("button",{onClick:y,disabled:g,className:"admin-btn admin-btn-success admin-font-medium",children:g?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Создаю копию..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"💾"}),"Создать резервную копию"]})}),e.jsxs("button",{onClick:c,className:"admin-btn admin-btn-outline admin-font-medium",children:[e.jsx("span",{className:"mr-2",children:"📂"}),"Восстановить из копии"]})]}),e.jsx("div",{className:"admin-p-4 admin-bg-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-3 admin-gap-4 admin-text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"Последняя копия"}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"2 часа назад"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"Размер"}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"45.2 MB"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"Статус"}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-success-lighter admin-text-admin-success admin-rounded admin-text-xs admin-font-medium admin-inline-block",children:"✅ Успешно"})]})]})})]})})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📝 Системные логи"}),e.jsx("p",{className:"admin-card-description",children:"Последние записи в логах системы"})]}),e.jsx("div",{className:"admin-card-content",children:e.jsx("div",{className:"admin-bg-gray-900 admin-text-green-400 admin-p-6 admin-rounded-lg admin-font-mono admin-text-sm admin-max-h-64 admin-overflow-y-auto admin-border admin-border-gray-700",children:e.jsxs("div",{className:"admin-space-y-1",children:[e.jsx("div",{className:"admin-text-green-300",children:"[2024-01-15 10:30:15] INFO: API request processed successfully"}),e.jsx("div",{className:"admin-text-green-300",children:"[2024-01-15 10:30:12] INFO: User authentication successful"}),e.jsx("div",{className:"admin-text-blue-300",children:"[2024-01-15 10:30:08] INFO: Database connection established"}),e.jsx("div",{className:"admin-text-green-300",children:"[2024-01-15 10:30:05] INFO: Cache cleared successfully"}),e.jsx("div",{className:"admin-text-green-300",children:"[2024-01-15 10:30:02] INFO: System startup completed"}),e.jsx("div",{className:"admin-text-yellow-300",children:"[2024-01-15 10:29:58] WARN: High memory usage detected"}),e.jsx("div",{className:"admin-text-green-300",children:"[2024-01-15 10:29:55] INFO: Scheduled backup completed"}),e.jsx("div",{className:"admin-text-green-300",children:"[2024-01-15 10:29:50] INFO: API rate limit reset"})]})})})]})]})};function Qe(){const[s,j]=t.useState(!1),[i,v]=t.useState(!1),[r,f]=t.useState(null),[g,b]=t.useState({totalUsers:0,telegramUsers:0,lastActivity:null}),[p,y]=t.useState({username:"@diary_bookai_bot",domain:"unity-diary-app.netlify.app",tokenMasked:"8297834785:******AQbo"}),c=q();t.useEffect(()=>{c.auth.getSession().then(({data:{session:h}})=>{f(h)})},[]),t.useEffect(()=>{r&&(d(),a())},[r]);const d=async()=>{if(r)try{const h=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/telegram-auth",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.access_token}`,apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVjdXd1enFsd2Rra2RuY2FtcG5jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwNTg2OTQsImV4cCI6MjA3NTYzNDY5NH0.OnBM1BIQMVgJur2nM4gZGDW-PWWwSR92DpJHhPpqB88"}});if(h.ok){const o=await h.json();j(o.connected),o.botUsername&&y(u=>({...u,username:o.botUsername})),o.domain&&y(u=>({...u,domain:o.domain}))}else j(!1)}catch{j(!1)}},a=async()=>{try{const{data:h}=await c.from("profiles").select("id, telegram_id, created_at, updated_at");if(h){const o=h.filter(n=>n.telegram_id).length,u=h.filter(n=>n.telegram_id).sort((n,l)=>new Date(l.updated_at).getTime()-new Date(n.updated_at).getTime())[0];b({totalUsers:h.length,telegramUsers:o,lastActivity:u?.updated_at||null})}}catch{}},m=async()=>{if(!r){x.error("Необходимо войти в систему");return}v(!0);try{const h=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/telegram-auth",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.access_token}`,apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVjdXd1enFsd2Rra2RuY2FtcG5jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwNTg2OTQsImV4cCI6MjA3NTYzNDY5NH0.OnBM1BIQMVgJur2nM4gZGDW-PWWwSR92DpJHhPpqB88"}});if(h.ok)(await h.json()).connected?(x.success("Интеграция с Telegram активна"),j(!0)):(x.error("Интеграция с Telegram не настроена"),j(!1));else throw new Error("Не удалось проверить интеграцию")}catch{x.error("Ошибка тестирования интеграции"),j(!1)}finally{v(!1)}};return e.jsxs("div",{style:{padding:"20px",fontFamily:"Arial, sans-serif"},children:[e.jsx("h2",{style:{marginBottom:"20px",color:"#333"},children:"Настройки Telegram"}),e.jsxs("div",{style:{marginBottom:"20px",padding:"15px",border:"1px solid #ddd",borderRadius:"8px",backgroundColor:"#f9f9f9"},children:[e.jsx("h3",{style:{margin:"0 0 10px 0",color:"#333"},children:"Статус интеграции"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:s?"#28a745":"#dc3545"}}),e.jsx("span",{style:{fontSize:"16px",fontWeight:"bold"},children:s?"Интеграция активна":"Требуется настройка"})]})]}),e.jsxs("div",{style:{marginBottom:"20px",padding:"15px",border:"1px solid #ddd",borderRadius:"8px"},children:[e.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Статистика пользователей"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[e.jsxs("div",{style:{textAlign:"center",padding:"10px",backgroundColor:"#f8f9fa",borderRadius:"4px"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#007bff"},children:g.totalUsers}),e.jsx("div",{style:{fontSize:"14px",color:"#666"},children:"Всего пользователей"})]}),e.jsxs("div",{style:{textAlign:"center",padding:"10px",backgroundColor:"#f8f9fa",borderRadius:"4px"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#28a745"},children:g.telegramUsers}),e.jsx("div",{style:{fontSize:"14px",color:"#666"},children:"Через Telegram"})]})]}),g.lastActivity&&e.jsxs("div",{style:{marginTop:"10px",fontSize:"12px",color:"#666",textAlign:"center"},children:["Последняя активность: ",new Date(g.lastActivity).toLocaleString("ru-RU")]})]}),e.jsxs("div",{style:{marginBottom:"20px",padding:"15px",border:"1px solid #ddd",borderRadius:"8px"},children:[e.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Настройки бота"}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Bot Username"}),e.jsx("input",{type:"text",value:p.username,disabled:!0,style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f5f5f5"}})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Bot Token (замаскирован)"}),e.jsx("input",{type:"text",value:p.tokenMasked,disabled:!0,style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f5f5f5",fontFamily:"monospace"}})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Домен приложения"}),e.jsx("input",{type:"text",value:p.domain,disabled:!0,style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f5f5f5"}})]}),e.jsx("button",{onClick:m,disabled:i,style:{padding:"10px 20px",backgroundColor:i?"#ccc":"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:i?"not-allowed":"pointer"},children:i?"Проверка...":"Проверить интеграцию"})]}),e.jsxs("div",{style:{padding:"15px",border:"1px solid #ddd",borderRadius:"8px",backgroundColor:"#f8f9fa"},children:[e.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Инструкции по настройке"}),e.jsxs("ol",{style:{margin:0,paddingLeft:"20px"},children:[e.jsxs("li",{style:{marginBottom:"10px"},children:[e.jsx("strong",{children:"Создайте бота в Telegram"}),e.jsx("br",{}),"Используйте @BotFather для создания нового бота"]}),e.jsxs("li",{style:{marginBottom:"10px"},children:[e.jsx("strong",{children:"Получите токен бота"}),e.jsx("br",{}),"Скопируйте токен из сообщения BotFather"]}),e.jsxs("li",{style:{marginBottom:"10px"},children:[e.jsx("strong",{children:"Настройте домены"}),e.jsx("br",{}),"Добавьте ваш домен в настройки бота через BotFather"]}),e.jsxs("li",{style:{marginBottom:"10px"},children:[e.jsx("strong",{children:"Добавьте токен в переменные окружения Supabase"}),e.jsx("br",{}),"В Dashboard → Edge Functions добавьте TELEGRAM_BOT_TOKEN"]})]})]})]})}const Ye=({className:s,activeSubTab:j,onSubTabChange:i})=>{const[v,r]=t.useState(j||"api"),[f,g]=t.useState(""),b=c=>{r(c),i?.(c)},p=[{value:"api",label:"API",icon:"🔑",description:"Управление API ключами"},{value:"telegram",label:"Telegram",icon:"📱",description:"Интеграция с Telegram"},{value:"languages",label:"Языки",icon:"🌍",description:"Настройки языков"},{value:"pwa",label:"PWA",icon:"📱",description:"PWA настройки"},{value:"push",label:"Push",icon:"🔔",description:"Push-уведомления"},{value:"general",label:"Общие",icon:"⚙️",description:"Общие настройки"},{value:"system",label:"Система",icon:"🖥️",description:"Системные настройки"}],y=p.filter(c=>c.label.toLowerCase().includes(f.toLowerCase())||c.description.toLowerCase().includes(f.toLowerCase()));return e.jsx("div",{className:`admin-panel ${s}`,children:e.jsxs("div",{className:"admin-p-6 lg:admin-p-8 admin-pb-4 admin-max-w-[1400px] admin-mx-auto",children:[e.jsxs("header",{className:"admin-mb-10",children:[e.jsx("h1",{className:"admin-text-4xl admin-font-bold admin-text-gray-900 admin-mb-3",children:"Настройки системы"}),e.jsx("p",{className:"admin-text-lg admin-text-gray-600",children:"Управление всеми аспектами системы"})]}),e.jsxs("div",{className:"admin-search-container admin-mb-10 admin-max-w-xl",children:[e.jsx("svg",{className:"admin-search-icon",width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})}),e.jsx("input",{type:"text",placeholder:"Поиск настроек...",value:f,onChange:c=>g(c.target.value),className:"admin-search-input admin-text-base","aria-label":"Поиск по настройкам"})]}),e.jsxs(Ce,{value:v,onValueChange:b,className:"w-full",children:[e.jsx("nav",{className:"admin-mb-10","aria-label":"Навигация по настройкам",children:e.jsx(_e,{className:"admin-flex admin-flex-wrap admin-gap-3 admin-bg-white admin-border admin-border-gray-200 admin-p-2 admin-rounded-xl admin-shadow-sm",children:p.map(c=>e.jsxs(Ie,{value:c.value,className:"admin-flex admin-items-center admin-gap-3 admin-px-6 admin-py-4 admin-rounded-lg admin-font-medium admin-text-base admin-transition-all admin-duration-200 admin-text-gray-700 hover:admin-text-gray-900 hover:admin-bg-gray-50 focus-visible:admin-ring-2 focus-visible:admin-ring-admin-primary focus-visible:admin-ring-offset-2 data-[state=active]:admin-bg-admin-primary data-[state=active]:admin-text-white data-[state=active]:admin-shadow-md","aria-label":`${c.label} - ${c.description}`,children:[e.jsx("span",{className:"admin-text-xl","aria-hidden":"true",children:c.icon}),e.jsx("span",{children:c.label})]},c.value))})}),e.jsx("main",{className:"min-h-[500px]",children:y.length===0&&f?e.jsxs("div",{className:"admin-text-center admin-py-12",children:[e.jsxs("p",{className:"admin-text-gray-500 admin-text-lg admin-mb-2",children:['Нет настроек, соответствующих "',f,'"']}),e.jsx("button",{onClick:()=>g(""),className:"admin-btn admin-btn-outline",children:"Очистить поиск"})]}):e.jsxs(e.Fragment,{children:[e.jsx($,{value:"api",children:e.jsx($e,{})}),e.jsx($,{value:"telegram",children:e.jsx(Qe,{})}),e.jsx($,{value:"languages",children:e.jsx(ze,{})}),e.jsx($,{value:"pwa",children:e.jsx(qe,{})}),e.jsx($,{value:"push",children:e.jsx(Je,{})}),e.jsx($,{value:"general",children:e.jsx(We,{})}),e.jsx($,{value:"system",children:e.jsx(Ke,{})})]})})]})]})})};function Ge(){const[s,j]=t.useState([]),[i,v]=t.useState({totalRevenue:47280,activeSubscriptions:156,churnRate:3.2,mrr:15600});t.useEffect(()=>{r()},[]);const r=async()=>{try{j([{id:"1",userName:"Алексей Иванов",userEmail:"alexey@example.com",plan:"premium_monthly",status:"active",startDate:"2024-02-01",nextBillingDate:"2024-04-01",amount:399},{id:"2",userName:"Мария Петрова",userEmail:"maria@example.com",plan:"premium_yearly",status:"active",startDate:"2024-01-15",nextBillingDate:"2025-01-15",amount:3990}])}catch{}},f=b=>b==="premium_yearly"?e.jsx(R,{className:"bg-accent/10 text-accent border-accent",children:"Годовая"}):e.jsx(R,{variant:"outline",children:"Месячная"}),g=b=>b==="active"?e.jsx(R,{className:"bg-green-500/10 text-green-600 border-green-500/20",children:"Активна"}):e.jsx(R,{variant:"outline",className:"bg-muted",children:"Отменена"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(I,{children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[14px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4"}),"Общий доход"]})}),e.jsx(A,{children:e.jsxs("div",{className:"!text-[28px] !font-semibold text-foreground",children:[i.totalRevenue.toLocaleString()," ₽"]})})]}),e.jsxs(I,{children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[14px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),"Активных подписок"]})}),e.jsx(A,{children:e.jsx("div",{className:"!text-[28px] !font-semibold text-foreground",children:i.activeSubscriptions})})]}),e.jsxs(I,{children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[14px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"MRR"]})}),e.jsx(A,{children:e.jsxs("div",{className:"!text-[28px] !font-semibold text-foreground",children:[i.mrr.toLocaleString()," ₽"]})})]}),e.jsxs(I,{children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[14px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"Churn Rate"]})}),e.jsx(A,{children:e.jsxs("div",{className:"!text-[28px] !font-semibold text-foreground",children:[i.churnRate,"%"]})})]})]}),e.jsxs(I,{children:[e.jsxs(T,{children:[e.jsx(P,{className:"!text-[20px] !font-semibold",children:"Активные подписки"}),e.jsx(V,{children:"Управление премиум-подписками пользователей"})]}),e.jsx(A,{children:e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(de,{children:[e.jsx(te,{children:e.jsxs(W,{children:[e.jsx(E,{children:"Пользователь"}),e.jsx(E,{children:"План"}),e.jsx(E,{children:"Статус"}),e.jsx(E,{children:"Дата начала"}),e.jsx(E,{children:"След. платеж"}),e.jsx(E,{className:"text-right",children:"Сумма"})]})}),e.jsx(re,{children:s.map(b=>e.jsxs(W,{children:[e.jsx(O,{children:e.jsxs("div",{children:[e.jsx("div",{className:"!text-[14px] !font-semibold text-foreground",children:b.userName}),e.jsx("div",{className:"!text-[12px] !font-normal text-muted-foreground",children:b.userEmail})]})}),e.jsx(O,{children:f(b.plan)}),e.jsx(O,{children:g(b.status)}),e.jsx(O,{className:"!text-[13px]",children:b.startDate}),e.jsx(O,{className:"!text-[13px]",children:b.nextBillingDate}),e.jsxs(O,{className:"text-right !text-[14px] !font-semibold",children:[b.amount," ₽"]})]},b.id))})]})})})]})]})}function Xe({userData:s,onLogout:j}){const[i,v]=t.useState("overview"),[r,f]=t.useState(!1),[g,b]=t.useState(!1),[p,y]=t.useState("pwa"),[c,d]=t.useState({totalUsers:0,activeUsers:0,premiumUsers:0,totalRevenue:0,newUsersToday:0,activeToday:0,totalEntries:0,pwaInstalls:0}),a=s?.profile?.role==="super_admin"||s?.role==="super_admin";t.useEffect(()=>{a&&m()},[a]),t.useEffect(()=>{const o=u=>{const{tab:n,subtab:l}=u.detail;n&&v(n),l&&y(l)};return window.addEventListener("admin-navigate",o),()=>{window.removeEventListener("admin-navigate",o)}},[]);const m=async()=>{try{b(!0);const o=q(),{data:{session:u}}=await o.auth.getSession();if(!u?.access_token)throw new Error("No session");const n=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/admin-api/admin/stats",{headers:{Authorization:`Bearer ${u.access_token}`,"Content-Type":"application/json"}});if(!n.ok)throw new Error("Failed to load stats");const l=await n.json(),{success:N,...k}=l;d(k)}catch{x.error("Ошибка загрузки статистики"),d({totalUsers:0,activeUsers:0,premiumUsers:0,totalRevenue:0,newUsersToday:0,activeToday:0,totalEntries:0,pwaInstalls:0})}finally{b(!1)}};if(!a)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsx(I,{className:"max-w-md w-full border-border",children:e.jsx(A,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(M,{className:"w-16 h-16 text-destructive mx-auto mb-4"}),e.jsx("p",{className:"text-foreground mb-2",children:"Доступ запрещён"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"У вас нет прав для доступа к панели администратора"}),e.jsx(D,{onClick:j,className:"w-full bg-accent hover:bg-accent/90 text-accent-foreground",children:"Выйти"})]})})})});const h=[{id:"overview",label:"Обзор",icon:je},{id:"users",label:"Пользователи",icon:J},{id:"subscriptions",label:"Подписки",icon:ie},{id:"settings",label:"Настройки",icon:be}];return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("aside",{className:"hidden lg:fixed lg:inset-y-0 lg:left-0 lg:z-50 lg:block lg:w-64 lg:overflow-y-auto lg:bg-card lg:border-r lg:border-border",children:[e.jsxs("div",{className:"flex h-16 items-center gap-3 border-b border-border px-6 bg-accent",children:[e.jsx("div",{className:"w-10 h-10 rounded-[var(--radius)] bg-white/20 backdrop-blur-sm flex items-center justify-center shrink-0",children:e.jsx(M,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-white !text-[17px]",children:"Admin Panel"}),e.jsx("p",{className:"text-white/80 !text-[13px] !font-normal",children:"Дневник Достижений"})]})]}),e.jsx("nav",{className:"p-4 space-y-1",children:h.map(o=>{const u=o.icon,n=i===o.id;return e.jsxs(U.button,{onClick:()=>v(o.id),className:`
                  w-full flex items-center gap-3 px-3 py-2.5 rounded-[var(--radius)] transition-all !text-[15px] relative
                  ${n?"bg-accent text-accent-foreground shadow-lg":"text-foreground hover:bg-muted"}
                `,whileHover:{scale:1.02},whileTap:{scale:.98},transition:{type:"spring",stiffness:400,damping:17},children:[e.jsx(u,{className:"w-5 h-5"}),e.jsx("span",{children:o.label}),n&&e.jsx(U.div,{className:"absolute inset-0 bg-accent/20 rounded-[var(--radius)]",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.2}})]},o.id)})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t border-border bg-card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3 px-3 py-2 bg-muted rounded-[var(--radius)]",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-accent flex items-center justify-center text-accent-foreground shrink-0",children:s?.email?.[0].toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"!text-[14px] text-foreground truncate",children:s?.email}),e.jsx("p",{className:"!text-[12px] text-muted-foreground !font-normal",children:"Супер-администратор"})]})]}),e.jsxs(D,{variant:"outline",className:"w-full justify-start gap-2 !text-[15px]",onClick:j,children:[e.jsx(K,{className:"w-4 h-4"}),"Выход"]})]})]}),e.jsx(Z,{children:r&&e.jsxs(e.Fragment,{children:[e.jsx(U.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>f(!1)}),e.jsxs(U.aside,{initial:{x:-280},animate:{x:0},exit:{x:-280},transition:{type:"spring",damping:30,stiffness:300},className:"fixed inset-y-0 left-0 z-50 w-64 bg-card border-r border-border lg:hidden overflow-y-auto",children:[e.jsxs("div",{className:"flex h-16 items-center justify-between border-b border-border px-6 bg-accent",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-[var(--radius)] bg-white/20 backdrop-blur-sm flex items-center justify-center shrink-0",children:e.jsx(M,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-white !text-[17px]",children:"Admin"}),e.jsx("p",{className:"text-white/80 !text-[13px] !font-normal",children:"Панель управления"})]})]}),e.jsx("button",{onClick:()=>f(!1),className:"text-white",children:e.jsx(fe,{className:"w-6 h-6"})})]}),e.jsx("nav",{className:"p-4 space-y-1",children:h.map(o=>{const u=o.icon,n=i===o.id;return e.jsxs(U.button,{onClick:()=>{v(o.id),f(!1)},className:`
                        w-full flex items-center gap-3 px-3 py-2.5 rounded-[var(--radius)] transition-all !text-[15px] relative
                        ${n?"bg-accent text-accent-foreground shadow-lg":"text-foreground hover:bg-muted"}
                      `,whileHover:{scale:1.02},whileTap:{scale:.98},transition:{type:"spring",stiffness:400,damping:17},children:[e.jsx(u,{className:"w-5 h-5"}),e.jsx("span",{children:o.label}),n&&e.jsx(U.div,{className:"absolute inset-0 bg-accent/20 rounded-[var(--radius)]",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.2}})]},o.id)})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t border-border bg-card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3 px-3 py-2 bg-muted rounded-[var(--radius)]",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-accent flex items-center justify-center text-accent-foreground shrink-0",children:s?.email?.[0].toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"!text-[14px] text-foreground truncate",children:s?.email}),e.jsx("p",{className:"!text-[12px] text-muted-foreground !font-normal",children:"Супер-админ"})]})]}),e.jsxs(D,{variant:"outline",className:"w-full justify-start gap-2 !text-[15px]",onClick:j,children:[e.jsx(K,{className:"w-4 h-4"}),"Выход"]})]})]})]})}),e.jsxs("div",{className:"lg:pl-64",children:[e.jsx("header",{className:"sticky top-0 z-30 bg-card border-b border-border",children:e.jsxs("div",{className:"flex h-16 items-center justify-between px-4 lg:px-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>f(!0),className:"lg:hidden w-10 h-10 rounded-[var(--radius)] hover:bg-muted flex items-center justify-center",children:e.jsx(Ne,{className:"w-5 h-5 text-foreground"})}),e.jsx("h2",{className:"text-foreground !text-[17px]",children:h.find(o=>o.id===i)?.label})]}),e.jsx("button",{onClick:j,className:"lg:hidden w-10 h-10 rounded-[var(--radius)] hover:bg-muted flex items-center justify-center",title:"Выход",children:e.jsx(K,{className:"w-5 h-5 text-muted-foreground"})})]})}),e.jsx("main",{className:"p-4 lg:p-8",children:e.jsx(Z,{mode:"wait",children:e.jsxs(U.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,ease:[.4,0,.2,1]},className:"w-full",children:[i==="overview"&&e.jsx(He,{stats:c,isLoading:g,onRefresh:m}),i==="users"&&e.jsx(me,{}),i==="subscriptions"&&e.jsx(Ge,{}),i==="settings"&&e.jsx(Ye,{activeSubTab:p,onSubTabChange:y})]},i)})})]})]})}function He({stats:s,isLoading:j,onRefresh:i}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"!text-[26px] text-foreground",children:"Обзор системы"}),e.jsx("p",{className:"!text-[15px] text-muted-foreground !font-normal",children:"Статистика и метрики приложения"})]}),e.jsxs(D,{onClick:i,disabled:j,variant:"outline",className:"gap-2",children:[e.jsx(G,{className:`w-4 h-4 ${j?"animate-spin":""}`}),"Обновить"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 lg:gap-6",children:[e.jsxs(I,{className:"border-border",children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[13px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),"Всего пользователей"]})}),e.jsxs(A,{children:[e.jsx("div",{className:"!text-[34px] text-foreground",children:s.totalUsers}),e.jsxs("p",{className:"!text-[13px] text-accent !font-normal mt-1",children:["+",s.newUsersToday," сегодня"]})]})]}),e.jsxs(I,{className:"border-border",children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[13px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),"Активные пользователи"]})}),e.jsxs(A,{children:[e.jsx("div",{className:"!text-[34px] text-foreground",children:s.activeUsers}),e.jsxs("p",{className:"!text-[13px] text-muted-foreground !font-normal mt-1",children:[s.totalUsers>0?Math.round(s.activeUsers/s.totalUsers*100):0,"% от всех"]})]})]}),e.jsxs(I,{className:"border-border",children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[13px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4"}),"Premium подписки"]})}),e.jsxs(A,{children:[e.jsx("div",{className:"!text-[34px] text-foreground",children:s.premiumUsers}),e.jsxs("p",{className:"!text-[13px] text-muted-foreground !font-normal mt-1",children:[s.totalUsers>0?Math.round(s.premiumUsers/s.totalUsers*100):0,"% конверсия"]})]})]}),e.jsxs(I,{className:"border-border",children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[13px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4"}),"Общий доход"]})}),e.jsxs(A,{children:[e.jsxs("div",{className:"!text-[34px] text-foreground",children:["$",s.totalRevenue]}),e.jsxs("p",{className:"!text-[13px] text-muted-foreground !font-normal mt-1",children:["$",s.premiumUsers>0?Math.round(s.totalRevenue/s.premiumUsers):0," ARPU"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 lg:gap-6",children:[e.jsxs(I,{className:"border-border",children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[13px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),"Всего записей"]})}),e.jsxs(A,{children:[e.jsx("div",{className:"!text-[34px] text-foreground",children:s.totalEntries}),e.jsxs("p",{className:"!text-[13px] text-muted-foreground !font-normal mt-1",children:[s.activeUsers>0?(s.totalEntries/s.activeUsers).toFixed(1):0," на активного пользователя"]})]})]}),e.jsxs(I,{className:"border-border",children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[13px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4"}),"PWA установок"]})}),e.jsxs(A,{children:[e.jsx("div",{className:"!text-[34px] text-foreground",children:s.pwaInstalls}),e.jsxs("p",{className:"!text-[13px] text-muted-foreground !font-normal mt-1",children:[s.totalUsers>0?Math.round(s.pwaInstalls/s.totalUsers*100):0,"% от всех пользователей"]})]})]})]}),e.jsxs(I,{className:"border-border",children:[e.jsxs(T,{children:[e.jsx(P,{className:"!text-[17px]",children:"Быстрые действия"}),e.jsx(V,{className:"!text-[13px] !font-normal",children:"Управление ключевыми функциями приложения"})]}),e.jsx(A,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(D,{variant:"outline",className:"justify-start h-auto py-4 border-border",onClick:()=>window.dispatchEvent(new CustomEvent("admin-navigate",{detail:{tab:"settings",subtab:"pwa"}})),children:e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("div",{className:"w-10 h-10 rounded-[var(--radius)] bg-accent/10 flex items-center justify-center shrink-0",children:e.jsx(ee,{className:"w-5 h-5 text-accent"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"!text-[15px] text-foreground",children:"Настройки PWA"}),e.jsx("p",{className:"!text-[13px] text-muted-foreground !font-normal",children:"Управление установкой и обновлениями"})]})]})}),e.jsx(D,{variant:"outline",className:"justify-start h-auto py-4 border-border",onClick:()=>window.dispatchEvent(new CustomEvent("admin-navigate",{detail:{tab:"settings",subtab:"push"}})),children:e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("div",{className:"w-10 h-10 rounded-[var(--radius)] bg-accent/10 flex items-center justify-center shrink-0",children:e.jsx(Q,{className:"w-5 h-5 text-accent"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"!text-[15px] text-foreground",children:"Push-уведомления"}),e.jsx("p",{className:"!text-[13px] text-muted-foreground !font-normal",children:"Отправка уведомлений пользователям"})]})]})}),e.jsx(D,{variant:"outline",className:"justify-start h-auto py-4 border-border",onClick:()=>window.dispatchEvent(new CustomEvent("admin-navigate",{detail:{tab:"users"}})),children:e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("div",{className:"w-10 h-10 rounded-[var(--radius)] bg-accent/10 flex items-center justify-center shrink-0",children:e.jsx(J,{className:"w-5 h-5 text-accent"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"!text-[15px] text-foreground",children:"Управление пользователями"}),e.jsx("p",{className:"!text-[13px] text-muted-foreground !font-normal",children:"Просмотр и редактирование пользователей"})]})]})}),e.jsx(D,{variant:"outline",className:"justify-start h-auto py-4 border-border",onClick:()=>window.dispatchEvent(new CustomEvent("admin-navigate",{detail:{tab:"subscriptions"}})),children:e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("div",{className:"w-10 h-10 rounded-[var(--radius)] bg-accent/10 flex items-center justify-center shrink-0",children:e.jsx(ie,{className:"w-5 h-5 text-accent"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"!text-[15px] text-foreground",children:"Управление подписками"}),e.jsx("p",{className:"!text-[13px] text-muted-foreground !font-normal",children:"Premium подписки и платежи"})]})]})})]})})]}),e.jsxs(I,{className:"border-border",children:[e.jsx(T,{children:e.jsxs(P,{className:"flex items-center gap-2 !text-[17px]",children:[e.jsx(Q,{className:"w-5 h-5"}),"Статус системы"]})}),e.jsx(A,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsx("span",{className:"!text-[15px] text-foreground",children:"База данных"})]}),e.jsx(R,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/20 !text-[13px]",children:"Работает"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsx("span",{className:"!text-[15px] text-foreground",children:"API сервер"})]}),e.jsx(R,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/20 !text-[13px]",children:"Работает"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsx("span",{className:"!text-[15px] text-foreground",children:"Service Worker"})]}),e.jsx(R,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/20 !text-[13px]",children:"Активен v1.0.3"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsx("span",{className:"!text-[15px] text-foreground",children:"Push-уведомления"})]}),e.jsx(R,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/20 !text-[13px]",children:"Включено"})]})]})})]})]})}const na=Object.freeze(Object.defineProperty({__proto__:null,AdminDashboard:Xe,UsersManagementTab:me},Symbol.toStringTag,{value:"Module"}));export{na as a,q as c,sa as i,Pe as p};
