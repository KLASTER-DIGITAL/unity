import{r as t,j as e,A as ve,S as J,E as ye,a as we,R as se,b as ke,c as Se,M as Ce,C as _e,B as Ie,D as pe,U as W,T as me,L as Ae,d as ge,e as De,f as Z,X as Te,g as Pe,h as ee,i as Re,k as Fe,l as le}from"./vendor-react-fV-kJ7tt.js";import{C as I,a as T,b as P,c as X,d as A,I as ie,B as D,T as je,e as be,f as V,g as O,h as fe,i as $,j as F,D as Oe,k as $e,l as ze,m as ae,n as Ee,o as Le,p as Ue,q as E}from"./shared-components-BaxPbTVL.js";import{m as z,t as h,A as ce}from"./vendor-utils-ItDCLaFr.js";import{c as qe}from"./vendor-supabase-C-bm-_q4.js";import{R as B,P as ne,a as de,C as te,T as L,L as re,b as K,X as Q,Y,c as oe,d as G,A as Be,e as Me}from"./vendor-charts-BAM5tlgI.js";const Je="https://ecuwuzqlwdkkdncampnc.supabase.co",We="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVjdXd1enFsd2Rra2RuY2FtcG5jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwNTg2OTQsImV4cCI6MjA3NTYzNDY5NH0.OnBM1BIQMVgJur2nM4gZGDW-PWWwSR92DpJHhPpqB88",M=qe(Je,We,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:window.localStorage,storageKey:"supabase.auth.token"}});function H(){return M}const Ve="ecuwuzqlwdkkdncampnc";function Ke({onComplete:i,onBack:j}){const[d,v]=t.useState(""),[l,f]=t.useState(""),[p,b]=t.useState(!1),[o,y]=t.useState(!1),c=async n=>{if(n.preventDefault(),!d||!l){h.error("Заполните все поля");return}if(d!=="diary@leadshunter.biz"){h.error("У вас нет прав доступа к панели администратора");return}y(!0);try{const a=H(),{data:r,error:u}=await a.auth.signInWithPassword({email:d,password:l});if(u){h.error("Неверный email или пароль");return}if(!r.session){h.error("Не удалось войти в систему");return}let g;try{const s=await fetch(`https://${Ve}.supabase.co/functions/v1/make-server-9729c493/profiles/${r.user.id}`,{headers:{Authorization:`Bearer ${r.session.access_token}`,"Content-Type":"application/json"}});if(s.ok){const m=await s.json();m.success&&(g=m)}}catch{}g||(g={success:!0,profile:{name:"Admin",diaryName:"Admin Diary",diaryEmoji:"🏆",language:"ru",notificationSettings:{selectedTime:"none",morningTime:"08:00",eveningTime:"21:00",permissionGranted:!1},createdAt:new Date().toISOString()}});const x={id:r.user.id,email:r.user.email,name:g.profile.name,diaryData:{name:g.profile.diaryName,emoji:g.profile.diaryEmoji},language:g.profile.language,notificationSettings:g.profile.notificationSettings,createdAt:g.profile.createdAt};h.success("Вход выполнен успешно"),i(x)}catch{h.error("Ошибка входа. Попробуйте снова.")}finally{y(!1)}};return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},className:"w-full max-w-md",children:[e.jsxs(I,{className:"shadow-lg",children:[e.jsxs(T,{className:"space-y-4 text-center pb-6",children:[e.jsx("button",{onClick:j,className:"absolute top-6 left-6 w-10 h-10 rounded-full bg-muted hover:bg-accent/10 flex items-center justify-center transition-colors",children:e.jsx(ve,{className:"w-5 h-5 text-foreground"})}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-accent flex items-center justify-center",children:e.jsx(J,{className:"w-8 h-8 text-white"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{className:"text-foreground",children:"Панель администратора"}),e.jsx(X,{children:"Вход только для супер-администратора"})]})]}),e.jsx(A,{children:e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"admin-email",className:"text-foreground",children:"Email"}),e.jsx(ie,{id:"admin-email",type:"email",placeholder:"diary@leadshunter.biz",value:d,onChange:n=>v(n.target.value),disabled:o,className:"h-12",autoComplete:"email",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"admin-password",className:"text-foreground",children:"Пароль"}),e.jsxs("div",{className:"relative",children:[e.jsx(ie,{id:"admin-password",type:p?"text":"password",placeholder:"Введите пароль",value:l,onChange:n=>f(n.target.value),disabled:o,className:"h-12 pr-12",autoComplete:"current-password",required:!0}),e.jsx("button",{type:"button",onClick:()=>b(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",tabIndex:-1,children:p?e.jsx(ye,{className:"w-5 h-5"}):e.jsx(we,{className:"w-5 h-5"})})]})]}),e.jsx(D,{type:"submit",className:"w-full h-12 bg-accent hover:bg-accent/90 text-white mt-6",disabled:o,children:o?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Вход..."]}):"Войти"}),e.jsx("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(J,{className:"w-5 h-5 text-accent shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx("p",{className:"mb-1",children:"Защищенный доступ"}),e.jsxs("p",{children:["Только для пользователя с email"," ",e.jsx("span",{className:"text-foreground font-semibold",children:"diary@leadshunter.biz"})]})]})]})})]})})]}),e.jsx("div",{className:"mt-6 text-center text-muted-foreground",children:e.jsxs("p",{children:["Нет доступа?"," ",e.jsx("button",{onClick:j,className:"text-accent hover:underline font-semibold",children:"Вернуться на главную"})]})})]})})}const ba=Object.freeze(Object.defineProperty({__proto__:null,AdminLoginScreen:Ke},Symbol.toStringTag,{value:"Module"}));function Ne(){const[i,j]=t.useState([]),[d,v]=t.useState(""),[l,f]=t.useState("all"),[p,b]=t.useState(!1),[o,y]=t.useState(1),[c,n]=t.useState(1);t.useEffect(()=>{a()},[o]);const a=async()=>{try{b(!0);const x=H(),{data:{session:s}}=await x.auth.getSession();if(!s?.access_token)throw new Error("No session");const m=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/users",{headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"}});if(!m.ok)throw new Error("Failed to load users");const N=await m.json(),_=N.users.map(w=>({id:w.id,name:w.name,email:w.email,status:w.isPremium?"premium":"active",registeredAt:w.createdAt,lastActive:w.lastActivity,entriesCount:w.entriesCount,streak:0}));j(_),n(Math.ceil(N.total/50))}catch{h.error("Ошибка загрузки пользователей"),j([])}finally{b(!1)}},r=async(x,s)=>{try{const m=s!=="premium";h.success(`Подписка ${m?"активирована":"деактивирована"}`),a()}catch{h.error("Ошибка обновления подписки")}},u=i.filter(x=>{const s=x.name.toLowerCase().includes(d.toLowerCase())||x.email.toLowerCase().includes(d.toLowerCase()),m=l==="all"||x.status===l;return s&&m}),g=x=>{switch(x){case"premium":return e.jsx(F,{className:"bg-accent/10 text-accent border-accent",children:"Premium"});case"active":return e.jsx(F,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/20",children:"Активный"});case"blocked":return e.jsx(F,{variant:"destructive",children:"Заблокирован"});default:return e.jsx(F,{variant:"outline",children:"Неактивный"})}};return e.jsx("div",{className:"space-y-6",children:e.jsxs(I,{children:[e.jsx(T,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(P,{children:"Управление пользователями"}),e.jsx(X,{children:"Просмотр и управление аккаунтами пользователей"})]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:a,disabled:p,className:"gap-2",children:[e.jsx(se,{className:`w-4 h-4 ${p?"animate-spin":""}`}),"Обновить"]})]})}),e.jsxs(A,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ke,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(ie,{placeholder:"Поиск по имени или email...",value:d,onChange:x=>v(x.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{variant:l==="all"?"default":"outline",onClick:()=>f("all"),className:"!text-[13px]",children:"Все"}),e.jsx(D,{variant:l==="active"?"default":"outline",onClick:()=>f("active"),className:"!text-[13px]",children:"Активные"}),e.jsx(D,{variant:l==="premium"?"default":"outline",onClick:()=>f("premium"),className:"!text-[13px]",children:"Premium"})]})]}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(je,{children:[e.jsx(be,{children:e.jsxs(V,{children:[e.jsx(O,{children:"Пользователь"}),e.jsx(O,{children:"Статус"}),e.jsx(O,{children:"Зарегистрирован"}),e.jsx(O,{children:"Записей"}),e.jsx(O,{children:"Streak"}),e.jsx(O,{className:"text-right",children:"Действия"})]})}),e.jsx(fe,{children:u.map(x=>e.jsxs(V,{children:[e.jsx($,{children:e.jsxs("div",{children:[e.jsx("div",{className:"!text-[14px] !font-semibold text-foreground",children:x.name}),e.jsx("div",{className:"!text-[12px] !font-normal text-muted-foreground",children:x.email})]})}),e.jsx($,{children:g(x.status)}),e.jsx($,{className:"!text-[13px]",children:x.registeredAt?new Date(x.registeredAt).toLocaleDateString("ru-RU"):"-"}),e.jsx($,{className:"!text-[13px]",children:x.entriesCount}),e.jsx($,{children:e.jsxs(F,{variant:"outline",className:"bg-accent/10 text-accent",children:["🔥 ",x.streak]})}),e.jsx($,{className:"text-right",children:e.jsxs(Oe,{children:[e.jsx($e,{asChild:!0,children:e.jsx(D,{variant:"ghost",size:"sm",children:e.jsx(Se,{className:"w-4 h-4"})})}),e.jsxs(ze,{align:"end",children:[e.jsxs(ae,{children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Отправить email"]}),e.jsxs(ae,{onClick:()=>r(x.id,x.status),children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),x.status==="premium"?"Отменить Premium":"Выдать Premium"]}),e.jsxs(ae,{className:"text-destructive",children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Заблокировать"]})]})]})})]},x.id))})]})}),p&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(se,{className:"w-8 h-8 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"Загрузка..."})]}),!p&&u.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Пользователи не найдены"})}),!p&&c>1&&e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("p",{className:"text-muted-foreground",children:["Страница ",o," из ",c]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{variant:"outline",size:"sm",onClick:()=>y(x=>Math.max(1,x-1)),disabled:o===1,children:"Назад"}),e.jsx(D,{variant:"outline",size:"sm",onClick:()=>y(x=>Math.min(c,x+1)),disabled:o===c,children:"Вперёд"})]})]})]})]})})}const Qe=()=>{const[i,j]=t.useState({totalRequests:0,totalTokens:0,totalCost:0,avgCostPerRequest:0}),[d,v]=t.useState(!0),[l,f]=t.useState("30d");t.useEffect(()=>{p()},[l]);const p=async()=>{v(!0);try{const o=new Date,y=new Date;switch(l){case"7d":y.setDate(o.getDate()-7);break;case"30d":y.setDate(o.getDate()-30);break;case"90d":y.setDate(o.getDate()-90);break}const{data:c,error:n}=await M.from("openai_usage").select("total_tokens, estimated_cost").gte("created_at",y.toISOString()).lte("created_at",o.toISOString());if(n)return;if(c){const a=c.length,r=c.reduce((g,x)=>g+x.total_tokens,0),u=c.reduce((g,x)=>g+parseFloat(x.estimated_cost),0);j({totalRequests:a,totalTokens:r,totalCost:u,avgCostPerRequest:a>0?u/a:0})}}catch{}finally{v(!1)}},b=o=>new Intl.NumberFormat("ru-RU").format(o);return e.jsxs("div",{className:"admin-space-y-6",children:[e.jsxs("div",{className:"admin-flex admin-justify-between admin-items-center",children:[e.jsx("h3",{className:"admin-text-lg admin-font-semibold admin-text-gray-900",children:"📊 Статистика использования"}),e.jsx("div",{className:"admin-flex admin-gap-2",children:["7d","30d","90d"].map(o=>e.jsx("button",{onClick:()=>f(o),className:`admin-px-4 admin-py-2 admin-rounded-lg admin-text-sm admin-font-medium admin-transition-colors ${l===o?"admin-bg-admin-primary admin-text-white":"admin-bg-gray-100 admin-text-gray-700 hover:admin-bg-gray-200"}`,children:o==="7d"?"7 дней":o==="30d"?"30 дней":"90 дней"},o))})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 lg:admin-grid-cols-4 admin-gap-6",children:[e.jsxs("div",{className:"admin-card admin-p-6 admin-bg-gradient-to-br admin-from-blue-50 admin-to-blue-100 admin-border admin-border-blue-200",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-mb-4",children:[e.jsx("div",{className:"admin-text-3xl",children:"📊"}),d&&e.jsx("div",{className:"admin-spinner admin-w-5 admin-h-5"})]}),e.jsx("div",{className:"admin-text-sm admin-text-blue-600 admin-font-medium admin-mb-1",children:"Всего запросов"}),e.jsx("div",{className:"admin-text-3xl admin-font-bold admin-text-blue-900",children:d?"...":b(i.totalRequests)}),e.jsxs("div",{className:"admin-text-xs admin-text-blue-600 admin-mt-2",children:["За последние ",l==="7d"?"7":l==="30d"?"30":"90"," дней"]})]}),e.jsxs("div",{className:"admin-card admin-p-6 admin-bg-gradient-to-br admin-from-green-50 admin-to-green-100 admin-border admin-border-green-200",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-mb-4",children:[e.jsx("div",{className:"admin-text-3xl",children:"🔢"}),d&&e.jsx("div",{className:"admin-spinner admin-w-5 admin-h-5"})]}),e.jsx("div",{className:"admin-text-sm admin-text-green-600 admin-font-medium admin-mb-1",children:"Всего токенов"}),e.jsx("div",{className:"admin-text-3xl admin-font-bold admin-text-green-900",children:d?"...":b(i.totalTokens)}),e.jsx("div",{className:"admin-text-xs admin-text-green-600 admin-mt-2",children:"Использовано токенов"})]}),e.jsxs("div",{className:"admin-card admin-p-6 admin-bg-gradient-to-br admin-from-purple-50 admin-to-purple-100 admin-border admin-border-purple-200",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-mb-4",children:[e.jsx("div",{className:"admin-text-3xl",children:"💰"}),d&&e.jsx("div",{className:"admin-spinner admin-w-5 admin-h-5"})]}),e.jsx("div",{className:"admin-text-sm admin-text-purple-600 admin-font-medium admin-mb-1",children:"Общая стоимость"}),e.jsx("div",{className:"admin-text-3xl admin-font-bold admin-text-purple-900",children:d?"...":`$${i.totalCost.toFixed(2)}`}),e.jsx("div",{className:"admin-text-xs admin-text-purple-600 admin-mt-2",children:"Расходы на API"})]}),e.jsxs("div",{className:"admin-card admin-p-6 admin-bg-gradient-to-br admin-from-orange-50 admin-to-orange-100 admin-border admin-border-orange-200",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-mb-4",children:[e.jsx("div",{className:"admin-text-3xl",children:"📈"}),d&&e.jsx("div",{className:"admin-spinner admin-w-5 admin-h-5"})]}),e.jsx("div",{className:"admin-text-sm admin-text-orange-600 admin-font-medium admin-mb-1",children:"Средняя стоимость"}),e.jsx("div",{className:"admin-text-3xl admin-font-bold admin-text-orange-900",children:d?"...":`$${i.avgCostPerRequest.toFixed(4)}`}),e.jsx("div",{className:"admin-text-xs admin-text-orange-600 admin-mt-2",children:"На один запрос"})]})]}),e.jsx("div",{className:"admin-flex admin-justify-end",children:e.jsxs("button",{onClick:p,disabled:d,className:"admin-btn admin-btn-outline admin-btn-sm admin-flex admin-items-center admin-gap-2",children:[e.jsx("span",{children:"🔄"}),d?"Обновление...":"Обновить данные"]})})]})},q={ai_card:"#3b82f6",translation:"#10b981",transcription:"#f59e0b",pdf_export:"#8b5cf6",other:"#6b7280"},xe={ai_card:"🤖 AI Анализ",translation:"🌍 Переводы",transcription:"🎤 Транскрипция",pdf_export:"📄 PDF Экспорт",other:"📦 Другое"},Ye=()=>{const[i,j]=t.useState([]),[d,v]=t.useState(!0),[l,f]=t.useState("30d"),[p,b]=t.useState("requests");t.useEffect(()=>{o()},[l]);const o=async()=>{v(!0);try{const a=new Date,r=new Date;switch(l){case"7d":r.setDate(a.getDate()-7);break;case"30d":r.setDate(a.getDate()-30);break;case"90d":r.setDate(a.getDate()-90);break}const{data:u,error:g}=await M.from("openai_usage").select("operation_type, total_tokens, estimated_cost").gte("created_at",r.toISOString()).lte("created_at",a.toISOString());if(g)return;if(u){const x=u.reduce((s,m)=>{const N=m.operation_type;return s[N]||(s[N]={operation_type:N,total_requests:0,total_tokens:0,total_cost:0}),s[N].total_requests+=1,s[N].total_tokens+=m.total_tokens,s[N].total_cost+=parseFloat(m.estimated_cost),s},{});j(Object.values(x))}}catch{}finally{v(!1)}},y=()=>i.map(a=>({name:xe[a.operation_type]||a.operation_type,value:p==="requests"?a.total_requests:p==="tokens"?a.total_tokens:a.total_cost,color:q[a.operation_type]||q.other})),c=a=>p==="cost"?`$${a.toFixed(2)}`:new Intl.NumberFormat("ru-RU").format(Math.round(a)),n=()=>i.reduce((a,r)=>a+(p==="requests"?r.total_requests:p==="tokens"?r.total_tokens:r.total_cost),0);return e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsxs("div",{className:"admin-flex admin-justify-between admin-items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"admin-card-title",children:"📊 Разбивка использования"}),e.jsx("p",{className:"admin-card-description",children:"По типам операций"})]}),e.jsxs("div",{className:"admin-flex admin-gap-2",children:[e.jsxs("select",{value:p,onChange:a=>b(a.target.value),className:"admin-input admin-py-2 admin-px-3 admin-text-sm",children:[e.jsx("option",{value:"requests",children:"Запросы"}),e.jsx("option",{value:"tokens",children:"Токены"}),e.jsx("option",{value:"cost",children:"Стоимость"})]}),e.jsxs("select",{value:l,onChange:a=>f(a.target.value),className:"admin-input admin-py-2 admin-px-3 admin-text-sm",children:[e.jsx("option",{value:"7d",children:"7 дней"}),e.jsx("option",{value:"30d",children:"30 дней"}),e.jsx("option",{value:"90d",children:"90 дней"})]})]})]})}),e.jsx("div",{className:"admin-card-content",children:d?e.jsx("div",{className:"admin-flex admin-justify-center admin-items-center admin-h-64",children:e.jsx("div",{className:"admin-spinner admin-w-8 admin-h-8"})}):i.length===0?e.jsxs("div",{className:"admin-text-center admin-py-12 admin-text-gray-500",children:[e.jsx("div",{className:"admin-text-4xl admin-mb-4",children:"📊"}),e.jsx("p",{children:"Нет данных за выбранный период"})]}):e.jsxs("div",{className:"admin-grid admin-grid-cols-1 lg:admin-grid-cols-2 admin-gap-8",children:[e.jsx("div",{children:e.jsx(B,{width:"100%",height:300,children:e.jsxs(ne,{children:[e.jsx(de,{data:y(),cx:"50%",cy:"50%",labelLine:!1,label:({name:a,percent:r})=>`${a}: ${(r*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:y().map((a,r)=>e.jsx(te,{fill:a.color},`cell-${r}`))}),e.jsx(L,{formatter:a=>c(a)})]})})}),e.jsxs("div",{className:"admin-space-y-4",children:[e.jsxs("div",{className:"admin-text-center admin-mb-6",children:[e.jsxs("div",{className:"admin-text-sm admin-text-gray-600 admin-mb-1",children:["Всего ",p==="requests"?"запросов":p==="tokens"?"токенов":"стоимость"]}),e.jsx("div",{className:"admin-text-3xl admin-font-bold admin-text-gray-900",children:c(n())})]}),e.jsx("div",{className:"admin-space-y-3",children:i.map(a=>{const r=(p==="requests"?a.total_requests:p==="tokens"?a.total_tokens:a.total_cost)/n()*100;return e.jsxs("div",{className:"admin-border admin-border-gray-200 admin-rounded-lg admin-p-4",children:[e.jsxs("div",{className:"admin-flex admin-justify-between admin-items-center admin-mb-2",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-w-3 admin-h-3 admin-rounded-full",style:{backgroundColor:q[a.operation_type]||q.other}}),e.jsx("span",{className:"admin-font-medium admin-text-gray-900",children:xe[a.operation_type]||a.operation_type})]}),e.jsxs("span",{className:"admin-text-sm admin-text-gray-600",children:[r.toFixed(1),"%"]})]}),e.jsx("div",{className:"admin-w-full admin-bg-gray-200 admin-rounded-full admin-h-2 admin-mb-2",children:e.jsx("div",{className:"admin-h-2 admin-rounded-full admin-transition-all",style:{width:`${r}%`,backgroundColor:q[a.operation_type]||q.other}})}),e.jsxs("div",{className:"admin-grid admin-grid-cols-3 admin-gap-2 admin-text-xs admin-text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"admin-font-medium",children:a.total_requests})," запросов"]}),e.jsxs("div",{children:[e.jsx("span",{className:"admin-font-medium",children:a.total_tokens.toLocaleString()})," токенов"]}),e.jsx("div",{children:e.jsxs("span",{className:"admin-font-medium",children:["$",a.total_cost.toFixed(2)]})})]})]},a.operation_type)})})]})]})})]})},Ge=()=>{const[i,j]=t.useState([]),[d,v]=t.useState(!0),[l,f]=t.useState("30d"),[p,b]=t.useState("area"),[o,y]=t.useState("requests");t.useEffect(()=>{c()},[l]);const c=async()=>{v(!0);try{const s=new Date,m=new Date;switch(l){case"7d":m.setDate(s.getDate()-7);break;case"30d":m.setDate(s.getDate()-30);break;case"90d":m.setDate(s.getDate()-90);break}const{data:N,error:_}=await M.from("openai_usage").select("created_at, total_tokens, estimated_cost").gte("created_at",m.toISOString()).lte("created_at",s.toISOString()).order("created_at",{ascending:!0});if(_)return;if(N){const w=N.reduce((k,R)=>{const U=new Date(R.created_at).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"});return k[U]||(k[U]={date:U,requests:0,tokens:0,cost:0}),k[U].requests+=1,k[U].tokens+=R.total_tokens,k[U].cost+=parseFloat(R.estimated_cost),k},{}),C=[],S=new Date(m);for(;S<=s;){const k=S.toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"});C.push(w[k]||{date:k,requests:0,tokens:0,cost:0}),S.setDate(S.getDate()+1)}j(C)}}catch{}finally{v(!1)}},n=s=>o==="cost"?`$${s.toFixed(2)}`:o==="tokens"?`${(s/1e3).toFixed(1)}K`:s.toString(),a=s=>o==="cost"?`$${s.toFixed(4)}`:o==="tokens"?s.toLocaleString():s.toString(),r=()=>{switch(o){case"requests":return"Запросы";case"tokens":return"Токены";case"cost":return"Стоимость ($)"}},u=()=>{switch(o){case"requests":return"#3b82f6";case"tokens":return"#10b981";case"cost":return"#f59e0b"}},x=(()=>{if(i.length<2)return{value:0,direction:"neutral"};const s=i.slice(-7),m=i.slice(-14,-7),N=s.reduce((C,S)=>C+(o==="requests"?S.requests:o==="tokens"?S.tokens:S.cost),0)/s.length,_=m.reduce((C,S)=>C+(o==="requests"?S.requests:o==="tokens"?S.tokens:S.cost),0)/(m.length||1),w=(N-_)/(_||1)*100;return{value:Math.abs(w),direction:w>0?"up":w<0?"down":"neutral"}})();return e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsxs("div",{className:"admin-flex admin-justify-between admin-items-center admin-flex-wrap admin-gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"admin-card-title",children:"📈 Тренды использования"}),e.jsx("p",{className:"admin-card-description",children:"Динамика за период"})]}),e.jsxs("div",{className:"admin-flex admin-gap-2 admin-flex-wrap",children:[i.length>0&&e.jsxs("div",{className:`admin-px-3 admin-py-1 admin-rounded-full admin-text-xs admin-font-medium ${x.direction==="up"?"admin-bg-green-100 admin-text-green-700":x.direction==="down"?"admin-bg-red-100 admin-text-red-700":"admin-bg-gray-100 admin-text-gray-700"}`,children:[x.direction==="up"?"📈":x.direction==="down"?"📉":"➡️"," ",x.value.toFixed(1),"% за неделю"]}),e.jsxs("div",{className:"admin-flex admin-gap-1 admin-bg-gray-100 admin-rounded-lg admin-p-1",children:[e.jsx("button",{onClick:()=>b("line"),className:`admin-px-3 admin-py-1 admin-rounded admin-text-xs admin-font-medium admin-transition-colors ${p==="line"?"admin-bg-white admin-text-gray-900 admin-shadow-sm":"admin-text-gray-600 hover:admin-text-gray-900"}`,children:"Линия"}),e.jsx("button",{onClick:()=>b("area"),className:`admin-px-3 admin-py-1 admin-rounded admin-text-xs admin-font-medium admin-transition-colors ${p==="area"?"admin-bg-white admin-text-gray-900 admin-shadow-sm":"admin-text-gray-600 hover:admin-text-gray-900"}`,children:"Область"})]}),e.jsxs("select",{value:o,onChange:s=>y(s.target.value),className:"admin-input admin-py-1 admin-px-3 admin-text-xs",children:[e.jsx("option",{value:"requests",children:"Запросы"}),e.jsx("option",{value:"tokens",children:"Токены"}),e.jsx("option",{value:"cost",children:"Стоимость"})]}),e.jsxs("select",{value:l,onChange:s=>f(s.target.value),className:"admin-input admin-py-1 admin-px-3 admin-text-xs",children:[e.jsx("option",{value:"7d",children:"7 дней"}),e.jsx("option",{value:"30d",children:"30 дней"}),e.jsx("option",{value:"90d",children:"90 дней"})]})]})]})}),e.jsx("div",{className:"admin-card-content",children:d?e.jsx("div",{className:"admin-flex admin-justify-center admin-items-center admin-h-80",children:e.jsx("div",{className:"admin-spinner admin-w-8 admin-h-8"})}):i.length===0?e.jsxs("div",{className:"admin-text-center admin-py-12 admin-text-gray-500",children:[e.jsx("div",{className:"admin-text-4xl admin-mb-4",children:"📈"}),e.jsx("p",{children:"Нет данных за выбранный период"})]}):e.jsx(B,{width:"100%",height:400,children:p==="line"?e.jsxs(re,{data:i,children:[e.jsx(K,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(Q,{dataKey:"date",stroke:"#6b7280",style:{fontSize:"12px"}}),e.jsx(Y,{tickFormatter:n,stroke:"#6b7280",style:{fontSize:"12px"}}),e.jsx(L,{formatter:a,labelStyle:{color:"#111827"},contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px",padding:"12px"}}),e.jsx(oe,{}),e.jsx(G,{type:"monotone",dataKey:o,name:r(),stroke:u(),strokeWidth:2,dot:{fill:u(),r:4},activeDot:{r:6}})]}):e.jsxs(Be,{data:i,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorMetric",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:u(),stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:u(),stopOpacity:0})]})}),e.jsx(K,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(Q,{dataKey:"date",stroke:"#6b7280",style:{fontSize:"12px"}}),e.jsx(Y,{tickFormatter:n,stroke:"#6b7280",style:{fontSize:"12px"}}),e.jsx(L,{formatter:a,labelStyle:{color:"#111827"},contentStyle:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"8px",padding:"12px"}}),e.jsx(oe,{}),e.jsx(Me,{type:"monotone",dataKey:o,name:r(),stroke:u(),strokeWidth:2,fillOpacity:1,fill:"url(#colorMetric)"})]})})})]})},Xe=()=>{const[i,j]=t.useState([]),[d,v]=t.useState(!0),[l,f]=t.useState("30d"),[p,b]=t.useState("cost"),[o,y]=t.useState("desc"),[c,n]=t.useState("");t.useEffect(()=>{a()},[l]);const a=async()=>{v(!0);try{let m=M.from("openai_usage").select(`
          user_id,
          total_tokens,
          estimated_cost,
          created_at
        `);if(l!=="all"){const w=new Date,C=new Date;switch(l){case"7d":C.setDate(w.getDate()-7);break;case"30d":C.setDate(w.getDate()-30);break;case"90d":C.setDate(w.getDate()-90);break}m=m.gte("created_at",C.toISOString()).lte("created_at",w.toISOString())}const{data:N,error:_}=await m;if(_)return;if(N){const w=N.reduce((S,k)=>{const R=k.user_id;return R&&(S[R]||(S[R]={user_id:R,user_email:"",user_name:"",total_requests:0,total_tokens:0,total_cost:0,last_activity:k.created_at}),S[R].total_requests+=1,S[R].total_tokens+=k.total_tokens,S[R].total_cost+=parseFloat(k.estimated_cost),new Date(k.created_at)>new Date(S[R].last_activity)&&(S[R].last_activity=k.created_at)),S},{}),C=Object.keys(w);if(C.length>0){const{data:S}=await M.from("profiles").select("id, email, name").in("id",C);S&&S.forEach(k=>{w[k.id]&&(w[k.id].user_email=k.email||"Неизвестно",w[k.id].user_name=k.name||"Пользователь")})}j(Object.values(w))}}catch{}finally{v(!1)}},r=m=>{p===m?y(o==="asc"?"desc":"asc"):(b(m),y("desc"))},u=()=>{let m=[...i];return c&&(m=m.filter(N=>N.user_email.toLowerCase().includes(c.toLowerCase())||N.user_name.toLowerCase().includes(c.toLowerCase()))),m.sort((N,_)=>{let w=0,C=0;switch(p){case"requests":w=N.total_requests,C=_.total_requests;break;case"tokens":w=N.total_tokens,C=_.total_tokens;break;case"cost":w=N.total_cost,C=_.total_cost;break}return o==="asc"?w-C:C-w}),m},g=()=>{const m=u(),N=["Email","Имя","Запросы","Токены","Стоимость ($)","Последняя активность"],_=m.map(k=>[k.user_email,k.user_name,k.total_requests,k.total_tokens,k.total_cost.toFixed(4),new Date(k.last_activity).toLocaleString("ru-RU")]),w=[N.join(","),..._.map(k=>k.join(","))].join(`
`),C=new Blob([w],{type:"text/csv;charset=utf-8;"}),S=document.createElement("a");S.href=URL.createObjectURL(C),S.download=`user-usage-${new Date().toISOString().split("T")[0]}.csv`,S.click()},x=u(),s=x.reduce((m,N)=>m+N.total_cost,0);return e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsxs("div",{className:"admin-flex admin-justify-between admin-items-center admin-flex-wrap admin-gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"admin-card-title",children:"👥 Использование по пользователям"}),e.jsx("p",{className:"admin-card-description",children:"Детальная статистика по каждому пользователю"})]}),e.jsxs("div",{className:"admin-flex admin-gap-2 admin-flex-wrap",children:[e.jsx("input",{type:"text",placeholder:"Поиск пользователя...",value:c,onChange:m=>n(m.target.value),className:"admin-input admin-py-2 admin-px-3 admin-text-sm admin-w-48"}),e.jsxs("select",{value:l,onChange:m=>f(m.target.value),className:"admin-input admin-py-2 admin-px-3 admin-text-sm",children:[e.jsx("option",{value:"7d",children:"7 дней"}),e.jsx("option",{value:"30d",children:"30 дней"}),e.jsx("option",{value:"90d",children:"90 дней"}),e.jsx("option",{value:"all",children:"Все время"})]}),e.jsxs("button",{onClick:g,disabled:x.length===0,className:"admin-btn admin-btn-outline admin-btn-sm admin-flex admin-items-center admin-gap-2",children:[e.jsx("span",{children:"📊"}),"Экспорт CSV"]}),e.jsxs("button",{onClick:a,disabled:d,className:"admin-btn admin-btn-primary admin-btn-sm admin-flex admin-items-center admin-gap-2",children:[e.jsx("span",{children:"🔄"}),d?"Загрузка...":"Обновить"]})]})]})}),e.jsxs("div",{className:"admin-card-content",children:[e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-4 admin-gap-4 admin-mb-6",children:[e.jsxs("div",{className:"admin-bg-blue-50 admin-border admin-border-blue-200 admin-rounded-lg admin-p-4",children:[e.jsx("div",{className:"admin-text-sm admin-text-blue-600 admin-mb-1",children:"Всего пользователей"}),e.jsx("div",{className:"admin-text-2xl admin-font-bold admin-text-blue-900",children:x.length})]}),e.jsxs("div",{className:"admin-bg-green-50 admin-border admin-border-green-200 admin-rounded-lg admin-p-4",children:[e.jsx("div",{className:"admin-text-sm admin-text-green-600 admin-mb-1",children:"Всего запросов"}),e.jsx("div",{className:"admin-text-2xl admin-font-bold admin-text-green-900",children:x.reduce((m,N)=>m+N.total_requests,0).toLocaleString()})]}),e.jsxs("div",{className:"admin-bg-purple-50 admin-border admin-border-purple-200 admin-rounded-lg admin-p-4",children:[e.jsx("div",{className:"admin-text-sm admin-text-purple-600 admin-mb-1",children:"Всего токенов"}),e.jsx("div",{className:"admin-text-2xl admin-font-bold admin-text-purple-900",children:x.reduce((m,N)=>m+N.total_tokens,0).toLocaleString()})]}),e.jsxs("div",{className:"admin-bg-orange-50 admin-border admin-border-orange-200 admin-rounded-lg admin-p-4",children:[e.jsx("div",{className:"admin-text-sm admin-text-orange-600 admin-mb-1",children:"Общая стоимость"}),e.jsxs("div",{className:"admin-text-2xl admin-font-bold admin-text-orange-900",children:["$",s.toFixed(2)]})]})]}),d?e.jsx("div",{className:"admin-flex admin-justify-center admin-items-center admin-h-64",children:e.jsx("div",{className:"admin-spinner admin-w-8 admin-h-8"})}):x.length===0?e.jsxs("div",{className:"admin-text-center admin-py-12 admin-text-gray-500",children:[e.jsx("div",{className:"admin-text-4xl admin-mb-4",children:"👥"}),e.jsx("p",{children:"Нет данных за выбранный период"})]}):e.jsx("div",{className:"admin-overflow-x-auto",children:e.jsxs("table",{className:"admin-w-full admin-text-sm",children:[e.jsx("thead",{className:"admin-bg-gray-50 admin-border-b admin-border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"admin-px-4 admin-py-3 admin-text-left admin-font-semibold admin-text-gray-700",children:"Пользователь"}),e.jsxs("th",{className:"admin-px-4 admin-py-3 admin-text-right admin-font-semibold admin-text-gray-700 admin-cursor-pointer hover:admin-bg-gray-100",onClick:()=>r("requests"),children:["Запросы ",p==="requests"&&(o==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"admin-px-4 admin-py-3 admin-text-right admin-font-semibold admin-text-gray-700 admin-cursor-pointer hover:admin-bg-gray-100",onClick:()=>r("tokens"),children:["Токены ",p==="tokens"&&(o==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"admin-px-4 admin-py-3 admin-text-right admin-font-semibold admin-text-gray-700 admin-cursor-pointer hover:admin-bg-gray-100",onClick:()=>r("cost"),children:["Стоимость ",p==="cost"&&(o==="asc"?"↑":"↓")]}),e.jsx("th",{className:"admin-px-4 admin-py-3 admin-text-right admin-font-semibold admin-text-gray-700",children:"Последняя активность"})]})}),e.jsx("tbody",{className:"admin-divide-y admin-divide-gray-200",children:x.map(m=>e.jsxs("tr",{className:"hover:admin-bg-gray-50 admin-transition-colors",children:[e.jsx("td",{className:"admin-px-4 admin-py-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900",children:m.user_name}),e.jsx("div",{className:"admin-text-xs admin-text-gray-500",children:m.user_email})]})}),e.jsx("td",{className:"admin-px-4 admin-py-3 admin-text-right admin-font-medium admin-text-gray-900",children:m.total_requests.toLocaleString()}),e.jsx("td",{className:"admin-px-4 admin-py-3 admin-text-right admin-font-medium admin-text-gray-900",children:m.total_tokens.toLocaleString()}),e.jsxs("td",{className:"admin-px-4 admin-py-3 admin-text-right admin-font-medium admin-text-gray-900",children:["$",m.total_cost.toFixed(4)]}),e.jsx("td",{className:"admin-px-4 admin-py-3 admin-text-right admin-text-xs admin-text-gray-600",children:new Date(m.last_activity).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]},m.user_id))})]})})]})]})},He=()=>{const[i,j]=t.useState(""),[d,v]=t.useState(!1),[l,f]=t.useState(!1),[p,b]=t.useState(!0),[o,y]=t.useState(!1),[c,n]=t.useState({requests:1247,tokens:45678,cost:12.34});t.useEffect(()=>{(async()=>{try{const g=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!g)return;const x=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/settings/openai_api_key",{headers:{Authorization:`Bearer ${g}`,"Content-Type":"application/json"}});if(x.ok){const s=await x.json();s.setting?.value&&(j(s.setting.value),f(!0))}}catch{}})()},[]);const a=async()=>{if(!i){h.error("Введите API ключ");return}y(!0);try{const u=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!u){h.error("Ошибка авторизации");return}const g=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/settings",{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify({key:"openai_api_key",value:i})});if(g.ok)f(!0),h.success("API ключ успешно сохранен! 🔑");else{const x=await g.json().catch(()=>({}));h.error(x.error||"Ошибка сохранения API ключа")}}catch{h.error("Ошибка соединения с сервером")}finally{y(!1)}},r=async()=>{if(!i){h.error("Введите API ключ для проверки");return}v(!0);try{i.startsWith("sk-")&&i.length>20?(f(!0),h.success("API ключ выглядит корректно! ✅")):(f(!1),h.error('API ключ имеет неверный формат. Должен начинаться с "sk-" и содержать более 20 символов'))}catch{f(!1),h.error("Ошибка при проверке API ключа")}finally{v(!1)}};return e.jsxs("div",{className:"admin-space-y-10",children:[e.jsxs("header",{className:"admin-flex admin-items-center admin-gap-4 admin-pb-4 admin-border-b admin-border-gray-200",children:[e.jsx("div",{className:"admin-p-3 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-2xl","aria-hidden":"true",children:"🔑"}),e.jsxs("div",{children:[e.jsx("h2",{className:"admin-text-2xl admin-font-semibold admin-text-gray-900",children:"Настройки OpenAI API"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600 admin-mt-1",children:"Управление API ключом и мониторинг использования"})]}),e.jsxs("div",{className:"admin-ml-auto admin-flex admin-gap-2",children:[e.jsx("div",{className:`admin-px-3 admin-py-1 admin-rounded-full admin-text-xs admin-font-medium ${l?"admin-bg-admin-success-lighter admin-text-admin-success":"admin-bg-admin-error-lighter admin-text-admin-error"}`,children:l?"✅ Активен":"❌ Неактивен"}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-primary-lighter admin-text-admin-primary admin-rounded-full admin-text-xs admin-font-medium",children:"🔒 Безопасный"})]})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 lg:admin-grid-cols-3 admin-gap-8",children:[e.jsx("div",{className:"lg:admin-col-span-2",children:e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"🔧 Конфигурация API"}),e.jsx("p",{className:"admin-card-description",children:"Настройка и управление OpenAI API ключом"})]}),e.jsxs("div",{className:"admin-card-content admin-space-y-8",children:[e.jsxs("div",{className:"admin-space-y-4",children:[e.jsx("label",{htmlFor:"api-key",className:"admin-font-medium admin-text-gray-900",children:"API Ключ"}),e.jsxs("div",{className:"admin-flex admin-gap-3",children:[e.jsx("input",{id:"api-key",type:"password",placeholder:"sk-...",value:i,onChange:u=>j(u.target.value),className:"admin-input admin-flex-1","aria-describedby":"api-key-help"}),e.jsx("button",{onClick:r,disabled:!i||d,className:"admin-btn admin-btn-primary",title:"Протестировать формат API ключа","aria-label":"Проверить API ключ",children:d?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Тестирую..."]}):"🧪 Тест"})]}),e.jsx("p",{id:"api-key-help",className:"admin-text-xs admin-text-gray-500",children:'Введите ваш OpenAI API ключ. Должен начинаться с "sk-" и содержать более 20 символов.'})]}),e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-4 admin-p-4 admin-bg-admin-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:[e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"auto-refresh",type:"checkbox",checked:p,onChange:u=>b(u.target.checked),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"auto-refresh",className:"admin-font-medium admin-text-gray-900 admin-cursor-pointer",children:"Автообновление статистики"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Автоматически обновлять данные использования"})]})]}),e.jsx("div",{className:"admin-flex admin-gap-4 admin-mt-8",children:e.jsx("button",{onClick:a,disabled:!i||!l||o,className:"admin-btn admin-btn-success admin-font-medium",children:o?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Сохраняю..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"💾"}),"Сохранить конфигурацию"]})})})]})]})}),e.jsx("div",{className:"admin-space-y-6",children:e.jsx("div",{className:"admin-card",children:e.jsxs("div",{className:"admin-card-content admin-p-6",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-mb-4",children:[e.jsx("span",{className:"admin-font-medium admin-text-gray-900",children:"Статус API"}),e.jsx("div",{className:`admin-w-3 admin-h-3 admin-rounded-full ${l?"admin-bg-admin-success":"admin-bg-admin-error"}`,"aria-hidden":"true"})]}),e.jsxs("div",{className:"admin-text-center",children:[e.jsx("div",{className:`admin-text-lg admin-font-semibold admin-mb-2 ${l?"admin-text-admin-success":"admin-text-admin-error"}`,children:l?"✅ Ключ валиден":"❌ Ключ невалиден"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:l?"API готов к использованию":"Требуется валидный API ключ"})]})]})})})]}),e.jsx(Qe,{}),e.jsx(Ye,{}),e.jsx(Ge,{}),e.jsx(Xe,{})]})},he=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4"],Ze=()=>{const[i,j]=t.useState([{code:"ru",name:"Русский",native_name:"Русский",flag:"🇷🇺",is_active:!0},{code:"en",name:"Английский",native_name:"English",flag:"🇺🇸",is_active:!0},{code:"es",name:"Испанский",native_name:"Español",flag:"🇪🇸",is_active:!0},{code:"de",name:"Немецкий",native_name:"Deutsch",flag:"🇩🇪",is_active:!1},{code:"fr",name:"Французский",native_name:"Français",flag:"🇫🇷",is_active:!1},{code:"zh",name:"Китайский",native_name:"中文",flag:"🇨🇳",is_active:!1},{code:"ja",name:"Японский",native_name:"日本語",flag:"🇯🇵",is_active:!1},{code:"ka",name:"Грузинский",native_name:"ქართული",flag:"🇬🇪",is_active:!0}]),[d,v]=t.useState([]),[l,f]=t.useState(null),[p,b]=t.useState(""),[o,y]=t.useState("ru"),[c,n]=t.useState(!1);t.useEffect(()=>{a()},[]);const a=async()=>{n(!0);try{const s=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!s){h.error("Ошибка авторизации");return}const m=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/translations",{headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(m.ok){const N=await m.json();v(N.translations||[]),h.success("Переводы успешно загружены! 📚")}else{const N=await m.json().catch(()=>({}));h.error(N.error||"Ошибка загрузки переводов")}}catch{h.error("Ошибка соединения с сервером")}finally{n(!1)}},r=s=>{f(s),b(s.value)},u=async()=>{if(l){if(!p.trim()){h.error("Введите текст перевода");return}try{const s=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!s){h.error("Ошибка авторизации");return}const m=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/translations",{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({key:l.key,language:l.language,value:p})});if(m.ok)v(N=>N.map(_=>_.key===l.key&&_.language===l.language?{..._,value:p}:_)),f(null),b(""),h.success("Перевод успешно сохранен! 🌍");else{const N=await m.json().catch(()=>({}));h.error(N.error||"Ошибка сохранения перевода")}}catch{h.error("Ошибка соединения с сервером")}}},g=s=>{const N=d.filter(_=>_.language===s).length;return Math.round(N/50*100)},x=()=>i.map((s,m)=>({name:s.name,value:g(s.code),color:he[m%he.length]}));return e.jsxs("div",{className:"admin-space-y-10",children:[e.jsxs("header",{className:"admin-flex admin-items-center admin-gap-4 admin-pb-4 admin-border-b admin-border-gray-200",children:[e.jsx("div",{className:"admin-p-3 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-2xl","aria-hidden":"true",children:"🌍"}),e.jsxs("div",{children:[e.jsx("h2",{className:"admin-text-2xl admin-font-semibold admin-text-gray-900",children:"Управление языками"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600 admin-mt-1",children:"Управление переводами и локализацией приложения"})]}),e.jsxs("div",{className:"admin-ml-auto admin-flex admin-gap-2",children:[e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-success-lighter admin-text-admin-success admin-rounded-full admin-text-xs admin-font-medium",children:"🌐 Мультиязычность"}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-primary-lighter admin-text-admin-primary admin-rounded-full admin-text-xs admin-font-medium",children:"📊 Аналитика"})]})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 lg:admin-grid-cols-3 admin-gap-8",children:[e.jsx("div",{className:"lg:admin-col-span-2 admin-space-y-8",children:e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"🌍 Активные языки"}),e.jsx("p",{className:"admin-card-description",children:"Управление поддерживаемыми языками приложения"})]}),e.jsx("div",{className:"admin-card-content",children:e.jsx("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 admin-gap-8",children:i.map(s=>e.jsx("div",{className:"admin-card admin-border admin-border-gray-200 admin-shadow-sm hover:admin-shadow-md admin-transition-shadow",children:e.jsxs("div",{className:"admin-p-8",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-mb-4",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-4",children:[e.jsx("div",{className:"admin-text-4xl","aria-hidden":"true",children:s.flag}),e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-semibold admin-text-gray-900 admin-text-lg",children:s.name}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:s.native_name})]})]}),e.jsxs("div",{className:"admin-flex admin-flex-col admin-items-end admin-gap-2",children:[e.jsx("div",{className:`admin-w-3 admin-h-3 admin-rounded-full ${s.is_active?"admin-bg-admin-success":"admin-bg-admin-gray-400"}`,"aria-hidden":"true"}),e.jsx("div",{className:`admin-px-2 admin-py-1 admin-rounded admin-text-xs admin-font-medium ${s.is_active?"admin-bg-admin-success-lighter admin-text-admin-success":"admin-bg-admin-gray-100 admin-text-admin-gray-600"}`,children:s.is_active?"Активен":"Неактивен"})]})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsxs("div",{className:"admin-flex admin-justify-between admin-text-sm",children:[e.jsx("span",{className:"admin-text-gray-600",children:"Прогресс переводов"}),e.jsxs("span",{className:"admin-font-medium admin-text-gray-900",children:[g(s.code),"%"]})]}),e.jsx("div",{className:"admin-w-full admin-bg-gray-200 admin-rounded-full admin-h-2",children:e.jsx("div",{className:"admin-bg-admin-primary admin-h-2 admin-rounded-full admin-transition-all",style:{width:`${g(s.code)}%`},"aria-label":`Прогресс переводов: ${g(s.code)}%`})}),e.jsxs("div",{className:"admin-flex admin-gap-2",children:[e.jsx("button",{onClick:()=>y(s.code),className:"admin-btn admin-btn-outline admin-btn-sm",children:"Редактировать"}),e.jsx("button",{className:"admin-btn admin-btn-primary admin-btn-sm",title:"Автоперевод","aria-label":`Запустить автоперевод для языка ${s.name}`,children:"Автоперевод"})]})]})]})},s.code))})})]})}),e.jsxs("div",{className:"admin-space-y-6",children:[e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📊 Прогресс переводов"})}),e.jsx("div",{className:"admin-card-content",children:e.jsx("div",{className:"admin-h-64",children:e.jsx(B,{width:"100%",height:"100%",children:e.jsxs(ne,{children:[e.jsx(de,{data:x(),cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"value",label:({name:s,value:m})=>`${s}: ${m}%`,children:x().map((s,m)=>e.jsx(te,{fill:s.color},`cell-${m}`))}),e.jsx(L,{contentStyle:{backgroundColor:"var(--admin-white)",border:"1px solid var(--admin-gray-200)",borderRadius:"8px",boxShadow:"var(--admin-shadow-md)"}})]})})})})]}),e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📈 Статистика"})}),e.jsx("div",{className:"admin-card-content admin-space-y-4",children:e.jsxs("div",{className:"admin-grid admin-grid-cols-2 admin-gap-4",children:[e.jsxs("div",{className:"admin-p-4 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-primary-light",children:[e.jsx("div",{className:"admin-text-3xl admin-font-semibold admin-text-admin-primary admin-mb-1",children:i.length}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"Всего языков"})]}),e.jsxs("div",{className:"admin-p-4 admin-bg-admin-success-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-success-light",children:[e.jsx("div",{className:"admin-text-3xl admin-font-semibold admin-text-admin-success admin-mb-1",children:i.filter(s=>s.is_active).length}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"Активных"})]}),e.jsxs("div",{className:"admin-p-4 admin-bg-admin-warning-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-warning-light",children:[e.jsx("div",{className:"admin-text-3xl admin-font-semibold admin-text-admin-warning admin-mb-1",children:d.length}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"Переводов"})]}),e.jsxs("div",{className:"admin-p-4 admin-bg-admin-secondary-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-secondary-light",children:[e.jsx("div",{className:"admin-text-3xl admin-font-semibold admin-text-admin-secondary admin-mb-1",children:Math.round(d.length/i.length)}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"На язык"})]})]})})]})]})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📝 Редактирование переводов"}),e.jsxs("p",{className:"admin-card-description",children:["Редактирование текстов для языка: ",i.find(s=>s.code===o)?.name]})]}),e.jsx("div",{className:"admin-card-content",children:e.jsx("div",{className:"admin-space-y-4 admin-max-h-96 admin-overflow-y-auto",children:d.filter(s=>s.language===o).slice(0,15).map((s,m)=>e.jsxs("div",{className:"admin-p-4 admin-bg-gray-50 admin-rounded-lg admin-border admin-border-gray-200 hover:admin-bg-gray-100 admin-transition-colors",children:[e.jsxs("div",{className:"admin-flex admin-items-start admin-justify-between admin-mb-3",children:[e.jsxs("div",{className:"admin-flex-1",children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-text-sm admin-mb-1",children:s.key}),e.jsx("div",{className:"admin-text-gray-600 admin-text-xs",children:"Ключ перевода"})]}),e.jsx("div",{className:"admin-px-2 admin-py-1 admin-bg-admin-primary-lighter admin-text-admin-primary admin-rounded admin-text-xs admin-font-medium",children:s.language.toUpperCase()})]}),l?.key===s.key&&l?.language===s.language?e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("input",{type:"text",value:p,onChange:N=>b(N.target.value),className:"admin-input"}),e.jsxs("div",{className:"admin-flex admin-gap-2",children:[e.jsx("button",{onClick:u,className:"admin-btn admin-btn-success admin-btn-sm",children:"💾 Сохранить"}),e.jsx("button",{onClick:()=>{f(null),b("")},className:"admin-btn admin-btn-outline admin-btn-sm",children:"❌ Отмена"})]})]}):e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between",children:[e.jsx("span",{className:"admin-text-gray-900 admin-flex-1 admin-mr-4",children:s.value}),e.jsx("button",{onClick:()=>r(s),className:"admin-btn admin-btn-outline admin-btn-sm",title:"Редактировать перевод","aria-label":`Редактировать перевод для ключа ${s.key}`,children:"✏️ Редактировать"})]})]},m))})})]}),e.jsxs("div",{className:"admin-flex admin-justify-center admin-gap-4",children:[e.jsxs("button",{onClick:()=>{h.info("Функция автоперевода в разработке 🤖")},className:"admin-btn admin-btn-success admin-font-medium",children:[e.jsx("span",{className:"mr-2",children:"🤖"}),"Автоперевод AI"]}),e.jsxs("button",{onClick:()=>{h.info("Функция экспорта отчетов в разработке 📊")},className:"admin-btn admin-btn-primary admin-font-medium",children:[e.jsx("span",{className:"mr-2",children:"📊"}),"Экспорт отчетов"]}),e.jsx("button",{onClick:a,disabled:c,className:"admin-btn admin-btn-outline admin-font-medium",children:c?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Загружаю..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"🔄"}),"Обновить переводы"]})})]})]})},ea=[{month:"Jan",installs:120,uninstalls:15},{month:"Feb",installs:150,uninstalls:12},{month:"Mar",installs:200,uninstalls:18},{month:"Apr",installs:180,uninstalls:20},{month:"May",installs:250,uninstalls:22},{month:"Jun",installs:300,uninstalls:25}],ue=[{name:"Desktop",value:45,color:"#3b82f6"},{name:"Mobile",value:35,color:"#10b981"},{name:"Tablet",value:20,color:"#f59e0b"}],aa=()=>{const[i,j]=t.useState({appName:"Дневник Достижений",shortName:"Дневник",description:"Персональный дневник для отслеживания достижений",themeColor:"#3b82f6",backgroundColor:"#ffffff"}),[d,v]=t.useState({enableNotifications:!0,enableOfflineMode:!0,enableInstallPrompt:!0}),[l,f]=t.useState({totalInstalls:1234,retentionRate:89,averageRating:4.8,activeUsers:567}),[p,b]=t.useState(!1),o=async()=>{b(!0);try{const n=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!n){h.error("Ошибка авторизации");return}const a=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/settings",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({key:"pwa_manifest",value:JSON.stringify(i)})}),r=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/settings",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({key:"pwa_settings",value:JSON.stringify(d)})});a.ok&&r.ok?h.success("Настройки PWA успешно сохранены! 📱"):h.error("Ошибка сохранения настроек PWA")}catch{h.error("Ошибка соединения с сервером")}finally{b(!1)}},y=async()=>{try{h.info("Публикация обновления PWA в разработке... 🚀")}catch{h.error("Ошибка публикации обновления")}},c=async()=>{try{h.info("Анализ метрик PWA в разработке... 📊")}catch{h.error("Ошибка анализа метрик")}};return e.jsxs("div",{className:"admin-space-y-8",children:[e.jsxs("header",{className:"admin-flex admin-items-center admin-gap-4 admin-pb-4 admin-border-b admin-border-gray-200",children:[e.jsx("div",{className:"admin-p-3 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-2xl","aria-hidden":"true",children:"📱"}),e.jsxs("div",{children:[e.jsx("h2",{className:"admin-text-2xl admin-font-semibold admin-text-gray-900",children:"Настройки PWA"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600 admin-mt-1",children:"Настройки Progressive Web App для лучшего пользовательского опыта"})]}),e.jsxs("div",{className:"admin-ml-auto admin-flex admin-gap-2",children:[e.jsxs("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-success-lighter admin-text-admin-success admin-rounded-full admin-text-xs admin-font-medium admin-flex admin-items-center admin-gap-1",children:[e.jsx("div",{className:"admin-w-2 admin-h-2 admin-bg-admin-success admin-rounded-full","aria-hidden":"true"}),"Активен"]}),e.jsxs("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-primary-lighter admin-text-admin-primary admin-rounded-full admin-text-xs admin-font-medium",children:["📱 ",l.totalInstalls.toLocaleString()," установок"]})]})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 lg:admin-grid-cols-3 admin-gap-8",children:[e.jsxs("div",{className:"lg:admin-col-span-2 admin-space-y-6",children:[e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📋 Манифест PWA"}),e.jsx("p",{className:"admin-card-description",children:"Настройка веб-манифеста приложения"})]}),e.jsxs("div",{className:"admin-card-content admin-space-y-6",children:[e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 admin-gap-6",children:[e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"app-name",className:"admin-font-medium admin-text-gray-900",children:"Название приложения"}),e.jsx("input",{id:"app-name",type:"text",value:i.appName,onChange:n=>j(a=>({...a,appName:n.target.value})),className:"admin-input"})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"short-name",className:"admin-font-medium admin-text-gray-900",children:"Короткое название"}),e.jsx("input",{id:"short-name",type:"text",value:i.shortName,onChange:n=>j(a=>({...a,shortName:n.target.value})),className:"admin-input"})]})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"description",className:"admin-font-medium admin-text-gray-900",children:"Описание"}),e.jsx("input",{id:"description",type:"text",value:i.description,onChange:n=>j(a=>({...a,description:n.target.value})),className:"admin-input"})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 admin-gap-6",children:[e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"theme-color",className:"admin-font-medium admin-text-gray-900",children:"Цвет темы"}),e.jsxs("div",{className:"admin-flex admin-gap-3 admin-items-center",children:[e.jsx("input",{id:"theme-color",type:"text",value:i.themeColor,onChange:n=>j(a=>({...a,themeColor:n.target.value})),className:"admin-input admin-flex-1"}),e.jsx("div",{className:"admin-w-12 admin-h-12 admin-rounded-lg admin-border-2 admin-border-gray-300 admin-shadow-sm",style:{backgroundColor:i.themeColor},"aria-hidden":"true"})]})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"bg-color",className:"admin-font-medium admin-text-gray-900",children:"Цвет фона"}),e.jsxs("div",{className:"admin-flex admin-gap-3 admin-items-center",children:[e.jsx("input",{id:"bg-color",type:"text",value:i.backgroundColor,onChange:n=>j(a=>({...a,backgroundColor:n.target.value})),className:"admin-input admin-flex-1"}),e.jsx("div",{className:"admin-w-12 admin-h-12 admin-rounded-lg admin-border-2 admin-border-gray-300 admin-shadow-sm",style:{backgroundColor:i.backgroundColor},"aria-hidden":"true"})]})]})]})]})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"⚙️ Функции PWA"}),e.jsx("p",{className:"admin-card-description",children:"Включение и отключение возможностей приложения"})]}),e.jsx("div",{className:"admin-card-content admin-space-y-6",children:e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 admin-gap-6",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"🔔 Push-уведомления"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Разрешить отправку уведомлений"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"enable-notifications",type:"checkbox",checked:d.enableNotifications,onChange:n=>v(a=>({...a,enableNotifications:n.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]}),e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"📱 Офлайн режим"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Работа без интернета"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"enable-offline",type:"checkbox",checked:d.enableOfflineMode,onChange:n=>v(a=>({...a,enableOfflineMode:n.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]}),e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-admin-warning-lighter admin-rounded-lg admin-border admin-border-admin-warning-light md:admin-col-span-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"💡 Подсказка установки"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Предложить установить приложение"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"enable-install-prompt",type:"checkbox",checked:d.enableInstallPrompt,onChange:n=>v(a=>({...a,enableInstallPrompt:n.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]})]})})]})]}),e.jsxs("div",{className:"admin-space-y-6",children:[e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📈 Установки PWA"})}),e.jsx("div",{className:"admin-card-content",children:e.jsx("div",{className:"admin-h-48",children:e.jsx(B,{width:"100%",height:"100%",children:e.jsxs(re,{data:ea,children:[e.jsx(K,{strokeDasharray:"3 3",stroke:"var(--admin-gray-200)"}),e.jsx(Q,{dataKey:"month",stroke:"var(--admin-gray-500)",fontSize:10}),e.jsx(Y,{stroke:"var(--admin-gray-500)",fontSize:10}),e.jsx(L,{contentStyle:{backgroundColor:"var(--admin-white)",border:"1px solid var(--admin-gray-200)",borderRadius:"8px",boxShadow:"var(--admin-shadow-md)"}}),e.jsx(G,{type:"monotone",dataKey:"installs",stroke:"var(--admin-success)",strokeWidth:2,dot:{fill:"var(--admin-success)",strokeWidth:2,r:4}})]})})})})]}),e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📱 По платформам"})}),e.jsx("div",{className:"admin-card-content",children:e.jsx("div",{className:"admin-h-48",children:e.jsx(B,{width:"100%",height:"100%",children:e.jsxs(ne,{children:[e.jsx(de,{data:ue,cx:"50%",cy:"50%",outerRadius:60,fill:"#8884d8",dataKey:"value",label:({name:n,value:a})=>`${n}: ${a}%`,children:ue.map((n,a)=>e.jsx(te,{fill:n.color},`cell-${a}`))}),e.jsx(L,{contentStyle:{backgroundColor:"var(--admin-white)",border:"1px solid var(--admin-gray-200)",borderRadius:"8px",boxShadow:"var(--admin-shadow-md)"}})]})})})})]}),e.jsxs("div",{className:"admin-card",children:[e.jsx("div",{className:"admin-card-header",children:e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📊 Метрики"})}),e.jsx("div",{className:"admin-card-content admin-space-y-4",children:e.jsxs("div",{className:"admin-grid admin-grid-cols-1 admin-gap-4",children:[e.jsxs("div",{className:"admin-p-4 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-primary-light",children:[e.jsx("div",{className:"admin-text-2xl admin-font-semibold admin-text-admin-primary admin-mb-1",children:l.totalInstalls.toLocaleString()}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"Всего установок"})]}),e.jsxs("div",{className:"admin-p-4 admin-bg-admin-success-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-success-light",children:[e.jsxs("div",{className:"admin-text-2xl admin-font-semibold admin-text-admin-success admin-mb-1",children:[l.retentionRate,"%"]}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"Retention rate"})]}),e.jsxs("div",{className:"admin-p-4 admin-bg-admin-warning-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-warning-light",children:[e.jsxs("div",{className:"admin-text-2xl admin-font-semibold admin-text-admin-warning admin-mb-1",children:["⭐ ",l.averageRating]}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"Средняя оценка"})]})]})})]})]})]}),e.jsxs("div",{className:"admin-flex admin-justify-center admin-gap-4",children:[e.jsx("button",{onClick:o,disabled:p,className:"admin-btn admin-btn-success admin-font-medium",children:p?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Сохраняю..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"💾"}),"Сохранить настройки"]})}),e.jsxs("button",{onClick:y,className:"admin-btn admin-btn-warning admin-font-medium",children:[e.jsx("span",{className:"mr-2",children:"🚀"}),"Опубликовать обновление"]}),e.jsxs("button",{onClick:c,className:"admin-btn admin-btn-primary admin-font-medium",children:[e.jsx("span",{className:"mr-2",children:"📊"}),"Анализ метрик"]})]})]})},sa=[{metric:"Отправлено",value:12345,color:"#3b82f6"},{metric:"Доставлено",value:89,color:"#10b981",percentage:!0},{metric:"Открыто",value:23,color:"#8b5cf6",percentage:!0},{metric:"CTR",value:5.2,color:"#f59e0b",percentage:!0}],ia=()=>{const[i,j]=t.useState({title:"🎉 Новое достижение!",body:"Поздравляем! Вы достигли новой цели в вашем дневнике достижений.",icon:"",badge:""}),[d,v]=t.useState({enablePush:!0,enableScheduled:!1,enableSegmentation:!0}),[l,f]=t.useState(4),[p,b]=t.useState(!1),[o,y]=t.useState(!1),c=async()=>{if(!i.title||!i.body){h.error("Заполните заголовок и текст уведомления");return}b(!0);try{const a=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!a){h.error("Ошибка авторизации");return}const r=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/send-notification",{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({title:i.title,body:i.body,icon:i.icon,badge:i.badge})});if(r.ok)h.success("Уведомление успешно отправлено! 🚀"),j({title:"🎉 Новое достижение!",body:"Поздравляем! Вы достигли новой цели в вашем дневнике достижений.",icon:"",badge:""});else{const u=await r.json().catch(()=>({}));h.error(u.error||"Ошибка при отправке уведомления")}}catch{h.error("Ошибка соединения с сервером")}finally{b(!1)}},n=async()=>{try{const a=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!a){h.error("Ошибка авторизации");return}const r=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/settings",{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({key:"push_notification_settings",value:JSON.stringify(d)})});if(r.ok)h.success("Настройки push-уведомлений сохранены! 🔔");else{const u=await r.json().catch(()=>({}));h.error(u.error||"Ошибка сохранения настроек")}}catch{h.error("Ошибка соединения с сервером")}};return e.jsxs("div",{className:"admin-space-y-8",children:[e.jsxs("header",{className:"admin-flex admin-items-center admin-gap-4 admin-pb-4 admin-border-b admin-border-gray-200",children:[e.jsx("div",{className:"admin-p-3 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-2xl","aria-hidden":"true",children:"🔔"}),e.jsxs("div",{children:[e.jsx("h2",{className:"admin-text-2xl admin-font-semibold admin-text-gray-900",children:"Push-уведомления"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600 admin-mt-1",children:"Создание и управление push уведомлениями для пользователей"})]}),e.jsxs("div",{className:"admin-ml-auto admin-flex admin-gap-2",children:[e.jsxs("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-success-lighter admin-text-admin-success admin-rounded-full admin-text-xs admin-font-medium admin-flex admin-items-center admin-gap-1",children:[e.jsx("div",{className:"admin-w-2 admin-h-2 admin-bg-admin-success admin-rounded-full","aria-hidden":"true"}),"Активен"]}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-primary-lighter admin-text-admin-primary admin-rounded-full admin-text-xs admin-font-medium",children:"📨 12,345 отправлено"})]})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 lg:admin-grid-cols-3 admin-gap-8",children:[e.jsx("div",{className:"lg:admin-col-span-2 admin-space-y-6",children:e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📝 Создание уведомления"}),e.jsx("p",{className:"admin-card-description",children:"Отправка push уведомлений пользователям"})]}),e.jsx("div",{className:"admin-card-content admin-space-y-6",children:e.jsxs("div",{className:"admin-space-y-4",children:[e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"notification-title",className:"admin-font-medium admin-text-gray-900",children:"Заголовок уведомления"}),e.jsx("input",{id:"notification-title",type:"text",value:i.title,onChange:a=>j(r=>({...r,title:a.target.value})),placeholder:"Введите заголовок уведомления",className:"admin-input"})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"notification-body",className:"admin-font-medium admin-text-gray-900",children:"Текст уведомления"}),e.jsx("textarea",{id:"notification-body",value:i.body,onChange:a=>j(r=>({...r,body:a.target.value})),placeholder:"Введите текст уведомления",rows:4,className:"admin-input admin-textarea"})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 admin-gap-6",children:[e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"notification-icon",className:"admin-font-medium admin-text-gray-900",children:"Иконка (URL)"}),e.jsx("input",{id:"notification-icon",type:"text",value:i.icon,onChange:a=>j(r=>({...r,icon:a.target.value})),placeholder:"https://example.com/icon.png",className:"admin-input"})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"notification-badge",className:"admin-font-medium admin-text-gray-900",children:"Бейдж (URL)"}),e.jsx("input",{id:"notification-badge",type:"text",value:i.badge,onChange:a=>j(r=>({...r,badge:a.target.value})),placeholder:"https://example.com/badge.png",className:"admin-input"})]})]}),e.jsx("div",{className:"admin-flex admin-justify-center admin-pt-4",children:e.jsx("button",{onClick:c,disabled:!i.title||!i.body||p,className:"admin-btn admin-btn-primary admin-font-medium admin-text-lg",children:p?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Отправляю уведомление..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"🚀"}),"Отправить уведомление"]})})})]})})]})}),e.jsxs("div",{className:"admin-space-y-6",children:[e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📊 Статистика"}),e.jsx("p",{className:"admin-card-description",children:"Эффективность уведомлений"})]}),e.jsxs("div",{className:"admin-card-content admin-space-y-4",children:[e.jsx("div",{className:"admin-grid admin-grid-cols-1 admin-gap-4",children:sa.map((a,r)=>e.jsxs("div",{className:"admin-p-4 admin-bg-gray-50 admin-rounded-lg admin-text-center admin-border admin-border-gray-200",children:[e.jsx("div",{className:`admin-text-2xl admin-font-semibold admin-mb-2 ${a.percentage?"admin-text-admin-success":"admin-text-admin-primary"}`,children:a.percentage?`${a.value}%`:a.value.toLocaleString()}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:a.metric})]},r))}),e.jsx("div",{className:"admin-p-4 admin-bg-admin-warning-lighter admin-rounded-lg admin-border admin-border-admin-warning-light",children:e.jsxs("div",{className:"admin-text-center admin-mb-4",children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-2",children:"Оценка качества уведомлений"}),e.jsx("div",{className:"admin-flex admin-justify-center admin-gap-1",children:[1,2,3,4,5].map(a=>e.jsx("button",{onClick:()=>f(a),className:`admin-text-3xl admin-transition-all admin-duration-200 admin-transform hover:admin-scale-110 ${a<=l?"admin-text-admin-warning":"admin-text-gray-400"}`,"aria-label":`Оценка ${a} из 5`,children:"★"},a))}),e.jsxs("div",{className:"admin-text-gray-700 admin-text-sm admin-mt-2",children:["Средняя оценка: ",e.jsxs("span",{className:"admin-font-semibold admin-text-admin-warning",children:[l,"/5"]})]})]})})]})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"⚙️ Настройки"}),e.jsx("p",{className:"admin-card-description",children:"Управление параметрами уведомлений"})]}),e.jsx("div",{className:"admin-card-content admin-space-y-6",children:e.jsxs("div",{className:"admin-space-y-4",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"🔔 Включить push уведомления"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Разрешить отправку уведомлений"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"enable-push",type:"checkbox",checked:d.enablePush,onChange:a=>v(r=>({...r,enablePush:a.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]}),e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"⏰ Отложенная отправка"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Планирование отправки"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"enable-scheduled",type:"checkbox",checked:d.enableScheduled,onChange:a=>v(r=>({...r,enableScheduled:a.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]}),e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"🎯 Сегментация аудитории"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Отправка разным группам"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"enable-segmentation",type:"checkbox",checked:d.enableSegmentation,onChange:a=>v(r=>({...r,enableSegmentation:a.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]})]})})]})]})]}),e.jsxs("div",{className:"admin-flex admin-justify-center admin-gap-4",children:[e.jsx("button",{onClick:n,disabled:o,className:"admin-btn admin-btn-success admin-font-medium",children:o?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Сохраняю..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"💾"}),"Сохранить настройки"]})}),e.jsxs("button",{onClick:()=>{h.info("Анализ кампаний в разработке 📊")},className:"admin-btn admin-btn-outline admin-font-medium",children:[e.jsx("span",{className:"mr-2",children:"📊"}),"Анализ кампаний"]}),e.jsxs("button",{onClick:()=>{h.info("A/B тестирование в разработке 🎯")},className:"admin-btn admin-btn-outline admin-font-medium",children:[e.jsx("span",{className:"mr-2",children:"🎯"}),"A/B тестирование"]})]})]})},na=()=>{const[i,j]=t.useState({appName:"Дневник Достижений",appDescription:"Персональный дневник для отслеживания достижений и целей",supportEmail:"support@diary.com",maxEntriesPerDay:10,enableAnalytics:!0,enableErrorReporting:!0,maintenanceMode:!1}),[d,v]=t.useState(!1),[l,f]=t.useState(!1),p=async()=>{v(!0);try{const c=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!c){h.error("Ошибка авторизации");return}const n=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/settings",{method:"POST",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify({key:"general_settings",value:JSON.stringify(i)})});if(n.ok)h.success("Настройки успешно сохранены! ✅");else{const a=await n.json().catch(()=>({}));h.error(a.error||"Ошибка сохранения настроек")}}catch{h.error("Ошибка соединения с сервером")}finally{v(!1)}},b=async()=>{f(!0);try{j({appName:"Дневник Достижений",appDescription:"Персональный дневник для отслеживания достижений и целей",supportEmail:"support@diary.com",maxEntriesPerDay:10,enableAnalytics:!0,enableErrorReporting:!0,maintenanceMode:!1}),h.success("Настройки сброшены к значениям по умолчанию! 🔄")}catch{h.error("Ошибка при сбросе настроек")}finally{f(!1)}},o=()=>{try{const c=JSON.stringify(i,null,2),n="data:application/json;charset=utf-8,"+encodeURIComponent(c),a="unity-general-settings.json",r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download",a),r.click(),h.success("Настройки экспортированы! 📤")}catch{h.error("Ошибка экспорта настроек")}},y=c=>{const n=c.target.files?.[0];if(!n)return;const a=new FileReader;a.onload=r=>{try{const u=r.target?.result,g=JSON.parse(u);j(g),h.success("Настройки импортированы! 📥")}catch{h.error("Ошибка импорта файла настроек")}},a.readAsText(n)};return e.jsxs("div",{className:"admin-space-y-8",children:[e.jsxs("header",{className:"admin-flex admin-items-center admin-gap-4 admin-pb-4 admin-border-b admin-border-gray-200",children:[e.jsx("div",{className:"admin-p-3 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-2xl","aria-hidden":"true",children:"⚙️"}),e.jsxs("div",{children:[e.jsx("h2",{className:"admin-text-2xl admin-font-semibold admin-text-gray-900",children:"Общие настройки"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600 admin-mt-1",children:"Основные параметры и конфигурация приложения"})]}),e.jsxs("div",{className:"admin-ml-auto admin-flex admin-gap-2",children:[e.jsxs("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-success-lighter admin-text-admin-success admin-rounded-full admin-text-xs admin-font-medium admin-flex admin-items-center admin-gap-1",children:[e.jsx("div",{className:"admin-w-2 admin-h-2 admin-bg-admin-success admin-rounded-full","aria-hidden":"true"}),"Активен"]}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-primary-lighter admin-text-admin-primary admin-rounded-full admin-text-xs admin-font-medium",children:"🔧 Готов к настройке"})]})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 lg:admin-grid-cols-3 admin-gap-8",children:[e.jsxs("div",{className:"lg:admin-col-span-2 admin-space-y-6",children:[e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📋 Основные параметры"}),e.jsx("p",{className:"admin-card-description",children:"Базовая конфигурация приложения"})]}),e.jsxs("div",{className:"admin-card-content admin-space-y-6",children:[e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 admin-gap-6",children:[e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"app-name",className:"admin-font-medium admin-text-gray-900",children:"Название приложения"}),e.jsx("input",{id:"app-name",type:"text",value:i.appName,onChange:c=>j(n=>({...n,appName:c.target.value})),className:"admin-input"})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"support-email",className:"admin-font-medium admin-text-gray-900",children:"Email поддержки"}),e.jsx("input",{id:"support-email",type:"email",value:i.supportEmail,onChange:c=>j(n=>({...n,supportEmail:c.target.value})),className:"admin-input"})]})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"app-description",className:"admin-font-medium admin-text-gray-900",children:"Описание приложения"}),e.jsx("textarea",{id:"app-description",value:i.appDescription,onChange:c=>j(n=>({...n,appDescription:c.target.value})),rows:3,className:"admin-input admin-textarea"})]}),e.jsxs("div",{className:"admin-space-y-3",children:[e.jsx("label",{htmlFor:"max-entries",className:"admin-font-medium admin-text-gray-900",children:"Максимум записей в день"}),e.jsx("input",{id:"max-entries",type:"number",value:i.maxEntriesPerDay,onChange:c=>j(n=>({...n,maxEntriesPerDay:parseInt(c.target.value)||0})),className:"admin-input"})]})]})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"🔧 Системные функции"}),e.jsx("p",{className:"admin-card-description",children:"Конфигурация дополнительных возможностей"})]}),e.jsx("div",{className:"admin-card-content admin-space-y-6",children:e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 admin-gap-6",children:[e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-admin-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"📊 Аналитика"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Сбор данных об использовании"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"enable-analytics",type:"checkbox",checked:i.enableAnalytics,onChange:c=>j(n=>({...n,enableAnalytics:c.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]}),e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-admin-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"🐛 Отчеты об ошибках"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Автоматическая отправка отчетов"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"enable-error-reporting",type:"checkbox",checked:i.enableErrorReporting,onChange:c=>j(n=>({...n,enableErrorReporting:c.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]}),e.jsxs("div",{className:"admin-flex admin-items-center admin-justify-between admin-p-4 admin-bg-admin-warning-lighter admin-rounded-lg admin-border admin-border-admin-warning-light md:admin-col-span-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"🔧 Режим обслуживания"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600",children:"Временно отключить приложение"})]}),e.jsxs("div",{className:"admin-switch",children:[e.jsx("input",{id:"maintenance-mode",type:"checkbox",checked:i.maintenanceMode,onChange:c=>j(n=>({...n,maintenanceMode:c.target.checked})),className:"admin-sr-only"}),e.jsx("div",{className:"admin-switch-slider"})]})]})]})})]})]}),e.jsx("div",{className:"admin-space-y-6",children:e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"💾 Управление данными"}),e.jsx("p",{className:"admin-card-description",children:"Экспорт и импорт настроек"})]}),e.jsxs("div",{className:"admin-card-content admin-space-y-6",children:[e.jsxs("div",{className:"admin-space-y-4",children:[e.jsx("button",{onClick:p,disabled:d,className:"admin-btn admin-btn-success admin-w-full admin-font-medium",children:d?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Сохраняю настройки..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"💾"}),"Сохранить настройки"]})}),e.jsx("button",{onClick:b,disabled:l,className:"admin-btn admin-btn-outline admin-w-full admin-font-medium",children:l?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Сбрасываю..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"🔄"}),"Сбросить настройки"]})})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 admin-gap-4",children:[e.jsxs("div",{className:"admin-p-4 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-primary-light",children:[e.jsx("div",{className:"admin-text-xl admin-font-semibold admin-text-admin-primary admin-mb-2",children:"📤 Экспорт"}),e.jsx("button",{onClick:o,className:"admin-btn admin-btn-outline admin-btn-sm",children:"Скачать JSON"})]}),e.jsxs("div",{className:"admin-p-4 admin-bg-admin-success-lighter admin-rounded-lg admin-text-center admin-border admin-border-admin-success-light",children:[e.jsx("div",{className:"admin-text-xl admin-font-semibold admin-text-admin-success admin-mb-2",children:"📥 Импорт"}),e.jsx("button",{onClick:()=>document.getElementById("import-settings-file")?.click(),className:"admin-btn admin-btn-outline admin-btn-sm",children:"Загрузить файл"}),e.jsx("input",{id:"import-settings-file",type:"file",accept:".json",className:"admin-hidden",onChange:y,"aria-label":"Импорт настроек из файла"})]})]})]})]})})]})]})},da=[{time:"00:00",cpu:45,memory:67,disk:23,network:12},{time:"04:00",cpu:52,memory:71,disk:25,network:15},{time:"08:00",cpu:78,memory:84,disk:28,network:45},{time:"12:00",cpu:65,memory:76,disk:26,network:32},{time:"16:00",cpu:58,memory:69,disk:24,network:28},{time:"20:00",cpu:49,memory:63,disk:22,network:18}],ta=()=>{const[i,j]=t.useState({database:"online",api:"online",storage:"online",cache:"online"}),[d,v]=t.useState({cpu:45,memory:67,disk:23,network:12}),[l,f]=t.useState(null),[p,b]=t.useState(!1),o=async n=>{f(n);try{const a=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!a){h.error("Ошибка авторизации");return}const r=await fetch(`https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/restart/${n.toLowerCase()}`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(r.ok)h.success(`Сервис ${n} успешно перезапущен! 🔄`);else{const u=await r.json().catch(()=>({}));h.error(u.error||`Ошибка при перезапуске ${n}`)}}catch{h.error(`Ошибка соединения при перезапуске ${n}`)}finally{f(null)}},y=async()=>{b(!0);try{const n=localStorage.getItem("sb-ecuwuzqlwdkkdncampnc-auth-token");if(!n){h.error("Ошибка авторизации");return}const a=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/backup",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});if(a.ok){const r=await a.json();if(h.success("Резервная копия базы данных успешно создана! 💾"),r.backupUrl){const u=document.createElement("a");u.setAttribute("href",r.backupUrl),u.setAttribute("download",`unity-backup-${new Date().toISOString().split("T")[0]}.sql`),u.click()}}else{const r=await a.json().catch(()=>({}));h.error(r.error||"Ошибка при создании резервной копии")}}catch{h.error("Ошибка соединения при создании резервной копии")}finally{b(!1)}},c=()=>{h.info("Функция восстановления из резервной копии в разработке 📂")};return e.jsxs("div",{className:"admin-space-y-8",children:[e.jsxs("header",{className:"admin-flex admin-items-center admin-gap-4 admin-pb-4 admin-border-b admin-border-gray-200",children:[e.jsx("div",{className:"admin-p-3 admin-bg-admin-primary-lighter admin-rounded-lg admin-text-2xl","aria-hidden":"true",children:"🖥️"}),e.jsxs("div",{children:[e.jsx("h2",{className:"admin-text-2xl admin-font-semibold admin-text-gray-900",children:"Системные настройки"}),e.jsx("p",{className:"admin-text-sm admin-text-gray-600 admin-mt-1",children:"Мониторинг и управление системными ресурсами в реальном времени"})]}),e.jsxs("div",{className:"admin-ml-auto admin-flex admin-gap-2",children:[e.jsxs("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-success-lighter admin-text-admin-success admin-rounded-full admin-text-xs admin-font-medium admin-flex admin-items-center admin-gap-1",children:[e.jsx("div",{className:"admin-w-2 admin-h-2 admin-bg-admin-success admin-rounded-full","aria-hidden":"true"}),"Все системы работают"]}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-primary-lighter admin-text-admin-primary admin-rounded-full admin-text-xs admin-font-medium",children:"📊 Мониторинг активен"})]})]}),e.jsxs("div",{className:"admin-grid admin-grid-cols-1 lg:admin-grid-cols-3 admin-gap-8",children:[e.jsx("div",{className:"lg:admin-col-span-2 admin-space-y-6",children:e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"🔍 Статус системы"}),e.jsx("p",{className:"admin-card-description",children:"Мониторинг состояния всех сервисов"})]}),e.jsx("div",{className:"admin-card-content",children:e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 admin-gap-6",children:[e.jsxs("div",{className:"admin-p-6 admin-bg-admin-success-lighter admin-rounded-lg admin-border admin-border-admin-success-light admin-relative admin-overflow-hidden",children:[e.jsx("div",{className:"admin-absolute admin-top-2 admin-right-2",children:e.jsx("div",{className:"admin-w-3 admin-h-3 admin-bg-admin-success admin-rounded-full","aria-hidden":"true"})}),e.jsxs("div",{className:"admin-text-center",children:[e.jsx("div",{className:"admin-text-3xl admin-font-semibold admin-text-admin-success admin-mb-2","aria-hidden":"true",children:"🗄️"}),e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"База данных"}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm admin-mb-3",children:"PostgreSQL"}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-success admin-text-white admin-rounded admin-text-xs admin-font-medium",children:"✅ Работает стабильно"})]})]}),e.jsxs("div",{className:"admin-p-6 admin-bg-admin-primary-lighter admin-rounded-lg admin-border admin-border-admin-primary-light admin-relative admin-overflow-hidden",children:[e.jsx("div",{className:"admin-absolute admin-top-2 admin-right-2",children:e.jsx("div",{className:"admin-w-3 admin-h-3 admin-bg-admin-primary admin-rounded-full","aria-hidden":"true"})}),e.jsxs("div",{className:"admin-text-center",children:[e.jsx("div",{className:"admin-text-3xl admin-font-semibold admin-text-admin-primary admin-mb-2","aria-hidden":"true",children:"🚀"}),e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"API сервер"}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm admin-mb-3",children:"Edge Functions"}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-primary admin-text-white admin-rounded admin-text-xs admin-font-medium",children:"✅ Высокая производительность"})]})]}),e.jsxs("div",{className:"admin-p-6 admin-bg-admin-secondary-lighter admin-rounded-lg admin-border admin-border-admin-secondary-light admin-relative admin-overflow-hidden",children:[e.jsx("div",{className:"admin-absolute admin-top-2 admin-right-2",children:e.jsx("div",{className:"admin-w-3 admin-h-3 admin-bg-admin-secondary admin-rounded-full","aria-hidden":"true"})}),e.jsxs("div",{className:"admin-text-center",children:[e.jsx("div",{className:"admin-text-3xl admin-font-semibold admin-text-admin-secondary admin-mb-2","aria-hidden":"true",children:"💾"}),e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"Хранилище"}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm admin-mb-3",children:"Supabase Storage"}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-secondary admin-text-white admin-rounded admin-text-xs admin-font-medium",children:"✅ Доступно и стабильно"})]})]}),e.jsxs("div",{className:"admin-p-6 admin-bg-admin-warning-lighter admin-rounded-lg admin-border admin-border-admin-warning-light admin-relative admin-overflow-hidden",children:[e.jsx("div",{className:"admin-absolute admin-top-2 admin-right-2",children:e.jsx("div",{className:"admin-w-3 admin-h-3 admin-bg-admin-warning admin-rounded-full","aria-hidden":"true"})}),e.jsxs("div",{className:"admin-text-center",children:[e.jsx("div",{className:"admin-text-3xl admin-font-semibold admin-text-admin-warning admin-mb-2","aria-hidden":"true",children:"⚡"}),e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"Кэш"}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm admin-mb-3",children:"Redis"}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-warning admin-text-white admin-rounded admin-text-xs admin-font-medium",children:"✅ Быстрый отклик"})]})]})]})})]})}),e.jsx("div",{className:"admin-space-y-6",children:e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📊 Ресурсы системы"}),e.jsx("p",{className:"admin-card-description",children:"Использование в реальном времени"})]}),e.jsx("div",{className:"admin-card-content admin-space-y-6",children:e.jsxs("div",{className:"admin-space-y-4",children:[e.jsxs("div",{className:"admin-space-y-2",children:[e.jsxs("div",{className:"admin-flex admin-justify-between",children:[e.jsx("span",{className:"admin-text-gray-700",children:"CPU"}),e.jsxs("span",{className:"admin-font-medium admin-text-gray-900",children:[d.cpu,"%"]})]}),e.jsx("div",{className:"admin-w-full admin-bg-gray-200 admin-rounded-full admin-h-2",children:e.jsx("div",{className:"admin-bg-admin-warning admin-h-2 admin-rounded-full admin-transition-all",style:{width:`${d.cpu}%`},"aria-label":`Использование CPU: ${d.cpu}%`})})]}),e.jsxs("div",{className:"admin-space-y-2",children:[e.jsxs("div",{className:"admin-flex admin-justify-between",children:[e.jsx("span",{className:"admin-text-gray-700",children:"Память"}),e.jsxs("span",{className:"admin-font-medium admin-text-gray-900",children:[d.memory,"%"]})]}),e.jsx("div",{className:"admin-w-full admin-bg-gray-200 admin-rounded-full admin-h-2",children:e.jsx("div",{className:"admin-bg-admin-error admin-h-2 admin-rounded-full admin-transition-all",style:{width:`${d.memory}%`},"aria-label":`Использование памяти: ${d.memory}%`})})]}),e.jsxs("div",{className:"admin-space-y-2",children:[e.jsxs("div",{className:"admin-flex admin-justify-between",children:[e.jsx("span",{className:"admin-text-gray-700",children:"Диск"}),e.jsxs("span",{className:"admin-font-medium admin-text-gray-900",children:[d.disk,"%"]})]}),e.jsx("div",{className:"admin-w-full admin-bg-gray-200 admin-rounded-full admin-h-2",children:e.jsx("div",{className:"admin-bg-admin-primary admin-h-2 admin-rounded-full admin-transition-all",style:{width:`${d.disk}%`},"aria-label":`Использование диска: ${d.disk}%`})})]}),e.jsxs("div",{className:"admin-space-y-2",children:[e.jsxs("div",{className:"admin-flex admin-justify-between",children:[e.jsx("span",{className:"admin-text-gray-700",children:"Сеть"}),e.jsxs("span",{className:"admin-font-medium admin-text-gray-900",children:[d.network,"%"]})]}),e.jsx("div",{className:"admin-w-full admin-bg-gray-200 admin-rounded-full admin-h-2",children:e.jsx("div",{className:"admin-bg-admin-success admin-h-2 admin-rounded-full admin-transition-all",style:{width:`${d.network}%`},"aria-label":`Использование сети: ${d.network}%`})})]})]})})]})})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📈 Мониторинг ресурсов (24ч)"}),e.jsx("p",{className:"admin-card-description",children:"Графики использования системных ресурсов"})]}),e.jsx("div",{className:"admin-card-content",children:e.jsx("div",{className:"admin-h-80",children:e.jsx(B,{width:"100%",height:"100%",children:e.jsxs(re,{data:da,children:[e.jsx(K,{strokeDasharray:"3 3",stroke:"var(--admin-gray-200)"}),e.jsx(Q,{dataKey:"time",stroke:"var(--admin-gray-500)",fontSize:12}),e.jsx(Y,{stroke:"var(--admin-gray-500)",fontSize:12}),e.jsx(L,{contentStyle:{backgroundColor:"var(--admin-white)",border:"1px solid var(--admin-gray-200)",borderRadius:"8px",boxShadow:"var(--admin-shadow-md)"}}),e.jsx(G,{type:"monotone",dataKey:"cpu",stroke:"var(--admin-warning)",strokeWidth:2,dot:{fill:"var(--admin-warning)",strokeWidth:2,r:4}}),e.jsx(G,{type:"monotone",dataKey:"memory",stroke:"var(--admin-error)",strokeWidth:2,dot:{fill:"var(--admin-error)",strokeWidth:2,r:4}})]})})})})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"🔧 Управление сервисами"}),e.jsx("p",{className:"admin-card-description",children:"Перезапуск и обслуживание системных компонентов"})]}),e.jsx("div",{className:"admin-card-content",children:e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-2 lg:admin-grid-cols-4 admin-gap-4",children:[e.jsx("button",{onClick:()=>o("API"),disabled:l==="API",className:"admin-btn admin-btn-primary admin-font-medium",children:l==="API"?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Перезапуск..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"🚀"}),"API сервер"]})}),e.jsx("button",{onClick:()=>o("Database"),disabled:l==="Database",className:"admin-btn admin-btn-success admin-font-medium",children:l==="Database"?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Перезапуск..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"🗄️"}),"База данных"]})}),e.jsx("button",{onClick:()=>o("Cache"),disabled:l==="Cache",className:"admin-btn admin-btn-warning admin-font-medium",children:l==="Cache"?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Очистка..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"⚡"}),"Очистить кэш"]})}),e.jsx("button",{onClick:()=>o("Storage"),disabled:l==="Storage",className:"admin-btn admin-btn-outline admin-font-medium",children:l==="Storage"?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Перезапуск..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"💾"}),"Хранилище"]})})]})})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"💾 Резервное копирование"}),e.jsx("p",{className:"admin-card-description",children:"Управление резервными копиями данных"})]}),e.jsx("div",{className:"admin-card-content",children:e.jsxs("div",{className:"admin-space-y-6",children:[e.jsxs("div",{className:"admin-flex admin-gap-4",children:[e.jsx("button",{onClick:y,disabled:p,className:"admin-btn admin-btn-success admin-font-medium",children:p?e.jsxs("div",{className:"admin-flex admin-items-center admin-gap-2",children:[e.jsx("div",{className:"admin-spinner"}),"Создаю копию..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"💾"}),"Создать резервную копию"]})}),e.jsxs("button",{onClick:c,className:"admin-btn admin-btn-outline admin-font-medium",children:[e.jsx("span",{className:"mr-2",children:"📂"}),"Восстановить из копии"]})]}),e.jsx("div",{className:"admin-p-4 admin-bg-gray-50 admin-rounded-lg admin-border admin-border-gray-200",children:e.jsxs("div",{className:"admin-grid admin-grid-cols-1 md:admin-grid-cols-3 admin-gap-4 admin-text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"Последняя копия"}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"2 часа назад"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"Размер"}),e.jsx("div",{className:"admin-text-gray-600 admin-text-sm",children:"45.2 MB"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"admin-font-medium admin-text-gray-900 admin-mb-1",children:"Статус"}),e.jsx("div",{className:"admin-px-3 admin-py-1 admin-bg-admin-success-lighter admin-text-admin-success admin-rounded admin-text-xs admin-font-medium admin-inline-block",children:"✅ Успешно"})]})]})})]})})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"admin-card-header",children:[e.jsx("h3",{className:"admin-card-title admin-flex admin-items-center admin-gap-2",children:"📝 Системные логи"}),e.jsx("p",{className:"admin-card-description",children:"Последние записи в логах системы"})]}),e.jsx("div",{className:"admin-card-content",children:e.jsx("div",{className:"admin-bg-gray-900 admin-text-green-400 admin-p-6 admin-rounded-lg admin-font-mono admin-text-sm admin-max-h-64 admin-overflow-y-auto admin-border admin-border-gray-700",children:e.jsxs("div",{className:"admin-space-y-1",children:[e.jsx("div",{className:"admin-text-green-300",children:"[2024-01-15 10:30:15] INFO: API request processed successfully"}),e.jsx("div",{className:"admin-text-green-300",children:"[2024-01-15 10:30:12] INFO: User authentication successful"}),e.jsx("div",{className:"admin-text-blue-300",children:"[2024-01-15 10:30:08] INFO: Database connection established"}),e.jsx("div",{className:"admin-text-green-300",children:"[2024-01-15 10:30:05] INFO: Cache cleared successfully"}),e.jsx("div",{className:"admin-text-green-300",children:"[2024-01-15 10:30:02] INFO: System startup completed"}),e.jsx("div",{className:"admin-text-yellow-300",children:"[2024-01-15 10:29:58] WARN: High memory usage detected"}),e.jsx("div",{className:"admin-text-green-300",children:"[2024-01-15 10:29:55] INFO: Scheduled backup completed"}),e.jsx("div",{className:"admin-text-green-300",children:"[2024-01-15 10:29:50] INFO: API rate limit reset"})]})})})]})]})};function ra(){const[i,j]=t.useState(!1),[d,v]=t.useState(!1),[l,f]=t.useState(null),[p,b]=t.useState({totalUsers:0,telegramUsers:0,lastActivity:null}),[o,y]=t.useState({username:"@diary_bookai_bot",domain:"unity-diary-app.netlify.app",tokenMasked:"8297834785:******AQbo"}),c=H();t.useEffect(()=>{c.auth.getSession().then(({data:{session:u}})=>{f(u)})},[]),t.useEffect(()=>{l&&(n(),a())},[l]);const n=async()=>{if(l)try{const u=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/telegram-auth",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l.access_token}`,apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVjdXd1enFsd2Rra2RuY2FtcG5jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwNTg2OTQsImV4cCI6MjA3NTYzNDY5NH0.OnBM1BIQMVgJur2nM4gZGDW-PWWwSR92DpJHhPpqB88"}});if(u.ok){const g=await u.json();j(g.connected),g.botUsername&&y(x=>({...x,username:g.botUsername})),g.domain&&y(x=>({...x,domain:g.domain}))}else j(!1)}catch{j(!1)}},a=async()=>{try{const{data:u}=await c.from("profiles").select("id, telegram_id, created_at, updated_at");if(u){const g=u.filter(s=>s.telegram_id).length,x=u.filter(s=>s.telegram_id).sort((s,m)=>new Date(m.updated_at).getTime()-new Date(s.updated_at).getTime())[0];b({totalUsers:u.length,telegramUsers:g,lastActivity:x?.updated_at||null})}}catch{}},r=async()=>{if(!l){h.error("Необходимо войти в систему");return}v(!0);try{const u=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/telegram-auth",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l.access_token}`,apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVjdXd1enFsd2Rra2RuY2FtcG5jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwNTg2OTQsImV4cCI6MjA3NTYzNDY5NH0.OnBM1BIQMVgJur2nM4gZGDW-PWWwSR92DpJHhPpqB88"}});if(u.ok)(await u.json()).connected?(h.success("Интеграция с Telegram активна"),j(!0)):(h.error("Интеграция с Telegram не настроена"),j(!1));else throw new Error("Не удалось проверить интеграцию")}catch{h.error("Ошибка тестирования интеграции"),j(!1)}finally{v(!1)}};return e.jsxs("div",{style:{padding:"20px",fontFamily:"Arial, sans-serif"},children:[e.jsx("h2",{style:{marginBottom:"20px",color:"#333"},children:"Настройки Telegram"}),e.jsxs("div",{style:{marginBottom:"20px",padding:"15px",border:"1px solid #ddd",borderRadius:"8px",backgroundColor:"#f9f9f9"},children:[e.jsx("h3",{style:{margin:"0 0 10px 0",color:"#333"},children:"Статус интеграции"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:i?"#28a745":"#dc3545"}}),e.jsx("span",{style:{fontSize:"16px",fontWeight:"bold"},children:i?"Интеграция активна":"Требуется настройка"})]})]}),e.jsxs("div",{style:{marginBottom:"20px",padding:"15px",border:"1px solid #ddd",borderRadius:"8px"},children:[e.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Статистика пользователей"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[e.jsxs("div",{style:{textAlign:"center",padding:"10px",backgroundColor:"#f8f9fa",borderRadius:"4px"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#007bff"},children:p.totalUsers}),e.jsx("div",{style:{fontSize:"14px",color:"#666"},children:"Всего пользователей"})]}),e.jsxs("div",{style:{textAlign:"center",padding:"10px",backgroundColor:"#f8f9fa",borderRadius:"4px"},children:[e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#28a745"},children:p.telegramUsers}),e.jsx("div",{style:{fontSize:"14px",color:"#666"},children:"Через Telegram"})]})]}),p.lastActivity&&e.jsxs("div",{style:{marginTop:"10px",fontSize:"12px",color:"#666",textAlign:"center"},children:["Последняя активность: ",new Date(p.lastActivity).toLocaleString("ru-RU")]})]}),e.jsxs("div",{style:{marginBottom:"20px",padding:"15px",border:"1px solid #ddd",borderRadius:"8px"},children:[e.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Настройки бота"}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Bot Username"}),e.jsx("input",{type:"text",value:o.username,disabled:!0,style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f5f5f5"}})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Bot Token (замаскирован)"}),e.jsx("input",{type:"text",value:o.tokenMasked,disabled:!0,style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f5f5f5",fontFamily:"monospace"}})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Домен приложения"}),e.jsx("input",{type:"text",value:o.domain,disabled:!0,style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f5f5f5"}})]}),e.jsx("button",{onClick:r,disabled:d,style:{padding:"10px 20px",backgroundColor:d?"#ccc":"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:d?"not-allowed":"pointer"},children:d?"Проверка...":"Проверить интеграцию"})]}),e.jsxs("div",{style:{padding:"15px",border:"1px solid #ddd",borderRadius:"8px",backgroundColor:"#f8f9fa"},children:[e.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Инструкции по настройке"}),e.jsxs("ol",{style:{margin:0,paddingLeft:"20px"},children:[e.jsxs("li",{style:{marginBottom:"10px"},children:[e.jsx("strong",{children:"Создайте бота в Telegram"}),e.jsx("br",{}),"Используйте @BotFather для создания нового бота"]}),e.jsxs("li",{style:{marginBottom:"10px"},children:[e.jsx("strong",{children:"Получите токен бота"}),e.jsx("br",{}),"Скопируйте токен из сообщения BotFather"]}),e.jsxs("li",{style:{marginBottom:"10px"},children:[e.jsx("strong",{children:"Настройте домены"}),e.jsx("br",{}),"Добавьте ваш домен в настройки бота через BotFather"]}),e.jsxs("li",{style:{marginBottom:"10px"},children:[e.jsx("strong",{children:"Добавьте токен в переменные окружения Supabase"}),e.jsx("br",{}),"В Dashboard → Edge Functions добавьте TELEGRAM_BOT_TOKEN"]})]})]})]})}const ma=({className:i,activeSubTab:j,onSubTabChange:d})=>{const[v,l]=t.useState(j||"api"),[f,p]=t.useState(""),b=c=>{l(c),d?.(c)},o=[{value:"api",label:"API",icon:"🔑",description:"Управление API ключами"},{value:"telegram",label:"Telegram",icon:"📱",description:"Интеграция с Telegram"},{value:"languages",label:"Языки",icon:"🌍",description:"Настройки языков"},{value:"pwa",label:"PWA",icon:"📱",description:"PWA настройки"},{value:"push",label:"Push",icon:"🔔",description:"Push-уведомления"},{value:"general",label:"Общие",icon:"⚙️",description:"Общие настройки"},{value:"system",label:"Система",icon:"🖥️",description:"Системные настройки"}],y=o.filter(c=>c.label.toLowerCase().includes(f.toLowerCase())||c.description.toLowerCase().includes(f.toLowerCase()));return e.jsx("div",{className:`admin-panel ${i}`,children:e.jsxs("div",{className:"admin-p-6 lg:admin-p-8 admin-pb-4 admin-max-w-[1400px] admin-mx-auto",children:[e.jsxs("header",{className:"admin-mb-10",children:[e.jsx("h1",{className:"admin-text-4xl admin-font-bold admin-text-gray-900 admin-mb-3",children:"Настройки системы"}),e.jsx("p",{className:"admin-text-lg admin-text-gray-600",children:"Управление всеми аспектами системы"})]}),e.jsxs("div",{className:"admin-search-container admin-mb-10 admin-max-w-xl",children:[e.jsx("svg",{className:"admin-search-icon",width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})}),e.jsx("input",{type:"text",placeholder:"Поиск настроек...",value:f,onChange:c=>p(c.target.value),className:"admin-search-input admin-text-base","aria-label":"Поиск по настройкам"})]}),e.jsxs(Ee,{value:v,onValueChange:b,className:"w-full",children:[e.jsx("nav",{className:"admin-mb-10","aria-label":"Навигация по настройкам",children:e.jsx(Le,{className:"admin-flex admin-flex-wrap admin-gap-3 admin-bg-white admin-border admin-border-gray-200 admin-p-2 admin-rounded-xl admin-shadow-sm",children:o.map(c=>e.jsxs(Ue,{value:c.value,className:"admin-flex admin-items-center admin-gap-3 admin-px-6 admin-py-4 admin-rounded-lg admin-font-medium admin-text-base admin-transition-all admin-duration-200 admin-text-gray-700 hover:admin-text-gray-900 hover:admin-bg-gray-50 focus-visible:admin-ring-2 focus-visible:admin-ring-admin-primary focus-visible:admin-ring-offset-2 data-[state=active]:admin-bg-admin-primary data-[state=active]:admin-text-white data-[state=active]:admin-shadow-md","aria-label":`${c.label} - ${c.description}`,children:[e.jsx("span",{className:"admin-text-xl","aria-hidden":"true",children:c.icon}),e.jsx("span",{children:c.label})]},c.value))})}),e.jsx("main",{className:"min-h-[500px]",children:y.length===0&&f?e.jsxs("div",{className:"admin-text-center admin-py-12",children:[e.jsxs("p",{className:"admin-text-gray-500 admin-text-lg admin-mb-2",children:['Нет настроек, соответствующих "',f,'"']}),e.jsx("button",{onClick:()=>p(""),className:"admin-btn admin-btn-outline",children:"Очистить поиск"})]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{value:"api",children:e.jsx(He,{})}),e.jsx(E,{value:"telegram",children:e.jsx(ra,{})}),e.jsx(E,{value:"languages",children:e.jsx(Ze,{})}),e.jsx(E,{value:"pwa",children:e.jsx(aa,{})}),e.jsx(E,{value:"push",children:e.jsx(ia,{})}),e.jsx(E,{value:"general",children:e.jsx(na,{})}),e.jsx(E,{value:"system",children:e.jsx(ta,{})})]})})]})]})})};function la(){const[i,j]=t.useState([]),[d,v]=t.useState({totalRevenue:47280,activeSubscriptions:156,churnRate:3.2,mrr:15600});t.useEffect(()=>{l()},[]);const l=async()=>{try{j([{id:"1",userName:"Алексей Иванов",userEmail:"alexey@example.com",plan:"premium_monthly",status:"active",startDate:"2024-02-01",nextBillingDate:"2024-04-01",amount:399},{id:"2",userName:"Мария Петрова",userEmail:"maria@example.com",plan:"premium_yearly",status:"active",startDate:"2024-01-15",nextBillingDate:"2025-01-15",amount:3990}])}catch{}},f=b=>b==="premium_yearly"?e.jsx(F,{className:"bg-accent/10 text-accent border-accent",children:"Годовая"}):e.jsx(F,{variant:"outline",children:"Месячная"}),p=b=>b==="active"?e.jsx(F,{className:"bg-green-500/10 text-green-600 border-green-500/20",children:"Активна"}):e.jsx(F,{variant:"outline",className:"bg-muted",children:"Отменена"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(I,{children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[14px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4"}),"Общий доход"]})}),e.jsx(A,{children:e.jsxs("div",{className:"!text-[28px] !font-semibold text-foreground",children:[d.totalRevenue.toLocaleString()," ₽"]})})]}),e.jsxs(I,{children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[14px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),"Активных подписок"]})}),e.jsx(A,{children:e.jsx("div",{className:"!text-[28px] !font-semibold text-foreground",children:d.activeSubscriptions})})]}),e.jsxs(I,{children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[14px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"MRR"]})}),e.jsx(A,{children:e.jsxs("div",{className:"!text-[28px] !font-semibold text-foreground",children:[d.mrr.toLocaleString()," ₽"]})})]}),e.jsxs(I,{children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[14px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Churn Rate"]})}),e.jsx(A,{children:e.jsxs("div",{className:"!text-[28px] !font-semibold text-foreground",children:[d.churnRate,"%"]})})]})]}),e.jsxs(I,{children:[e.jsxs(T,{children:[e.jsx(P,{className:"!text-[20px] !font-semibold",children:"Активные подписки"}),e.jsx(X,{children:"Управление премиум-подписками пользователей"})]}),e.jsx(A,{children:e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(je,{children:[e.jsx(be,{children:e.jsxs(V,{children:[e.jsx(O,{children:"Пользователь"}),e.jsx(O,{children:"План"}),e.jsx(O,{children:"Статус"}),e.jsx(O,{children:"Дата начала"}),e.jsx(O,{children:"След. платеж"}),e.jsx(O,{className:"text-right",children:"Сумма"})]})}),e.jsx(fe,{children:i.map(b=>e.jsxs(V,{children:[e.jsx($,{children:e.jsxs("div",{children:[e.jsx("div",{className:"!text-[14px] !font-semibold text-foreground",children:b.userName}),e.jsx("div",{className:"!text-[12px] !font-normal text-muted-foreground",children:b.userEmail})]})}),e.jsx($,{children:f(b.plan)}),e.jsx($,{children:p(b.status)}),e.jsx($,{className:"!text-[13px]",children:b.startDate}),e.jsx($,{className:"!text-[13px]",children:b.nextBillingDate}),e.jsxs($,{className:"text-right !text-[14px] !font-semibold",children:[b.amount," ₽"]})]},b.id))})]})})})]})]})}const ca="diary@leadshunter.biz";function oa({userData:i,onLogout:j}){const[d,v]=t.useState("overview"),[l,f]=t.useState(!1),[p,b]=t.useState(!1),[o,y]=t.useState("pwa"),[c,n]=t.useState({totalUsers:0,activeUsers:0,premiumUsers:0,totalRevenue:0,newUsersToday:0,activeToday:0,totalEntries:0,pwaInstalls:0}),a=i?.email===ca;t.useEffect(()=>{a&&r()},[a]),t.useEffect(()=>{const g=x=>{const{tab:s,subtab:m}=x.detail;s&&v(s),m&&y(m)};return window.addEventListener("admin-navigate",g),()=>{window.removeEventListener("admin-navigate",g)}},[]);const r=async()=>{try{b(!0);const g=H(),{data:{session:x}}=await g.auth.getSession();if(!x?.access_token)throw new Error("No session");const s=await fetch("https://ecuwuzqlwdkkdncampnc.supabase.co/functions/v1/make-server-9729c493/admin/stats",{headers:{Authorization:`Bearer ${x.access_token}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error("Failed to load stats");const m=await s.json();n(m.stats)}catch{h.error("Ошибка загрузки статистики"),n({totalUsers:0,activeUsers:0,premiumUsers:0,totalRevenue:0,newUsersToday:0,activeToday:0,totalEntries:0,pwaInstalls:0})}finally{b(!1)}};if(!a)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsx(I,{className:"max-w-md w-full border-border",children:e.jsx(A,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(J,{className:"w-16 h-16 text-destructive mx-auto mb-4"}),e.jsx("p",{className:"text-foreground mb-2",children:"Доступ запрещён"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"У вас нет прав для доступа к панели администратора"}),e.jsx(D,{onClick:j,className:"w-full bg-accent hover:bg-accent/90 text-accent-foreground",children:"Выйти"})]})})})});const u=[{id:"overview",label:"Обзор",icon:Ae},{id:"users",label:"Пользователи",icon:W},{id:"subscriptions",label:"Подписки",icon:ge},{id:"settings",label:"Настройки",icon:De}];return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("aside",{className:"hidden lg:fixed lg:inset-y-0 lg:left-0 lg:z-50 lg:block lg:w-64 lg:overflow-y-auto lg:bg-card lg:border-r lg:border-border",children:[e.jsxs("div",{className:"flex h-16 items-center gap-3 border-b border-border px-6 bg-accent",children:[e.jsx("div",{className:"w-10 h-10 rounded-[var(--radius)] bg-white/20 backdrop-blur-sm flex items-center justify-center shrink-0",children:e.jsx(J,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-white !text-[17px]",children:"Admin Panel"}),e.jsx("p",{className:"text-white/80 !text-[13px] !font-normal",children:"Дневник Достижений"})]})]}),e.jsx("nav",{className:"p-4 space-y-1",children:u.map(g=>{const x=g.icon,s=d===g.id;return e.jsxs(z.button,{onClick:()=>v(g.id),className:`
                  w-full flex items-center gap-3 px-3 py-2.5 rounded-[var(--radius)] transition-all !text-[15px] relative
                  ${s?"bg-accent text-accent-foreground shadow-lg":"text-foreground hover:bg-muted"}
                `,whileHover:{scale:1.02},whileTap:{scale:.98},transition:{type:"spring",stiffness:400,damping:17},children:[e.jsx(x,{className:"w-5 h-5"}),e.jsx("span",{children:g.label}),s&&e.jsx(z.div,{className:"absolute inset-0 bg-accent/20 rounded-[var(--radius)]",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.2}})]},g.id)})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t border-border bg-card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3 px-3 py-2 bg-muted rounded-[var(--radius)]",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-accent flex items-center justify-center text-accent-foreground shrink-0",children:i?.email?.[0].toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"!text-[14px] text-foreground truncate",children:i?.email}),e.jsx("p",{className:"!text-[12px] text-muted-foreground !font-normal",children:"Супер-администратор"})]})]}),e.jsxs(D,{variant:"outline",className:"w-full justify-start gap-2 !text-[15px]",onClick:j,children:[e.jsx(Z,{className:"w-4 h-4"}),"Выход"]})]})]}),e.jsx(ce,{children:l&&e.jsxs(e.Fragment,{children:[e.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>f(!1)}),e.jsxs(z.aside,{initial:{x:-280},animate:{x:0},exit:{x:-280},transition:{type:"spring",damping:30,stiffness:300},className:"fixed inset-y-0 left-0 z-50 w-64 bg-card border-r border-border lg:hidden overflow-y-auto",children:[e.jsxs("div",{className:"flex h-16 items-center justify-between border-b border-border px-6 bg-accent",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-[var(--radius)] bg-white/20 backdrop-blur-sm flex items-center justify-center shrink-0",children:e.jsx(J,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-white !text-[17px]",children:"Admin"}),e.jsx("p",{className:"text-white/80 !text-[13px] !font-normal",children:"Панель управления"})]})]}),e.jsx("button",{onClick:()=>f(!1),className:"text-white",children:e.jsx(Te,{className:"w-6 h-6"})})]}),e.jsx("nav",{className:"p-4 space-y-1",children:u.map(g=>{const x=g.icon,s=d===g.id;return e.jsxs(z.button,{onClick:()=>{v(g.id),f(!1)},className:`
                        w-full flex items-center gap-3 px-3 py-2.5 rounded-[var(--radius)] transition-all !text-[15px] relative
                        ${s?"bg-accent text-accent-foreground shadow-lg":"text-foreground hover:bg-muted"}
                      `,whileHover:{scale:1.02},whileTap:{scale:.98},transition:{type:"spring",stiffness:400,damping:17},children:[e.jsx(x,{className:"w-5 h-5"}),e.jsx("span",{children:g.label}),s&&e.jsx(z.div,{className:"absolute inset-0 bg-accent/20 rounded-[var(--radius)]",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.2}})]},g.id)})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t border-border bg-card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3 px-3 py-2 bg-muted rounded-[var(--radius)]",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-accent flex items-center justify-center text-accent-foreground shrink-0",children:i?.email?.[0].toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"!text-[14px] text-foreground truncate",children:i?.email}),e.jsx("p",{className:"!text-[12px] text-muted-foreground !font-normal",children:"Супер-админ"})]})]}),e.jsxs(D,{variant:"outline",className:"w-full justify-start gap-2 !text-[15px]",onClick:j,children:[e.jsx(Z,{className:"w-4 h-4"}),"Выход"]})]})]})]})}),e.jsxs("div",{className:"lg:pl-64",children:[e.jsx("header",{className:"sticky top-0 z-30 bg-card border-b border-border",children:e.jsxs("div",{className:"flex h-16 items-center justify-between px-4 lg:px-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>f(!0),className:"lg:hidden w-10 h-10 rounded-[var(--radius)] hover:bg-muted flex items-center justify-center",children:e.jsx(Pe,{className:"w-5 h-5 text-foreground"})}),e.jsx("h2",{className:"text-foreground !text-[17px]",children:u.find(g=>g.id===d)?.label})]}),e.jsx("button",{onClick:j,className:"lg:hidden w-10 h-10 rounded-[var(--radius)] hover:bg-muted flex items-center justify-center",title:"Выход",children:e.jsx(Z,{className:"w-5 h-5 text-muted-foreground"})})]})}),e.jsx("main",{className:"p-4 lg:p-8",children:e.jsx(ce,{mode:"wait",children:e.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,ease:[.4,0,.2,1]},className:"w-full",children:[d==="overview"&&e.jsx(xa,{stats:c,isLoading:p,onRefresh:r}),d==="users"&&e.jsx(Ne,{}),d==="subscriptions"&&e.jsx(la,{}),d==="settings"&&e.jsx(ma,{activeSubTab:o,onSubTabChange:y})]},d)})})]})]})}function xa({stats:i,isLoading:j,onRefresh:d}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"!text-[26px] text-foreground",children:"Обзор системы"}),e.jsx("p",{className:"!text-[15px] text-muted-foreground !font-normal",children:"Статистика и метрики приложения"})]}),e.jsxs(D,{onClick:d,disabled:j,variant:"outline",className:"gap-2",children:[e.jsx(se,{className:`w-4 h-4 ${j?"animate-spin":""}`}),"Обновить"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 lg:gap-6",children:[e.jsxs(I,{className:"border-border",children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[13px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),"Всего пользователей"]})}),e.jsxs(A,{children:[e.jsx("div",{className:"!text-[34px] text-foreground",children:i.totalUsers}),e.jsxs("p",{className:"!text-[13px] text-accent !font-normal mt-1",children:["+",i.newUsersToday," сегодня"]})]})]}),e.jsxs(I,{className:"border-border",children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[13px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4"}),"Активные пользователи"]})}),e.jsxs(A,{children:[e.jsx("div",{className:"!text-[34px] text-foreground",children:i.activeUsers}),e.jsxs("p",{className:"!text-[13px] text-muted-foreground !font-normal mt-1",children:[i.totalUsers>0?Math.round(i.activeUsers/i.totalUsers*100):0,"% от всех"]})]})]}),e.jsxs(I,{className:"border-border",children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[13px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4"}),"Premium подписки"]})}),e.jsxs(A,{children:[e.jsx("div",{className:"!text-[34px] text-foreground",children:i.premiumUsers}),e.jsxs("p",{className:"!text-[13px] text-muted-foreground !font-normal mt-1",children:[i.totalUsers>0?Math.round(i.premiumUsers/i.totalUsers*100):0,"% конверсия"]})]})]}),e.jsxs(I,{className:"border-border",children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[13px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4"}),"Общий доход"]})}),e.jsxs(A,{children:[e.jsxs("div",{className:"!text-[34px] text-foreground",children:["$",i.totalRevenue]}),e.jsxs("p",{className:"!text-[13px] text-muted-foreground !font-normal mt-1",children:["$",i.premiumUsers>0?Math.round(i.totalRevenue/i.premiumUsers):0," ARPU"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 lg:gap-6",children:[e.jsxs(I,{className:"border-border",children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[13px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(Fe,{className:"w-4 h-4"}),"Всего записей"]})}),e.jsxs(A,{children:[e.jsx("div",{className:"!text-[34px] text-foreground",children:i.totalEntries}),e.jsxs("p",{className:"!text-[13px] text-muted-foreground !font-normal mt-1",children:[i.activeUsers>0?(i.totalEntries/i.activeUsers).toFixed(1):0," на активного пользователя"]})]})]}),e.jsxs(I,{className:"border-border",children:[e.jsx(T,{className:"pb-2",children:e.jsxs(P,{className:"!text-[13px] !font-normal text-muted-foreground flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),"PWA установок"]})}),e.jsxs(A,{children:[e.jsx("div",{className:"!text-[34px] text-foreground",children:i.pwaInstalls}),e.jsxs("p",{className:"!text-[13px] text-muted-foreground !font-normal mt-1",children:[i.totalUsers>0?Math.round(i.pwaInstalls/i.totalUsers*100):0,"% от всех пользователей"]})]})]})]}),e.jsxs(I,{className:"border-border",children:[e.jsxs(T,{children:[e.jsx(P,{className:"!text-[17px]",children:"Быстрые действия"}),e.jsx(X,{className:"!text-[13px] !font-normal",children:"Управление ключевыми функциями приложения"})]}),e.jsx(A,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(D,{variant:"outline",className:"justify-start h-auto py-4 border-border",onClick:()=>window.dispatchEvent(new CustomEvent("admin-navigate",{detail:{tab:"settings",subtab:"pwa"}})),children:e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("div",{className:"w-10 h-10 rounded-[var(--radius)] bg-accent/10 flex items-center justify-center shrink-0",children:e.jsx(le,{className:"w-5 h-5 text-accent"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"!text-[15px] text-foreground",children:"Настройки PWA"}),e.jsx("p",{className:"!text-[13px] text-muted-foreground !font-normal",children:"Управление установкой и обновлениями"})]})]})}),e.jsx(D,{variant:"outline",className:"justify-start h-auto py-4 border-border",onClick:()=>window.dispatchEvent(new CustomEvent("admin-navigate",{detail:{tab:"settings",subtab:"push"}})),children:e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("div",{className:"w-10 h-10 rounded-[var(--radius)] bg-accent/10 flex items-center justify-center shrink-0",children:e.jsx(ee,{className:"w-5 h-5 text-accent"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"!text-[15px] text-foreground",children:"Push-уведомления"}),e.jsx("p",{className:"!text-[13px] text-muted-foreground !font-normal",children:"Отправка уведомлений пользователям"})]})]})}),e.jsx(D,{variant:"outline",className:"justify-start h-auto py-4 border-border",onClick:()=>window.dispatchEvent(new CustomEvent("admin-navigate",{detail:{tab:"users"}})),children:e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("div",{className:"w-10 h-10 rounded-[var(--radius)] bg-accent/10 flex items-center justify-center shrink-0",children:e.jsx(W,{className:"w-5 h-5 text-accent"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"!text-[15px] text-foreground",children:"Управление пользователями"}),e.jsx("p",{className:"!text-[13px] text-muted-foreground !font-normal",children:"Просмотр и редактирование пользователей"})]})]})}),e.jsx(D,{variant:"outline",className:"justify-start h-auto py-4 border-border",onClick:()=>window.dispatchEvent(new CustomEvent("admin-navigate",{detail:{tab:"subscriptions"}})),children:e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("div",{className:"w-10 h-10 rounded-[var(--radius)] bg-accent/10 flex items-center justify-center shrink-0",children:e.jsx(ge,{className:"w-5 h-5 text-accent"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"!text-[15px] text-foreground",children:"Управление подписками"}),e.jsx("p",{className:"!text-[13px] text-muted-foreground !font-normal",children:"Premium подписки и платежи"})]})]})})]})})]}),e.jsxs(I,{className:"border-border",children:[e.jsx(T,{children:e.jsxs(P,{className:"flex items-center gap-2 !text-[17px]",children:[e.jsx(ee,{className:"w-5 h-5"}),"Статус системы"]})}),e.jsx(A,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsx("span",{className:"!text-[15px] text-foreground",children:"База данных"})]}),e.jsx(F,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/20 !text-[13px]",children:"Работает"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsx("span",{className:"!text-[15px] text-foreground",children:"API сервер"})]}),e.jsx(F,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/20 !text-[13px]",children:"Работает"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsx("span",{className:"!text-[15px] text-foreground",children:"Service Worker"})]}),e.jsx(F,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/20 !text-[13px]",children:"Активен v1.0.3"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsx("span",{className:"!text-[15px] text-foreground",children:"Push-уведомления"})]}),e.jsx(F,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/20 !text-[13px]",children:"Включено"})]})]})})]})]})}const fa=Object.freeze(Object.defineProperty({__proto__:null,AdminDashboard:oa,UsersManagementTab:Ne},Symbol.toStringTag,{value:"Module"}));export{fa as a,H as c,ba as i,Ve as p};
