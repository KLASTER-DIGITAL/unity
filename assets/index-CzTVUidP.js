const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mobile-app-DEQyXuul.js","assets/admin-app-DmelYGS4.js","assets/vendor-libs-kWwOq1hT.js","assets/shared-lib-neXweqqc.js","assets/shared-components-uDOFDz2u.js","assets/shared-components-CmxIAlOK.css","assets/admin-features-kRsOojRn.js","assets/vendor-supabase-D8QWEstQ.js","assets/admin-features-D0O7nwP9.css","assets/mobile-features-CRGr200P.js"])))=>i.map(i=>d[i]);
import{r as a,j as r,aV as k}from"./vendor-libs-kWwOq1hT.js";import{_ as y}from"./admin-app-DmelYGS4.js";import{c as K,s as M}from"./mobile-features-CRGr200P.js";import{R as m}from"./shared-components-uDOFDz2u.js";import"./shared-lib-neXweqqc.js";import"./admin-features-kRsOojRn.js";import"./vendor-supabase-D8QWEstQ.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function f(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(e){if(e.ep)return;e.ep=!0;const n=f(e);fetch(e.href,n)}})();const U=a.lazy(()=>y(()=>import("./mobile-app-DEQyXuul.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])).then(s=>({default:s.MobileApp}))),W=a.lazy(()=>y(()=>import("./admin-app-DmelYGS4.js").then(s=>s.i),__vite__mapDeps([1,2,3,4,5,6,7,8])).then(s=>({default:s.AdminApp})));function V(){const[s,i]=a.useState(1),[f,l]=a.useState(!1),[e,n]=a.useState(null),[c,b]=a.useState(!0),[x,A]=a.useState("ru"),[S,v]=a.useState(!1),[j,u]=a.useState(!1),[E,h]=a.useState(!1),[L,g]=a.useState("register"),[C,p]=a.useState({language:"ru",diaryName:"Мой дневник",diaryEmoji:"🏆",notificationSettings:{selectedTime:"none",morningTime:"08:00",eveningTime:"21:00",permissionGranted:!1},firstEntry:""});a.useEffect(()=>{const t=()=>{const d=new URLSearchParams(window.location.search).get("view")==="admin";v(d),d&&!e?u(!0):d&&e&&u(!1)};return t(),window.addEventListener("popstate",t),window.addEventListener("hashchange",t),()=>{window.removeEventListener("popstate",t),window.removeEventListener("hashchange",t)}},[e]),a.useEffect(()=>{(async()=>{try{const o=await K();o&&o.success!==!1&&o.user?(n(o),o.profile?.onboardingCompleted?(l(!0),i(5)):i(2)):i(1)}catch{i(1)}finally{b(!1)}})()},[]);const O=t=>{A(t),p(o=>({...o,language:t})),i(2)},P=()=>{g("login"),h(!0)},_=()=>{i(3)},N=(t,o)=>{p(d=>({...d,diaryName:t,diaryEmoji:o})),i(4)},T=(t,o)=>{p(d=>({...d,firstEntry:t,notificationSettings:o})),g("register"),h(!0)},R=async t=>{n(t),h(!1),t.onboardingCompleted?(l(!0),i(5)):i(2)},w=async()=>{await M(),n(null),l(!1),i(1),u(!1)},D=t=>{n(t),u(!1)},I=t=>{n(o=>({...o,profile:t}))};return S?c?r.jsx(m,{defaultTheme:"light",storageKey:"unity-theme",children:r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Загрузка..."})]})})}):r.jsx(m,{defaultTheme:"light",storageKey:"unity-theme",children:r.jsx(W,{userData:e,showAdminAuth:j,onAuthComplete:D,onLogout:w,onBack:()=>{window.location.href="/"}})}):c?r.jsx(m,{defaultTheme:"light",storageKey:"unity-theme",children:r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background max-w-md mx-auto",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Загрузка..."})]})})}):r.jsx(m,{defaultTheme:"light",storageKey:"unity-theme",children:r.jsx(U,{userData:e,onboardingComplete:f,currentStep:s,selectedLanguage:x,showAuth:E,authMode:L,onboardingData:C,onWelcomeComplete:O,onWelcomeSkip:P,onOnboarding2Complete:_,onOnboarding3Complete:N,onOnboarding4Complete:T,onAuthComplete:R,onLogout:w,onProfileUpdate:I})})}window.addEventListener("vite:preloadError",s=>{window.location.reload()});window.addEventListener("error",s=>{s.error&&s.error.message&&s.error.message.includes("Loading chunk")&&window.location.reload()});window.addEventListener("unhandledrejection",s=>{});k.createRoot(document.getElementById("root")).render(r.jsx(V,{}));
